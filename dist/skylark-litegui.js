/**
 * skylark-litegui - A version of litegui.js  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-litegui/
 * @license MIT
 */
!function(t,e){var i=e.define,require=e.require,n="function"==typeof i&&i.amd,o=!n&&"undefined"!=typeof exports;if(!n&&!i){var r={};i=e.define=function(t,e,i){"function"==typeof i?(r[t]={factory:i,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var i=e.split("/"),n=t.split("/");i.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?i.pop():i.push(n[o]));return i.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):r[t]={factory:null,resolved:!0,exports:i}},require=e.require=function(t){if(!r.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=r[t];if(!module.resolved){var i=[];module.deps.forEach(function(t){i.push(require(t))}),module.exports=module.factory.apply(e,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-litegui/litegui",["skylark-langx-ns"],function(t){var e={root:null,content:null,panels:{},windows:[],undo_steps:[],modalbg_div:null,mainmenu:null,init:function(t){if((t=t||{}).width&&t.height&&this.setWindowSize(t.width,t.height),this.container=null,t.container&&(this.container=document.getElementById(t.container)),this.container||(this.container=document.body),t.wrapped){var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden",this.root=i,this.container.appendChild(i);var n=document.createElement("div");this.content=n,this.root.appendChild(n),this.root.classList.contains("fullscreen")&&window.addEventListener("resize",function(t){e.maximizeWindow()})}else this.root=this.content=this.container;this.root.className="litegui-wrap fullscreen",this.content.className="litegui-maincontent";var o=this.modalbg_div=document.createElement("div");this.modalbg_div.className="litemodalbg",this.root.appendChild(this.modalbg_div),o.style.display="none",t.menubar&&this.createMenubar(),t.gui_callback&&t.gui_callback(),window.addEventListener("beforeunload",function(t){for(var i in e.windows)e.windows[i].close();e.windows=[]})},trigger:function(t,e,i,n){var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,!0,!0,i),o.srcElement=n,t.dispatchEvent?t.dispatchEvent(o):t.__events&&t.__events.dispatchEvent(o),o},bind:function(t,e,i){if(!t)throw"Cannot bind to null";if(!e)throw"Event bind missing";if(!i)throw"Bind callback missing";if(t.constructor===String&&(t=document.querySelectorAll(t)),t.constructor===NodeList||t.constructor===Array)for(var n=0;n<t.length;++n)o(t[n]);else o(t);function o(t){if(t.addEventListener)t.addEventListener(e,i);else if(t.__events)t.__events.addEventListener(e,i);else{var n=document.createElement("span");n.widget=t,Object.defineProperty(t,"__events",{enumerable:!1,configurable:!1,writable:!1,value:n}),t.__events.addEventListener(e,i)}}},unbind:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.__events&&t.__events.removeEventListener&&t.__events.removeEventListener(e,i)},removeClass:function(t,e,i){i||(i=e,e="."+e);for(var n=(t||document).querySelectorAll(e),o=0;o<n.length;++o)n[o].classList.remove(i)},add:function(t){this.content.appendChild(t.root||t)},remove:function(t){if(t){if(t.constructor===String)for(var i=document.querySelectorAll(t),n=0;n<i.length;++n){var t=i[n];t&&t.parentNode&&t.parentNode.removeChild(t)}if(t.constructor===Array||t.constructor===NodeList)for(var n=0;n<t.length;++n)e.remove(t[n]);else t.root&&t.root.parentNode?t.root.parentNode.removeChild(t.root):t.parentNode&&t.parentNode.removeChild(t)}},getById:function(t){return document.getElementById(t)},createMenubar:function(){this.menubar=new e.Menubar("mainmenubar"),this.add(this.menubar)},setWindowSize:function(t,i){var n=this.root.style;if(t&&i)n.width=t+"px",n.height=i+"px",n.boxShadow="0 0 4px black",this.root.classList.remove("fullscreen");else{if(this.root.classList.contains("fullscreen"))return;this.root.classList.add("fullscreen"),n.width="100%",n.height="100%",n.boxShadow="0 0 0"}e.trigger(e,"resized")},maximizeWindow:function(){this.setWindowSize()},setCursor:function(t){this.root.style.cursor=t},isCursorOverElement:function(t,e){var i=t.pageX,n=t.pageY,o=e.getBoundingClientRect();return!!o&&(n>o.top&&n<o.top+o.height&&i>o.left&&i<o.left+o.width)},getRect:function(t){return t.getBoundingClientRect()},toClipboard:function(t,e){t&&t.constructor!==String&&(t=JSON.stringify(t));var i=null,n=!1;if(!e)try{document.queryCommandSupported("copy");(i=document.createElement("input")).type="text",i.style.opacity=0,i.value=t,document.body.appendChild(i),i.select(),n=document.execCommand("copy"),console.log(n?"saved to clipboard":"problem saving to clipboard"),document.body.removeChild(i)}catch(t){i&&document.body.removeChild(i),console.warn("Oops, unable to copy using the true clipboard")}try{this._safe_cliboard=null,localStorage.setItem("litegui_clipboard",t)}catch(e){this._safe_cliboard=t,console.warn("cliboard quota excedeed")}},getLocalClipboard:function(){var t=localStorage.getItem("litegui_clipboard");return!t&&this._safe_cliboard&&(t=this._safe_cliboard),t?"{"==t[0]?JSON.parse(t):t:null},addCSS:function(t){if(t){if(t.constructor===String){var e=document.createElement("style");return e.type="text/css",e.innerHTML=t,void document.getElementsByTagName("head")[0].appendChild(e)}for(var i in t)document.body.style[i]=t[i]}},requireCSS:function(t,e){for("string"==typeof t&&(t=[t]);t.length;){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=t.shift(1),i.media="all";var n=document.getElementsByTagName("head")[0];n.appendChild(i),0==t.length&&(i.onload=e)}},request:function(t){var e=t.dataType||"text";"json"==e?e="text":"xml"==e?e="text":"binary"==e&&(e="arraybuffer",t.mimeType="application/octet-stream");var i=new XMLHttpRequest;i.open(t.data?"POST":"GET",t.url,!0),e&&(i.responseType=e),t.mimeType&&i.overrideMimeType(t.mimeType),t.nocache&&i.setRequestHeader("Cache-Control","no-cache"),i.onload=function(e){var n=this.response;if(200!=this.status){var o="Error "+this.status;return t.error&&t.error(o),void LEvent.trigger(i,"fail",this.status)}if("json"==t.dataType)try{n=JSON.parse(n)}catch(o){if(!t.error)throw o;t.error(o)}else if("xml"==t.dataType)try{var r=new DOMParser;n=r.parseFromString(n,"text/xml")}catch(o){if(!t.error)throw o;t.error(o)}t.success&&t.success.call(this,n,this)},i.onerror=function(e){t.error&&t.error(e)};var n=new FormData;if(t.data)for(var o in t.data)n.append(o,t.data[o]);return i.send(n),i},requestText:function(t,e,i){return this.request({url:t,dataType:"text",success:e,error:i})},requestJSON:function(t,e,i){return this.request({url:t,dataType:"json",success:e,error:i})},requestBinary:function(t,e,i){return this.request({url:t,dataType:"binary",success:e,error:i})},requireScript:function(t,e,i,n,o){if(!t)throw"invalid URL";t.constructor===String&&(t=[t]);var r=t.length,s=[];for(var a in t){var l=document.createElement("script");l.num=a,l.type="text/javascript",l.src=t[a]+(o?"?version="+o:""),l.original_src=t[a],l.async=!1,l.onload=function(t){r--,s.push(this),r?n&&n(this.original_src,this.num):e&&e(s)},i&&(l.onerror=function(t){i(t,this.original_src,this.num)}),document.getElementsByTagName("head")[0].appendChild(l)}},requireScriptSerial:function(t,e,i){"string"==typeof t&&(t=[t]);var n=[];!function o(){var r=document.createElement("script");r.type="text/javascript";r.src=t.shift(1);r.onload=function(r){if(t.length)return i&&i(t[0],t.length),void o();n.push(this),e&&e(n)};document.getElementsByTagName("head")[0].appendChild(r)}()},newDiv:function(t,e){return this.createElement("div",t,e)},createElement:function(t,e,i,n,o){var r=document.createElement(t);if(e)for(var s=e.split(" "),a=0;a<s.length;a++)"."==s[a][0]?r.classList.add(s[a].substr(1)):"#"==s[a][0]?r.id=s[a].substr(1):r.id=s[a];if(r.root=r,i&&(r.innerHTML=i),r.add=function(t){this.appendChild(t.root||t)},n)if(n.constructor===String)r.setAttribute("style",n);else for(var a in n)r.style[a]=n[a];if(o)for(var a in o)r.addEventListener(a,o[a]);return r},createListItem:function(t,e,i){var n=document.createElement("span");if(n.innerHTML=t,n=n.childNodes[0],e)for(var o in e){var r=n.querySelector(o);r&&(r.innerText=e[o])}if(i)for(var o in i)n.style[o]=i[o];return n},createButton:function(t,e,i,n){var o=document.createElement("button");if(o.className="litegui litebutton button",t)for(var r=t.split(" "),s=0;s<r.length;s++)"."==r[s][0]?o.classList.add(r[s].substr(1)):"#"==r[s][0]?o.id=r[s].substr(1):o.id=r[s];if(o.root=o,void 0!==e&&(o.innerHTML=e),i&&o.addEventListener("click",i),n)if(n.constructor===String)o.setAttribute("style",n);else for(var s in n)o.style[s]=n[s];return o},getParents:function(t){for(var e=[];null!==(t=t.parentElement);)t.nodeType===Node.ELEMENT_NODE&&e.push(elem);return e},newWindow:function(t,e,i,n){n=n||{};var o=window.open("","","width="+e+", height="+i+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");o.document.write("<html><head><title>"+t+"</title>");for(var r=document.querySelectorAll("link[rel='stylesheet'],style"),s=0;s<r.length;s++)o.document.write(r[s].outerHTML);if(n.scripts)for(var a=document.querySelectorAll("script"),s=0;s<a.length;s++)a[s].src&&o.document.write(a[s].outerHTML);var l=n.content||"";return o.document.write("</head><body>"+l+"</body></html>"),o.document.close(),o},showModalBackground:function(t){e.modalbg_div&&(e.modalbg_div.style.display=t?"block":"none")},showMessage:function(t,i){(i=i||{}).title=i.title||"Attention",i.content=t,i.close="fade";var n=new e.Dialog(i);return i.noclose||n.addButton("Close",{close:!0}),n.makeModal("fade"),n},popup:function(t,i){(i=i||{}).min_height=140,"string"==typeof t&&(t="<p>"+t+"</p>"),i.content=t,i.close="fade";var n=new e.Dialog(i);return i.noclose||n.addButton("Close",{close:!0}),n.show(),n},alert:function(t,i){return(i=i||{}).className="alert",i.title=i.title||"Alert",i.width=i.width||280,i.height=i.height||140,"string"==typeof t&&(t="<p>"+t+"</p>"),e.remove(".litepanel.alert"),e.showMessage(t,i)},confirm:function(t,e,i){(i=i||{}).className="alert",i.title=i.title||"Confirm",i.width=i.width||280,"string"==typeof t&&(t="<p>"+t+"</p>"),t+="<button class='litebutton' data-value='yes' style='width:45%; margin-left: 10px'>Yes</button><button class='litebutton' data-value='no' style='width:45%'>No</button>",i.noclose=!0;var n=this.showMessage(t,i);n.content.style.paddingBottom="10px";for(var o=n.content.querySelectorAll("button"),r=0;r<o.length;r++)o[r].addEventListener("click",s);function s(t){var t="yes"==this.dataset.value;n.close(),e&&e(t)}return o[0].focus(),n},prompt:function(t,e,i){(i=i||{}).className="alert",i.title=i.title||"Prompt",i.width=i.width||280,"string"==typeof t&&(t="<p>"+t+"</p>");var n=i.value||"",o="<input type='text' value='"+n+"'/>";i.textarea&&(o="<textarea class='textfield' style='width:95%'>"+n+"</textarea>"),t+="<p>"+o+"</p><button class='litebutton' data-value='accept' style='width:45%; margin-left: 10px; margin-bottom: 10px'>Accept</button><button class='litebutton' data-value='cancel' style='width:45%'>Cancel</button>",i.noclose=!0;for(var r=this.showMessage(t,i),s=r.content.querySelectorAll("button"),a=0;a<s.length;a++)s[a].addEventListener("click",c);var l=r.content.querySelector("input,textarea");function c(){var t=l.value;this.dataset&&"cancel"==this.dataset.value&&(t=null),r.close(),e&&e(t)}return l.addEventListener("keydown",function(t){t||(t=window.event);var e=t.keyCode||t.which;if("13"==e)return c(),!1;"29"==e&&r.close()},!0),l.focus(),r},choice:function(t,e,i,n){for(var o in(n=n||{}).className="alert",n.title=n.title||"Select one option",n.width=n.width||280,"string"==typeof t&&(t="<p>"+t+"</p>"),e)t+="<button class='litebutton' data-value='"+o+"' style='width:45%; margin-left: 10px'>"+(e[o].content||e[o])+"</button>";n.noclose=!0;var r=this.showMessage(t,n);r.content.style.paddingBottom="10px";for(var s=r.content.querySelectorAll("button"),o=0;o<s.length;o++)s[o].addEventListener("click",a);function a(t){var t=e[this.dataset.value];r.close(),i&&i(t)}return r},downloadURL:function(t,e){var i=document.createElement("a");i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)},downloadFile:function(t,e,i){if(e){i||(i=e.constructor===String?"text/plain":"application/octet-stream");var n=null;n=e.constructor!==File&&e.constructor!==Blob?new Blob([e],{type:i}):e;var o=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",o),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(function(){URL.revokeObjectURL(o)},6e4)}else console.warn("No file provided to download")},getUrlVars:function(){for(var t,e=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<i.length;n++)t=i[n].split("="),e.push(t[0]),e[t[0]]=t[1];return e},getUrlVar:function(t){return e.getUrlVars()[t]},focus:function(t){t.focus()},blur:function(t){t.blur()},draggable:function(t,e,i,n,o){(e=e||t).addEventListener("mousedown",function e(d){if("mousedown"==d.type)return a||(a=t.getClientRects()[0],l=a?a.left:0,c=a?a.top:0),o&&0==o(t,d)?(d.stopPropagation(),d.preventDefault(),!1):(r=d.clientX,s=d.clientY,document.addEventListener("mousemove",e),document.addEventListener("mouseup",e),i&&i(t,d),d.stopPropagation(),d.preventDefault(),!1);if("mouseup"==d.type)return document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",e),void(n&&n(t,d));if("mousemove"==d.type){var h=d.clientX-r,u=d.clientY-s;r=d.clientX,s=d.clientY,l+=h,c+=u,t.style.left=l+"px",t.style.top=c+"px"}}),e.style.cursor="move";var r=0,s=0,a=t.getClientRects()[0],l=a?a.left:0,c=a?a.top:0;t.style.position="absolute",t.style.left=l+"px",t.style.top=c+"px"},cloneObject:function(t,e){var i=e||{};for(var n in t)if("_"!=n[0]&&"jQuery"!=n.substr(0,6)){var o=t[n];if(null==o)i[n]=null;else{if(isFunction(o))continue;if("number"==typeof o||"string"==typeof o)i[n]=o;else if(o.constructor==Float32Array)i[n]=Array.apply([],o);else if(isArray(o))i[n]&&i[n].constructor==Float32Array?i[n].set(o):i[n]=JSON.parse(JSON.stringify(o));else try{i[n]=JSON.parse(JSON.stringify(o))}catch(t){console.error(t)}}}return i},safeName:function(t){return String(t).replace(/[\s\.]/g,"")},special_codes:{close:"&#10005;",navicon:"&#9776;",refresh:"&#8634;",gear:"&#9881;",open_folder:"&#128194;",download:"&#11123;",tick:"&#10003;",trash:"&#128465;"},htmlEncode:function(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText},htmlDecode:function(t){var e=document.createElement("div");return e.innerText=t,e.innerHTML},sizeToCSS:function(t){return void 0===t||null===t?null:t.constructor===String?t:t>=0?(0|t)+"px":"calc( 100% - "+Math.abs(0|t)+"px )"},getElementWindow:function(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow},createDropArea:function(t,e,i,n){function o(e){t.addEventListener("dragexit",o),t.addEventListener("dragover",o),t.addEventListener("drop",r),e.stopPropagation(),e.preventDefault(),"dragenter"==e.type&&i&&i(e,this),"dragexit"==e.type&&n&&n(e,this)}function r(i){i.stopPropagation(),i.preventDefault(),t.removeEventListener("dragexit",o),t.removeEventListener("dragover",o),t.removeEventListener("drop",r);var n=void 0;if(e&&(n=e(i)),n)return i.stopPropagation(),i.stopImmediatePropagation(),!0}t.addEventListener("dragenter",o)}};return Object.defineProperty(String.prototype,"template",{value:function(t,e){for(var i,n=this,o=/{{([^}}]+)?}}/g;i=o.exec(n);){var r=e?new Function("with(this) { try { return "+i[1]+"} catch(e) { return 'error';} }").call(t):t[i[1]];n=n.replace(i[0],r)}return n},enumerable:!1}),"undefined"==typeof escapeHtmlEntities&&(escapeHtmlEntities=function(t){return t.replace(/[\u00A0-\u2666<>\&]/g,function(t){return"&"+(escapeHtmlEntities.entityTable[t.charCodeAt(0)]||"#"+t.charCodeAt(0))+";"})},escapeHtmlEntities.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"}),t.attach("intg.litegui",e)}),t("skylark-litegui/Area",["./litegui"],function(t){function e(e,i){if(e&&e.constructor===String||i){var n=e;(e=i||{}).id=n,console.warn("LiteGUI.Area legacy parameter, use options as first parameter instead of id.")}e=e||{};var o=document.createElement("div");o.className="litearea",e.id&&(o.id=e.id),e.className&&(o.className+=" "+e.className),this.root=o,this.root.litearea=this;var r=e.width||"100%",s=e.height||"100%";r<0&&(r="calc( 100% - "+Math.abs(r)+"px)"),s<0&&(s="calc( 100% - "+Math.abs(s)+"px)"),o.style.width=r,o.style.height=s,this.options=e;var a=this;this._computed_size=[this.root.offsetWidth,this.root.offserHeight];var l=document.createElement("div");e.content_id&&(l.id=e.content_id),l.className="liteareacontent",l.style.width="100%",l.style.height="100%",this.root.appendChild(l),this.content=l,this.split_direction="none",this.sections=[],e.autoresize&&t.bind(t,"resized",function(){a.onResize()})}return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e.splitbar_size=4,e.prototype.getSection=function(t){return t=t||0,this.sections.length>t?this.sections[t]:null},e.prototype.onResize=function(t){var e=[this.root.offsetWidth,this.root.offsetHeight];t&&this._computed_size&&e[0]==this._computed_size[0]&&e[1]==this._computed_size[1]||this.sendResizeEvent(t)},e.prototype.sendResizeEvent=function(e){if(this.sections.length)for(var i in this.sections){var n=this.sections[i];n.onResize(e)}else for(var o=0;o<this.root.childNodes.length;o++){var r=this.root.childNodes[o];r.litearea?r.litearea.onResize():t.trigger(r,"resize")}this.onresize&&this.onresize()},e.prototype.getWidth=function(){return this.root.offsetWidth},e.prototype.getHeight=function(){return this.root.offsetHeight},e.prototype.isVisible=function(){return"none"!=this.root.style.display},e.prototype.adjustHeight=function(){if(this.root.parentNode){this.root.parentNode.offsetHeight;var t=this.root.getClientRects()[0].top;this.root.style.height="calc( 100% - "+t+"px )"}else console.error("Cannot adjust height of LiteGUI.Area without parent")},e.prototype.split=function(i,n,o){if(!i||i.constructor!==String)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(n||(n=["50%",null]),"vertical"!=i&&"horizontal"!=i)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(this.sections.length)throw"cannot split twice";var r=new t.Area({content_id:this.content.id});r.root.style.display="inline-block";var s=new t.Area;s.root.style.display="inline-block";var a="",l=null,c=null;if(o&&(a=" - "+(e.splitbar_size+2)+"px",(l=document.createElement("div")).className="litesplitbar "+i,"vertical"==i?l.style.height=e.splitbar_size+"px":l.style.width=e.splitbar_size+"px",this.splitbar=l,l.addEventListener("mousedown",function(t){var e=g.root.ownerDocument;e.addEventListener("mousemove",y),e.addEventListener("mouseup",b),m[0]=t.pageX,m[1]=t.pageY,t.stopPropagation(),t.preventDefault()})),n=n||["50%",null],"vertical"==i)if(r.root.style.width="100%",s.root.style.width="100%",null==n[0]){var d=n[1];"number"==typeof d&&(d=n[1]+"px"),r.root.style.height="-moz-calc( 100% - "+d+a+" )",r.root.style.height="-webkit-calc( 100% - "+d+a+" )",r.root.style.height="calc( 100% - "+d+a+" )",s.root.style.height=d,s.size=d,c=r}else if(null==n[1]){var d=n[0];"number"==typeof d&&(d=n[0]+"px"),r.root.style.height=d,r.size=d,s.root.style.height="-moz-calc( 100% - "+d+a+" )",s.root.style.height="-webkit-calc( 100% - "+d+a+" )",s.root.style.height="calc( 100% - "+d+a+" )",c=s}else{var h=n[0];"number"==typeof h&&(h=n[0]+"px");var u=n[1];"number"==typeof u&&(u=n[1]+"px"),r.root.style.height=h,r.size=h,s.root.style.height=u,s.size=u}else if(r.root.style.height="100%",s.root.style.height="100%",null==n[0]){var p=n[1];"number"==typeof p&&(p=n[1]+"px"),r.root.style.width="-moz-calc( 100% - "+p+a+" )",r.root.style.width="-webkit-calc( 100% - "+p+a+" )",r.root.style.width="calc( 100% - "+p+a+" )",s.root.style.width=p,s.size=n[1],c=r}else if(null==n[1]){var p=n[0];"number"==typeof p&&(p=n[0]+"px"),r.root.style.width=p,r.size=p,s.root.style.width="-moz-calc( 100% - "+p+a+" )",s.root.style.width="-webkit-calc( 100% - "+p+a+" )",s.root.style.width="calc( 100% - "+p+a+" )",c=s}else{var f=n[0];"number"==typeof f&&(f=n[0]+"px");var v=n[1];"number"==typeof v&&(v=n[1]+"px"),r.root.style.width=f,r.size=f,s.root.style.width=v,s.size=v}r.root.removeChild(r.content),r.root.appendChild(this.content),r.content=this.content,this.root.appendChild(r.root),l&&this.root.appendChild(l),this.root.appendChild(s.root),this.sections=[r,s],this.dynamic_section=c,this.direction=i;var g=this,m=[0,0];function y(t){"horizontal"==i?m[0]!=t.pageX&&g.moveSplit(m[0]-t.pageX):"vertical"==i&&m[1]!=t.pageY&&g.moveSplit(t.pageY-m[1]),m[0]=t.pageX,m[1]=t.pageY,t.stopPropagation(),t.preventDefault(),(g.options.immediateResize||g.options.inmediateResize)&&g.onResize()}function b(t){var e=g.root.ownerDocument;e.removeEventListener("mousemove",y),e.removeEventListener("mouseup",b),g.onResize()}},e.prototype.hide=function(){this.root.style.display="none"},e.prototype.show=function(){this.root.style.display="block"},e.prototype.showSection=function(t){var e=this.sections[t],i=0;if(!e||"none"==e.root.style.display){for(var n in-1!=(i="horizontal"==this.direction?e.root.style.width:e.root.style.height).indexOf("calc")&&(i="50%"),this.sections){var e=this.sections[n];n==t?e.root.style.display="inline-block":"horizontal"==this.direction?e.root.style.width="calc( 100% - "+i+" - 5px)":e.root.style.height="calc( 100% - "+i+" - 5px)"}this.splitbar&&(this.splitbar.style.display="inline-block"),this.sendResizeEvent()}},e.prototype.hideSection=function(t){for(var e in this.sections){var i=this.sections[e];e==t?i.root.style.display="none":"horizontal"==this.direction?i.root.style.width="100%":i.root.style.height="100%"}this.splitbar&&(this.splitbar.style.display="none"),this.sendResizeEvent()},e.prototype.moveSplit=function(i){if(this.sections){var n=this.sections[0],o=this.sections[1],r=" - "+e.splitbar_size+"px",s=this.options.minSplitSize||10;if("horizontal"==this.direction)if(this.dynamic_section==n){var a=o.root.offsetWidth+i;a<s&&(a=s),n.root.style.width="-moz-calc( 100% - "+a+"px "+r+" )",n.root.style.width="-webkit-calc( 100% - "+a+"px "+r+" )",n.root.style.width="calc( 100% - "+a+"px "+r+" )",o.root.style.width=a+"px"}else{var a=n.root.offsetWidth-i;a<s&&(a=s),o.root.style.width="-moz-calc( 100% - "+a+"px "+r+" )",o.root.style.width="-webkit-calc( 100% - "+a+"px "+r+" )",o.root.style.width="calc( 100% - "+a+"px "+r+" )",n.root.style.width=a+"px"}else if("vertical"==this.direction)if(this.dynamic_section==n){var a=o.root.offsetHeight-i;a<s&&(a=s),n.root.style.height="-moz-calc( 100% - "+a+"px "+r+" )",n.root.style.height="-webkit-calc( 100% - "+a+"px "+r+" )",n.root.style.height="calc( 100% - "+a+"px "+r+" )",o.root.style.height=a+"px"}else{var a=n.root.offsetHeight+i;a<s&&(a=s),o.root.style.height="-moz-calc( 100% - "+a+"px "+r+" )",o.root.style.height="-webkit-calc( 100% - "+a+"px "+r+" )",o.root.style.height="calc( 100% - "+a+"px "+r+" )",n.root.style.height=a+"px"}t.trigger(this.root,"split_moved");for(var l=this.root.querySelectorAll(".litearea"),c=0;c<l.length;++c)t.trigger(l[c],"split_moved")}},e.prototype.addEventListener=function(t,e,i,n){return this.root.addEventListener(t,e,i,n)},e.prototype.setAreaSize=function(t,i){var n=this.sections[1],o=" - "+e.splitbar_size+"px";n.root.style.width="-moz-calc( 100% - "+i+o+" )",n.root.style.width="-webkit-calc( 100% - "+i+o+" )",n.root.style.width="calc( 100% - "+i+o+" )"},e.prototype.merge=function(t){if(0==this.sections.length)throw"not splitted";var e=this.sections[t||0];this.root.appendChild(e.content),this.content=e.content,this.root.removeChild(this.sections[0].root),this.root.removeChild(this.sections[1].root),this.sections=[],this._computed_size=null,this.onResize()},e.prototype.add=function(t){if("string"==typeof t){var e=document.createElement("div");e.innerHTML=t,t=e}this.content.appendChild(t.root||t)},e.prototype.query=function(t){return this.root.querySelector(t)},t.Area=e}),t("skylark-litegui/Console",["./litegui"],function(t){function e(t){t=t||{},this.root=document.createElement("div"),this.root.className="liteconsole",this.root.innerHTML="<div class='log'></div><div class='foot'><input type='text'/></div>",this.log_element=this.root.querySelector(".log"),this.input=this.root.querySelector("input"),this.input.addEventListener("keydown",this.processKeyDown.bind(this)),this._prompt=t.prompt||"]",this.onAutocomplete=null,this.onProcessCommand=null,this.history=[],this._history_offset=0}return e.prototype.processKeyDown=function(t){if(!this._input_blocked){if(13==t.keyCode){var e=this.input.value,i=e.trim();this.addMessage(this._prompt+i,"me",!0),this.input.value="",this.history.push(i),this.history.length>10&&this.history.shift(),this.onProcessCommand&&this.onProcessCommand(i),this._history_offset=0}else if(38==t.keyCode||40==t.keyCode){this._history_offset+=38==t.keyCode?-1:1,this._history_offset>0?this._history_offset=0:this._history_offset<-this.history.length&&(this._history_offset=-this.history.length);var n=this.history.length+this._history_offset;if(n<0)return;n>=this.history.length?this.input.value="":this.input.value=this.history[n]}else{if(9!=t.keyCode)return;if(!this.onAutocomplete)return;this.input.value=this.onAutocomplete(this.input.value)}t.preventDefault(),t.stopPropagation()}},e.prototype.addMessage=function(t,e,i){var n=this.log_element,o=null;if(t&&t.constructor===Array)for(var r=0;r<t.length;++r)s(t[r]);else t&&t.constructor===Object?s(JSON.stringify(t,null,""),this):s(t,this);function s(t,r){o=document.createElement("pre"),i?o.innerText=t:o.innerHTML=t,o.className="msg",e&&(o.className+=" "+e),n.appendChild(o),n.children.length>1e3&&n.removeChild(n.children[0])}return this.log_element.scrollTop=1e6,o.update=function(t){this.innerHTML=t},o},e.prototype.log=function(){var t=Array.prototype.slice.call(arguments),e=t.join(",");return this.addMessage(e,"msglog")},e.prototype.warn=function(){var t=Array.prototype.slice.call(arguments),e=t.join(",");return this.addMessage(e,"msgwarn")},e.prototype.error=function(){var t=Array.prototype.slice.call(arguments),e=t.join(",");return this.addMessage(e,"msgerror")},e.prototype.clear=function(){this.log_element.innerHTML=""},t.Console=e}),t("skylark-litegui/Dialog",["./litegui"],function(t){function e(t,e){if(e||t&&t.constructor===String){var i=t;(t=e||{}).id=i,console.warn("LiteGUI.Dialog legacy parameter, use options as first parameter instead of id.")}this._ctor(t)}return e.MINIMIZED_WIDTH=200,e.title_height="20px",e.getDialog=function(t){var e=document.getElementById(t);return e?e.dialog:null},e.prototype._ctor=function(i){i=i||{};var n=this;this.width=i.width,this.height=i.height,this.minWidth=i.minWidth||150,this.minHeight=i.minHeight||100,this.content=i.content||"";var o=document.createElement("div");i.id&&(o.id=i.id),o.className="litedialog "+(i.className||""),o.data=this,o.dialog=this;var r="";if(i.title&&(r+="<div class='panel-header'>"+i.title+"</div><div class='buttons'>",i.minimize&&(r+="<button class='litebutton mini-button minimize-button'>-</button>",r+="<button class='litebutton mini-button maximize-button' style='display:none'></button>"),i.hide&&(r+="<button class='litebutton mini-button hide-button'></button>"),i.detachable&&(r+="<button class='litebutton mini-button detach-button'></button>"),(i.close||i.closable)&&(r+="<button class='litebutton mini-button close-button'>"+t.special_codes.close+"</button>"),r+="</div>"),r+="<div class='content'>"+this.content+"</div>",r+="<div class='panel-footer'></div>",o.innerHTML=r,this.root=o,this.content=o.querySelector(".content"),this.footer=o.querySelector(".panel-footer"),i.fullcontent&&(this.content.style.width="100%",this.content.style.height=i.title?"calc( 100% - "+e.title_height+" )":"100%"),i.buttons)for(var s in i.buttons)this.addButton(i.buttons[s].name,i.buttons[s]);1==i.scroll&&(this.content.style.overflow="auto");var a=o.querySelector(".close-button");a&&a.addEventListener("click",this.close.bind(this));var l=o.querySelector(".maximize-button");l&&l.addEventListener("click",this.maximize.bind(this));var c=o.querySelector(".minimize-button");c&&c.addEventListener("click",this.minimize.bind(this));var d=o.querySelector(".hide-button");d&&d.addEventListener("click",this.hide.bind(this));var h=o.querySelector(".detach-button");if(h&&h.addEventListener("click",function(){n.detachWindow()}),this.enableProperties(i),this.root.addEventListener("DOMNodeInsertedIntoDocument",function(){n.on_attached_to_DOM&&n.on_attached_to_DOM(),n.on_resize&&n.on_resize()}),this.root.addEventListener("DOMNodeRemovedFromDocument",function(){n.on_detached_from_DOM&&n.on_detached_from_DOM()}),i.attach||i.parent){var u=null;i.parent&&(u="string"==typeof i.parent?document.querySelector(i.parent):i.parent),u||(u=t.root),u.appendChild(this.root),this.center()}},e.prototype.add=function(t){this.content.appendChild(t.root||t)},e.prototype.enableProperties=function(e){e=e||{};var i=this,n=this.root;n.style.position="absolute",n.style.minWidth=this.minWidth+"px",n.style.minHeight=this.minHeight+"px",this.width&&(n.style.width=this.width+"px"),this.height&&("number"==typeof this.height?n.style.height=this.height+"px":-1!=this.height.indexOf("%")&&(n.style.height=this.height),this.content.style.height="calc( "+this.height+"px - 24px )"),n.style.boxShadow="0 0 3px black",e.draggable&&(this.draggable=!0,t.draggable(n,n.querySelector(".panel-header"),function(){i.bringToFront()},null,function(){return!i.minimized})),e.resizable&&this.setResizable()},e.prototype.setResizable=function(){if(!this.resizable){var e=this.root;this.resizable=!0;var i=this.footer;i.style.minHeight="4px",i.classList.add("resizable");var n=document.createElement("div");n.className="resizable-corner",this.root.appendChild(n),i.addEventListener("mousedown",a),n.addEventListener("mousedown",a,!0);var o=[0,0],r=this,s=!1}function a(i){if("mousedown"==i.type)document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",a),s=this==n,o[0]=i.pageX,o[1]=i.pageY;else if("mousemove"==i.type){var l=t.getRect(e),c=l.width,d=c-(o[0]-i.pageX),h=l.height,u=h-(o[1]-i.pageY);s&&(e.style.width=d+"px"),e.style.height=u+"px",o[0]=i.pageX,o[1]=i.pageY,r.content.style.height="calc( 100% - 24px )",!r.on_resize||c==d&&h==u||r.on_resize(i,d,u)}else"mouseup"==i.type&&(document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",a),s=!1);return i.preventDefault(),i.stopPropagation(),!1}},e.prototype.dockTo=function(e,i){if(e){var n=this.root;i=i||"full",e=e.content||e,n.style.top=0,n.style.left=0,n.style.boxShadow="0 0 0","full"==i?(n.style.position="relative",n.style.width="100%",n.style.height="100%",this.content.style.width="100%",this.content.style.height="calc(100% - "+t.Panel.title_height+")",this.content.style.overflow="auto"):"left"==i||"right"==i?(n.style.position="absolute",n.style.top=0,n.style[i]=0,n.style.width=this.width+"px",n.style.height="100%",this.content.style.height="calc(100% - "+t.Panel.title_height+")",this.content.style.overflow="auto","right"==i&&(n.style.left="auto",n.style.right=0)):"bottom"!=i&&"top"!=i||(n.style.width="100%",n.style.height=this.height+"px","bottom"==i&&(n.style.bottom=0,n.style.top="auto")),this.draggable&&t.draggable(n),e.content?e.content.appendChild(n):"string"==typeof e?(e=document.querySelector(e))&&e.appendChild(n):e.appendChild(n)}},e.prototype.addButton=function(t,e){(e=e||{}).constructor===Function&&(e={callback:e});var i=this,n=document.createElement("button");return n.className="litebutton",n.innerHTML=t,e.className&&(n.className+=" "+e.className),this.root.querySelector(".panel-footer").appendChild(n),n.addEventListener("click",function(t){e.callback&&e.callback(this),e.close&&i.close()}),n},e.prototype.close=function(){t.remove(this.root),t.trigger(this,"closed",this),this.on_close&&this.on_close(),this.onclose&&console.warn("Dialog: Do not use onclose, use on_close instead"),this.dialog_window&&(this.dialog_window.close(),this.dialog_window=null)},e.prototype.highlight=function(t){t=t||100,this.root.style.outline="1px solid white";var e=this.root.ownerDocument,i=e.defaultView||e.parentWindow;i.focus(),setTimeout(function(){this.root.style.outline=null}.bind(this),t)},e.minimized=[],e.prototype.minimize=function(){if(!this.minimized){this.minimized=!0,this.old_box=this.root.getBoundingClientRect(),this.root.querySelector(".content").style.display="none";var e=this.root.querySelector(".minimize-button");e&&(e.style.display="none");var i=this.root.querySelector(".maximize-button");i&&(i.style.display=""),this.root.style.width=t.Dialog.MINIMIZED_WIDTH+"px",t.bind(this,"closed",function(){t.Dialog.minimized.splice(t.Dialog.minimized.indexOf(this),1),t.Dialog.arrangeMinimized()}),t.Dialog.minimized.push(this),t.Dialog.arrangeMinimized(),t.trigger(this,"minimizing")}},e.arrangeMinimized=function(){for(var e in t.Dialog.minimized){var i=t.Dialog.minimized[e],n=i.root.parentNode,o=n.getBoundingClientRect().height-20;i.root.style.left=t.Dialog.MINIMIZED_WIDTH*e,i.root.style.top=o+"px"}},e.prototype.maximize=function(){if(this.minimized){this.minimized=!1,this.root.querySelector(".content").style.display="",t.draggable(this.root),this.root.style.left=this.old_box.left+"px",this.root.style.top=this.old_box.top+"px",this.root.style.width=this.old_box.width+"px",this.root.style.height=this.old_box.height+"px";var e=this.root.querySelector(".minimize-button");e&&(e.style.display="");var i=this.root.querySelector(".maximize-button");i&&(i.style.display="none"),t.Dialog.minimized.splice(t.Dialog.minimized.indexOf(this),1),t.Dialog.arrangeMinimized(),t.trigger(this,"maximizing")}},e.prototype.makeModal=function(){t.showModalBackground(!0),t.modalbg_div.appendChild(this.root),this.show(),this.center(),t.bind(this,"closed",function(e){t.showModalBackground(!1)})},e.prototype.bringToFront=function(){var t=this.root.parentNode;t.removeChild(this.root),t.appendChild(this.root)},e.prototype.show=function(e,i){if(!this.root.parentNode){if(i){var n=i.ownerDocument,o=n.querySelector(".litegui-wrap")||n.body;o.appendChild(this.root);var r=n.defaultView||n.parentWindow;r.focus()}else t.add(this);this.center()}this.detach_window||(this.root.style.display="",t.trigger(this,"shown"))},e.prototype.hide=function(e){this.root.style.display="none",t.trigger(this,"hidden")},e.prototype.fadeIn=function(t){t=t||1e3,this.root.style.display="",this.root.style.opacity=0;var e=this;setTimeout(function(){e.root.style.transition="opacity "+t+"ms",e.root.style.opacity=1},100)},e.prototype.setPosition=function(t,e){this.root.parentNode||console.warn("LiteGUI.Dialog: Cannot set position of dialog if it is not in the DOM"),this.root.position="absolute",this.root.style.left=t+"px",this.root.style.top=e+"px"},e.prototype.setSize=function(t,e){this.root.style.width="number"==typeof t?t+"px":t,this.root.style.height="number"==typeof e?e+"px":e},e.prototype.setTitle=function(t){this.header&&(this.header.innerHTML=t)},e.prototype.center=function(){if(this.root.parentNode){this.root.position="absolute";var t=this.root.offsetWidth,e=this.root.offsetHeight,i=this.root.parentNode.offsetWidth,n=this.root.parentNode.offsetHeight;this.root.style.left=Math.floor(.5*(i-t))+"px",this.root.style.top=Math.floor(.5*(n-e))+"px"}},e.prototype.adjustSize=function(t,e){if(t=t||0,this.content.style.height="auto",0!=this.content.offsetHeight||e){var i=0,n=this.root.querySelector(".panel-footer");n&&(i+=n.offsetHeight);var o=this.content.offsetWidth,r=this.content.offsetHeight+20+t+i;this.setSize(o,r)}else{var s=this;setTimeout(function(){s.adjustSize(t,!0)},1)}},e.prototype.clear=function(){this.content.innerHTML=""},e.prototype.detachWindow=function(e,i){if(!this.dialog_window){var n=this.root.getClientRects()[0],o=n.width,r=n.height,s="Window",a=this.root.querySelector(".panel-header");a&&(s=a.textContent);var l=window.open("","","width="+o+", height="+r+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");l.document.write("<head><title>"+s+"</title>"),this.dialog_window=l;for(var c=document.querySelectorAll("link[rel='stylesheet'],style"),d=0;d<c.length;d++)l.document.write(c[d].outerHTML);l.document.write("</head><body></body>"),l.document.close();return l.onbeforeunload=function(){var e=t.windows.indexOf(l);-1!=e&&t.windows.splice(e,1),i&&i()},l.document.body.appendChild(this.content),this.root.style.display="none",this._old_height=this.content.style.height,this.content.style.height="100%",t.windows.push(l),e&&e(),l}},e.prototype.reattachWindow=function(e){if(this.dialog_window){this.root.appendChild(this.content),this.root.style.display="",this.content.style.height=this._old_height,delete this._old_height,this.dialog_window.close();var i=t.windows.indexOf(this.dialog_window);-1!=i&&t.windows.splice(i,1),this.dialog_window=null}},e.showAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){var i=t[e];i.dialog.show()}},e.hideAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){var i=t[e];i.dialog.hide()}},e.closeAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){var i=t[e];i.dialog.close()}},t.Dialog=e}),t("skylark-litegui/Dragger",["./litegui"],function(t){function e(e,i){null===e||void 0===e?e=0:e.constructor===String?e=parseFloat(e):e.constructor!==Number&&(e=0),this.value=e;var n=void 0!=i.precision?i.precision:3;this.options=i||{};var o=document.createElement("div");o.className="dragger "+(i.extraclass?i.extraclass:""),this.root=o;var r=document.createElement("span");r.className="inputfield "+(i.extraclass?i.extraclass:"")+(i.full?" full":""),i.disabled&&(r.className+=" disabled"),o.appendChild(r);var s=i.dragger_class||"full",a=document.createElement("input");a.className="text number "+(s||""),a.value=e.toFixed(n)+(i.units?i.units:""),a.tabIndex=i.tab_index,this.input=a,o.input=a,i.disabled&&(a.disabled=!0),i.tab_index&&(a.tabIndex=i.tab_index),r.appendChild(a),a.addEventListener("keydown",function(t){if(38==t.keyCode)p(1,t);else{if(40!=t.keyCode)return;p(-1,t)}return t.stopPropagation(),t.preventDefault(),!0});var l=document.createElement("div");l.className="drag_widget",i.disabled&&(l.className+=" disabled"),r.appendChild(l),o.dragger=l,l.addEventListener("mousedown",function(e){(c=a.ownerDocument).removeEventListener("mousemove",d),c.removeEventListener("mouseup",u),i.disabled||(o.requestPointerLock&&o.requestPointerLock(),c.addEventListener("mousemove",d),c.addEventListener("mouseup",u),l.data=[e.screenX,e.screenY],t.trigger(o,"start_dragging"));e.stopPropagation(),e.preventDefault()}),a.addEventListener("wheel",h,!1),a.addEventListener("mousewheel",h,!1);var c=null;function d(t){var e=t.screenX-l.data[0],n=l.data[1]-t.screenY,o=[e,n];void 0!==t.movementX&&(o=[t.movementX,-t.movementY]),l.data=[t.screenX,t.screenY];var r=i.horizontal?0:1;return p(o[r],t),t.stopPropagation(),t.preventDefault(),!1}function h(t){if(document.activeElement===this){var e=void 0!==t.wheelDelta?t.wheelDelta:t.deltaY?-t.deltaY/3:0;p(e>0?1:-1,t),t.stopPropagation(),t.preventDefault()}}function u(e){t.trigger(o,"stop_dragging");var i=c||document;return c=null,i.removeEventListener("mousemove",d),i.removeEventListener("mouseup",u),i.exitPointerLock&&i.exitPointerLock(),t.trigger(l,"blur"),e.stopPropagation(),e.preventDefault(),!1}function p(e,o){i.linear||(e=e>0?Math.pow(e,1.2):-1*Math.pow(Math.abs(e),1.2));var r=i.step?i.step:1;o&&o.shiftKey?r*=10:o&&o.ctrlKey&&(r*=.1);var s=parseFloat(a.value)+e*r;null!=i.max&&s>i.max&&(s=i.max),null!=i.min&&s<i.min&&(s=i.min),a.value=s.toFixed(n),i.units&&(a.value+=i.units),t.trigger(a,"change")}}return e.prototype.setRange=function(t,e){this.options.min=t,this.options.max=e},e.prototype.setValue=function(e,i){e=parseFloat(e),this.value=e,this.options.precision&&(e=e.toFixed(this.options.precision)),this.options.units&&(e+=this.options.units),this.input.value=e,i||t.trigger(this.input,"change")},e.prototype.getValue=function(){return this.value},t.Dragger=e}),t("skylark-litegui/Inspector",["./litegui"],function(t){function e(e){if(e&&e.constructor===String){var i=e;(e=arguments[1]||{}).id=i,console.warn("LiteGUI.Inspector legacy parameter, use options as first parameter instead of id.")}e=e||{},this.root=document.createElement("DIV"),this.root.className="inspector "+(e.full?"full":"")+(e.className||""),e.one_line&&(this.one_line=!0,this.root.className+=" one_line"),e.id&&(this.root.id=e.id),this.sections=[],this.values={},this.widgets=[],this.widgets_by_name={},this.row_number=0,this.addContainer(),this.tab_index=Math.floor(1e4*Math.random()),e.width&&(this.root.style.width=t.sizeToCSS(e.width)),e.height&&(this.root.style.height=t.sizeToCSS(e.height),e.one_line||(this.root.style.overflow="auto")),e.name_width&&(this.name_width=e.name_width),e.widgets_width&&(this.widgets_width=e.widgets_width),e.noscroll&&(this.root.style.overflow="hidden"),e.onchange&&(this.onchange=e.onchange),e.parent&&this.appendTo(e.parent),this.className=this.root.className,this.widgets_per_row=e.widgets_per_row||1}return e.prototype.getValues=function(){var t={};for(var e in this.widgets_by_name)t[e]=this.widgets_by_name[e].getValue();return t},e.prototype.setValues=function(t){for(var e in t)this.widgets_by_name[e]&&this.widgets_by_name[e].setValue(t[e])},e.prototype.appendTo=function(t,e){t&&(t.constructor===String&&(t=document.querySelector(t)),t&&(e?t.insertBefore(this.root,t.firstChild):t.appendChild(this.root)))},e.prototype.clear=function(){for(purgeElement(this.root,!0);this.root.hasChildNodes();)this.root.removeChild(this.root.lastChild);this.root.className=this.className,this.row_number=0,this.values={},this.widgets=[],this.widgets_by_name={},this.sections=[],this.current_section=null,this._current_container=null,this._current_container_stack=null,this.addContainer()},e.prototype.refresh=function(){this.on_refresh&&this.on_refresh()},e.prototype.append=function(t,e){var i=(e=e||{}).widget_parent||this._current_container||this.root;e.replace?e.replace.parentNode.replaceChild(t,e.replace):(t.section=this.current_section,i.appendChild(t))},e.prototype.pushContainer=function(t){if(this._current_container_stack){if(-1!=this._current_container_stack.indexOf(t))return void console.warn("Container already in the stack");this._current_container_stack.push(t)}else this._current_container_stack=[t];this._current_container=t},e.prototype.isContainerInStack=function(t){return!!this._current_container_stack&&-1!=this._current_container_stack.indexOf(t)},e.prototype.popContainer=function(t){if(this.row_number=0,this._current_container_stack&&this._current_container_stack.length){if(t)for(var e=this._current_container_stack.pop();e&&e!=t;)e=this._current_container_stack.pop();else this._current_container_stack.pop();this._current_container=this._current_container_stack[this._current_container_stack.length-1]}else this._current_container=null},e.prototype.setup=function(t){for(var e in t){var i=t[e];this.add(i.type,i.name,i.value,i.options)}},e.prototype.getWidget=function(t){return null!==t&&t.constructor===Number?this.widgets[t]:this.widgets_by_name[t]},e.prototype.inspectInstance=function(t,e,i,n){if(t){e||(e=t.getProperties?t.getProperties():this.collectProperties(t));var o=t.constructor;!i&&o.properties&&(i=o.properties);var r={};if(t.getInspectorProperties)r=t.getInspectorProperties();else for(var s in e)if(i&&i[s])r[s]=u(i[s]);else{var a=e[s];if(o["@"+s]){var l=o["@"+s];if(l&&null===l.widget)continue;r[s]=u(l)}else if(t["@"+s])r[s]=t["@"+s];else{if(null===a||void 0===a)continue;switch(a.constructor){case Number:r[s]={type:"number",step:.1};break;case String:r[s]={type:"string"};break;case Boolean:r[s]={type:"boolean"};break;default:if(a&&(a.constructor===Array||a.constructor.BYTES_PER_ELEMENT)){var c=null!=a[0]&&a[0].constructor===Number;switch(a.length){case 2:r[s]={type:c?"vec2":"Array",step:.1};break;case 3:r[s]={type:c?"vec3":"Array",step:.1};break;case 4:r[s]={type:c?"vec4":"Array",step:.1};break;default:r[s]={type:"Array"}}}}}}if(n)for(var s in n)delete r[n[s]];if(o.properties_order){var d={};for(var s in o.properties_order){var h=o.properties_order[s];r[h]?d[h]=r[h]:console.warn("property not found in instance:",h)}for(var s in r)d[s]||(d[s]=r[s]);r=d}return this.showProperties(t,r)}function u(t,e){for(var i in e=e||{},t)e[i]=t[i];return e}},e.prototype.collectProperties=function(t){var e={};for(var i in t)if("_"!=i[0]&&"@"!=i[0]&&"jQuery"!=i.substr(0,6)){var n=t[i];n&&n.constructor==Function&&!t.constructor["@"+i]||(e[i]=n)}return e},e.prototype.showProperties=function(t,i){for(var n in i){var o=n,r=i[n];if(r){if(r.constructor===String&&(r={type:r}),r.name&&(o=r.name),!r.callback){var s={instance:t,name:o,options:r};"function"==r.type||(r.callback=e.assignValue.bind(s))}if(!r.callback_update){var s={instance:t,name:o};r.callback_update=function(){return this.instance[this.name]}.bind(s)}r.instance=t,r.varname=o;var a=r.widget||r.type||"string";this.on_addProperty&&this.on_addProperty(a,t,o,t[o],r),this.add(a,o,t[o],r)}}if(t.constructor.widgets)for(var n in t.constructor.widgets){var l=t.constructor.widgets[n];this.add(l.widget,l.name,l.value,l)}t.onShowProperties&&t.onShowProperties(this),t.constructor.onShowProperties&&t.constructor.onShowProperties(t,this)},e.assignValue=function(t){var e=this.instance,i=e[this.name];if(null==i||null==t||"enum"==this.options.type)e[this.name]=t;else if("number"==typeof i)e[this.name]=parseFloat(t);else if("string"==typeof i)e[this.name]=t;else if(!(t&&t.length&&i&&i.length)||Object.getOwnPropertyDescriptor(e,this.name)&&Object.getOwnPropertyDescriptor(e,this.name).set||Object.getOwnPropertyDescriptor(e.__proto__,this.name)&&Object.getOwnPropertyDescriptor(e.__proto__,this.name).set)e[this.name]=t;else for(var n=0;n<t.length;++n)i[n]=t[n]},e.prototype.createWidget=function(e,i,n){n=n||{},i=void 0===i||null===i?"":i;var o=document.createElement("DIV");o.className="widget "+(n.className||""),o.inspector=this,o.options=n,o.name=e,this.row_number+=this.widgets_per_row,this.row_number%2==0&&(o.className+=" even");var r=n.width||this.widgets_width;r&&(o.style.width=t.sizeToCSS(r),o.style.width||(o.style.width="calc("+t.sizeToCSS(r)+")"),o.style.minWidth="auto");var s=n.height||this.height;s&&(o.style.height=t.sizeToCSS(s),o.style.height||(o.style.height="calc("+t.sizeToCSS(s)+")"),o.style.minHeight="auto"),this.widgets.push(o),(n.widget_name||e)&&(this.widgets_by_name[n.widget_name||e]=o),1!=this.widgets_per_row&&(n.width||(o.style.width=(100/this.widgets_per_row).toFixed(2)+"%"),o.style.display="inline-block");var a="",l="";if(void 0!==e&&null!==e&&(this.name_width||n.name_width)&&!this.one_line){var c=t.sizeToCSS(n.name_width||this.name_width);a="style='width: calc("+c+" - 0px); width: -webkit-calc("+c+" - 0px); width: -moz-calc("+c+" - 0px); '",l="style='width: calc( 100% - "+c+"); width: -webkit-calc(100% - "+c+"); width: -moz-calc( 100% - "+c+"); '"}n.name_width&&(a="style='width: "+t.sizeToCSS(n.name_width)+" '"),n.content_width&&(l="style='width: "+t.sizeToCSS(n.content_width)+" '");var d="",h="",u=this.one_line?"":"<span class='filling'></span>";n.pretitle&&(h=n.pretitle);var p="wcontent ",f=e;if(n.title&&(f=n.title),null===e||void 0===e?p+=" full":d+=""===e?"<span class='wname' title='"+f+"' "+a+">"+h+"</span>":"<span class='wname' title='"+f+"' "+a+">"+h+e+u+"</span>",i.constructor===String||i.constructor===Number||i.constructor===Boolean)o.innerHTML=d+"<span class='info_content "+p+"' "+l+">"+i+"</span>";else{o.innerHTML=d+"<span class='info_content "+p+"' "+l+"></span>";var v=o.querySelector("span.info_content");v&&v.appendChild(i)}return o.content=o.querySelector("span.info_content"),o.remove=function(){this.parentNode&&this.parentNode.removeChild(this)},o},e.onWidgetChange=function(e,i,n,o,r,s){var a=e.section;o.skip_wchange||(a&&t.trigger(a,"wbeforechange",n),t.trigger(e,"wbeforechange",n)),this.values[i]=n;var l=void 0;return o.callback&&(l=r?o.callback.apply(e,n):o.callback.call(e,n,s)),o.skip_wchange||(a&&t.trigger(a,"wchange",n,e),t.trigger(e,"wchange",n,e)),this.onchange&&this.onchange(i,n,e),l},e.widget_constructors={null:"addNull",title:"addTitle",info:"addInfo",default:"addDefault",number:"addNumber",slider:"addSlider",string:"addString",text:"addString",textarea:"addTextarea",color:"addColor",boolean:"addCheckbox",checkbox:"addCheckbox",icon:"addIcon",vec2:"addVector2",vector2:"addVector2",vec3:"addVector3",vector3:"addVector3",vec4:"addVector4",vector4:"addVector4",enum:"addCombo",dropdown:"addCombo",combo:"addCombo",button:"addButton",buttons:"addButtons",file:"addFile",line:"addLine",list:"addList",tree:"addTree",datatree:"addDataTree",pad:"addPad",array:"addArray",separator:"addSeparator"},e.registerWidget=function(t,i){var n="add"+t.charAt(0).toUpperCase()+t.slice(1);e.prototype[n]=i,e.widget_constructors[t]=n},e.prototype.add=function(e,i,n,o){if(!e)throw"Inspector: no type specified";1==arguments.length&&"object"==typeof e&&(e=(o=e).type,i=o.name,n=o.value);var r=t.Inspector.widget_constructors[e.toLowerCase()];if(r){if(r.constructor===String&&(r=t.Inspector.prototype[r]),r&&r.constructor===Function)return o&&o.constructor===Function&&(o={callback:o}),r.call(this,i,n,o)}else console.warn("LiteGUI.Inspector do not have a widget called",e)},e.prototype.getValue=function(t){return this.values[t]},e.prototype.applyOptions=function(e,i){e&&i&&(i.className&&(e.className+=" "+i.className),i.id&&(e.id=i.id),i.width&&(e.style.width=t.sizeToCSS(i.width)),i.height&&(e.style.height=t.sizeToCSS(i.height)))},e.prototype.addSeparator=function(){var t=document.createElement("DIV");return t.className="separator",this.append(t),t},e.prototype.addNull=function(t,e,i){return null},e.prototype.addDefault=function(t,e,i){return null===e||void 0===e?null:e.constructor===Boolean?this.addCheckbox(t,e,i):e.constructor===String?this.addString(t,e,i):e.constructor===Number?this.addNumber(t,e,i):4==e.length?this.addVector4(t,e,i):3==e.length?this.addVector3(t,e,i):2==e.length?this.addVector2(t,e,i):null},e.prototype.addString=function(i,n,o){o=this.processOptions(o),n=n||"";var r=this;this.values[i]=n;var s="text";o.password&&(s="password");var a=o.focus?"autofocus":"",l=this.createWidget(i,"<span class='inputfield full "+(o.disabled?"disabled":"")+"'><input type='"+s+"' tabIndex='"+this.tab_index+"' "+a+" class='text string' value='"+n+"' "+(o.disabled?"disabled":"")+"/></span>",o),c=l.querySelector(".wcontent input");return o.placeHolder&&c.setAttribute("placeHolder",o.placeHolder),"right"==o.align&&(c.style.direction="rtl"),c.addEventListener(o.immediate?"keyup":"change",function(t){var n=e.onWidgetChange.call(r,l,i,t.target.value,o);void 0!==n&&(this.value=n)}),o.callback_enter&&c.addEventListener("keydown",function(t){if(13==t.keyCode){e.onWidgetChange.call(r,l,i,t.target.value,o);o.callback_enter(),t.preventDefault()}}),this.tab_index+=1,l.setIcon=function(t){t?(c.style.background="transparent url('"+t+"') no-repeat left 4px center",c.style.paddingLeft="1.7em"):(c.style.background="",c.style.paddingLeft="")},o.icon&&l.setIcon(o.icon),l.setValue=function(e,i){void 0!==e&&e!==c.value&&(c.value=e,i||t.trigger(c,"change"))},l.getValue=function(){return c.value},l.focus=function(){this.querySelector("input").focus()},l.disable=function(){c.disabled=!0},l.enable=function(){c.disabled=!1},this.append(l,o),this.processElement(l,o),l},e.prototype.addStringButton=function(i,n,o){o=this.processOptions(o),void 0===n&&(n="");var r=this;this.values[i]=n;var s=this.createWidget(i,"<span class='inputfield button'><input type='text' tabIndex='"+this.tab_index+"' class='text string' value='' "+(o.disabled?"disabled":"")+"/></span><button class='micro'>"+(o.button||"...")+"</button>",o),a=s.querySelector(".wcontent input");a.value=n,a.addEventListener("change",function(t){var n=e.onWidgetChange.call(r,s,i,t.target.value,o);void 0!==n&&(this.value=n)}),o.disabled&&a.setAttribute("disabled","disabled"),s.setIcon=function(t){t?(a.style.background="transparent url('"+t+"') no-repeat left 4px center",a.style.paddingLeft="1.7em"):(a.style.background="",a.style.paddingLeft="")},o.icon&&s.setIcon(o.icon);var l=s.querySelector(".wcontent button");if(l.addEventListener("click",function(t){o.callback_button&&o.callback_button.call(s,a.value,t)}),o.button_width){l.style.width=t.sizeToCSS(o.button_width);var c=s.querySelector(".inputfield");c.style.width="calc( 100% - "+l.style.width+" - 6px)"}return this.tab_index+=1,this.append(s,o),s.setValue=function(e,i){a.value=e,i||t.trigger(a,"change")},s.disable=function(){a.disabled=!0,l.disabled=!0},s.enable=function(){a.disabled=!1,l.disabled=!1},s.getValue=function(){return a.value},s.focus=function(){t.focus(a)},this.processElement(s,o),s},e.prototype.addTextarea=function(i,n,o){o=this.processOptions(o),n=n||"";var r=this;this.values[i]=n;var s=this.createWidget(i,"<span class='inputfield textarea "+(o.disabled?"disabled":"")+"'><textarea tabIndex='"+this.tab_index+"' "+(o.disabled?"disabled":"")+"></textarea></span>",o);this.tab_index++;var a=s.querySelector(".wcontent textarea");return a.value=n,a.addEventListener(o.immediate?"keyup":"change",function(t){e.onWidgetChange.call(r,s,i,t.target.value,o,!1,t)}),o.callback_keydown&&a.addEventListener("keydown",o.callback_keydown),o.height&&(a.style.height="calc( "+t.sizeToCSS(o.height)+" - 5px )"),this.append(s,o),s.setValue=function(e,i){void 0!==e&&e!=a.value&&(n=e,a.value=e,i||t.trigger(a,"change"))},s.getValue=function(t){return a.value},s.focus=function(){t.focus(a)},s.disable=function(){a.disabled=!0},s.enable=function(){a.disabled=!1},this.processElement(s,o),s},e.prototype.addNumber=function(e,i,n){n=this.processOptions(n),i=i||0;var o=this;this.values[e]=i;var r=this.createWidget(e,"",n);this.append(r,n),n.extraclass="full",n.tab_index=this.tab_index,n.full=!0,n.precision=void 0!==n.precision?n.precision:2,n.step=void 0===n.step?0==n.precision?1:.1:n.step,this.tab_index++;var s=null;(s=new t.Dragger(i,n)).root.style.width="calc( 100% - 1px )",r.querySelector(".wcontent").appendChild(s.root),s.root.addEventListener("start_dragging",function(t){this.callback_before&&this.callback_before.call(r)}.bind(n)),r.dragger=s,n.disabled&&s.input.setAttribute("disabled","disabled");var a=r.querySelector("input");return a.addEventListener("change",function(i){if(t.trigger(r,"wbeforechange",i.target.value),o.values[e]=i.target.value,n.callback){var s=n.callback.call(r,parseFloat(i.target.value));"number"==typeof s&&(this.value=s)}t.trigger(r,"wchange",i.target.value),o.onchange&&o.onchange(e,i.target.value,r)}),r.setValue=function(e,i){void 0!==e&&(e=parseFloat(e),n.precision&&(e=e.toFixed(n.precision)),e+=n.units||"",a.value!=e&&(a.value=e,i||t.trigger(a,"change")))},r.setRange=function(t,e){s.setRange(t,e)},r.getValue=function(){return parseFloat(a.value)},r.focus=function(){t.focus(a)},r.disable=function(){a.disabled=!0},r.enable=function(){a.disabled=!1},this.processElement(r,n),r},e.prototype.addVector2=function(e,i,n){(n=this.processOptions(n)).step||(n.step=.1),i=i||[0,0];var o=this;this.values[e]=i;var r=this.createWidget(e,"",n);n.step=n.step||.1,n.tab_index=this.tab_index,n.full=!0,this.tab_index++;var s=r.querySelector(".wcontent"),a=new t.Dragger(i[0],n);a.root.style.marginLeft=0,a.root.style.width="calc( 50% - 1px )",s.appendChild(a.root),n.tab_index=this.tab_index,this.tab_index++;var l=new t.Dragger(i[1],n);function c(t){this.callback_before&&this.callback_before(t)}l.root.style.width="calc( 50% - 1px )",s.appendChild(l.root),r.draggers=[a,l],t.bind(a.root,"start_dragging",c.bind(n)),t.bind(l.root,"start_dragging",c.bind(n));for(var d=r.querySelectorAll("input"),h=0;h<d.length;++h)d[h].addEventListener("change",function(i){for(var s=[],a=d,l=0;l<a.length;l++)s.push(parseFloat(a[l].value));if(t.trigger(r,"wbeforechange",[s]),o.values[e]=s,n.callback){var c=n.callback.call(r,s);if("object"==typeof c&&c.length>=2){for(var l=0;l<a.length;l++)a[l].value=c[l];s=c}}t.trigger(r,"wchange",[s]),o.onchange&&o.onchange(e,s,r)});return this.append(r,n),r.setValue=function(t,e){t&&(a.getValue()!=t[0]&&a.setValue(t[0],!0),l.getValue()!=t[1]&&l.setValue(t[1],e))},r.setRange=function(t,e){a.setRange(t,e),l.setRange(t,e)},this.processElement(r,n),r},e.prototype.addVector3=function(e,i,n){(n=this.processOptions(n)).step||(n.step=.1),i=i||[0,0,0];var o=this;this.values[e]=i;var r=this.createWidget(e,"",n);n.step=n.step||.1,n.tab_index=this.tab_index,n.full=!0,this.tab_index++;var s=new t.Dragger(i[0],n);s.root.style.marginLeft=0,s.root.style.width="calc( 33% - 1px )",r.querySelector(".wcontent").appendChild(s.root),n.tab_index=this.tab_index,this.tab_index++;var a=new t.Dragger(i[1],n);a.root.style.width="calc( 33% - 1px )",r.querySelector(".wcontent").appendChild(a.root),n.tab_index=this.tab_index,this.tab_index++;var l=new t.Dragger(i[2],n);function c(t){this.callback_before&&this.callback_before()}l.root.style.width="calc( 33% - 1px )",r.querySelector(".wcontent").appendChild(l.root),r.draggers=[s,a,l],s.root.addEventListener("start_dragging",c.bind(n)),a.root.addEventListener("start_dragging",c.bind(n)),l.root.addEventListener("start_dragging",c.bind(n));for(var d=r.querySelectorAll("input"),h=0;h<d.length;++h)d[h].addEventListener("change",function(i){for(var s=[],a=d,l=0;l<a.length;l++)s.push(parseFloat(a[l].value));if(t.trigger(r,"wbeforechange",[s]),o.values[e]=s,n.callback){var c=n.callback.call(r,s);if("object"==typeof c&&c.length>=3){for(var l=0;l<a.length;l++)a[l].value=c[l];s=c}}t.trigger(r,"wchange",[s]),o.onchange&&o.onchange(e,s,r)});return this.append(r,n),r.setValue=function(t,e){t&&(s.setValue(t[0],!0),a.setValue(t[1],!0),l.setValue(t[2],e))},r.setRange=function(t,e){s.setRange(t,e),a.setRange(t,e),l.setRange(t,e)},this.processElement(r,n),r},e.prototype.addVector4=function(e,i,n){(n=this.processOptions(n)).step||(n.step=.1),i=i||[0,0,0];var o=this;this.values[e]=i;var r=this.createWidget(e,"",n);n.step=n.step||.1,n.tab_index=this.tab_index,n.full=!0,this.tab_index++;for(var s=r.draggers=[],a=0;a<4;a++){var l=new t.Dragger(i[a],n);l.root.style.marginLeft=0,l.root.style.width="calc( 25% - 1px )",r.querySelector(".wcontent").appendChild(l.root),n.tab_index=this.tab_index,this.tab_index++,l.root.addEventListener("start_dragging",c.bind(n)),s.push(l)}function c(t){this.callback_before&&this.callback_before()}for(var d=r.querySelectorAll("input"),a=0;a<d.length;++a)d[a].addEventListener("change",function(i){for(var s=[],a=d,l=0;l<a.length;l++)s.push(parseFloat(a[l].value));if(t.trigger(r,"wbeforechange",[s]),o.values[e]=s,n.callback){var c=n.callback.call(r,s);if("object"==typeof c&&c.length>=4){for(var l=0;l<a.length;l++)a[l].value=c[l];s=c}}t.trigger(r,"wchange",[s]),o.onchange&&o.onchange(e,s,r)});return this.append(r,n),r.setValue=function(t,e){if(t)for(var i=0;i<s.length;i++)s[i].setValue(t[i],e)},r.setRange=function(t,e){for(var i in s)s[i].setRange(t,e)},this.processElement(r,n),r},e.prototype.addPad=function(e,i,n){(n=this.processOptions(n)).step||(n.step=.1),i=i||[0,0];var o=this;this.values[e]=i;var r=this.createWidget(e,"",n);n.step=n.step||.1,n.tab_index=this.tab_index,n.full=!0,this.tab_index++;var s=n.minx||n.min||0,a=n.miny||n.min||0,l=n.maxx||n.max||1,c=n.maxy||n.max||1,d=r.querySelector(".wcontent"),h=document.createElement("div");h.className="litepad",d.appendChild(h),h.style.width="100%",h.style.height="100px",n.background&&(h.style.backgroundImage="url('"+n.background+"')",h.style.backgroundSize="100%",h.style.backgroundRepeat="no-repeat");var u=document.createElement("div");u.className="litepad-handler",h.appendChild(u),n.tab_index=this.tab_index,this.tab_index++;return h._onMouseEvent=function(i){var d=h.getBoundingClientRect();if(i.mousex=i.pageX-d.left,i.mousey=i.pageY-d.top,i.preventDefault(),i.stopPropagation(),"mousedown"==i.type)document.body.addEventListener("mousemove",h._onMouseEvent),document.body.addEventListener("mouseup",h._onMouseEvent),!0;else if("mousemove"==i.type){var u=i.mousex/d.width,p=i.mousey/d.height,f=[u=u*(l-s)+s,p=p*(c-a)+s];if(t.trigger(r,"wbeforechange",[f]),r.setValue(f),n.callback){var v=n.callback.call(r,f);if(v&&v.length>=2)for(var g=0;g<elems.length;g++)r.setValue(v)}t.trigger(r,"wchange",[f]),o.onchange&&o.onchange(e,f,r)}else"mouseup"==i.type&&(!1,document.body.removeEventListener("mousemove",h._onMouseEvent),document.body.removeEventListener("mouseup",h._onMouseEvent));return!0},h.addEventListener("mousedown",h._onMouseEvent),r.setValue=function(t,e){if(void 0!==t){var i=h.getBoundingClientRect(),n=(t[0]-s)/(l-s),o=(t[1]-a)/(c-a);n=Math.max(0,Math.min(n,1)),o=Math.max(0,Math.min(o,1));var r=(i.width-10)/i.width*100,d=(i.height-10)/i.height*100;u.style.left=(n*r).toFixed(1)+"%",u.style.top=(o*d).toFixed(1)+"%"}},this.append(r,n),r.setValue(i),this.processElement(r,n),r},e.prototype.addInfo=function(e,i,n){n=this.processOptions(n),i=void 0===i||null===i?"":i;var o=null;null!=e?o=this.createWidget(e,i,n):(o=document.createElement("div"),n.className&&(o.className=n.className),void 0!==i.nodeName?(o.innerHTML="<span class='winfo'></span>",o.childNodes[0].appendChild(i)):o.innerHTML="<span class='winfo'>"+i+"</span>");var r=o.querySelector(".winfo")||o.querySelector(".wcontent");n.callback&&o.addEventListener("click",n.callback.bind(o)),o.setValue=function(t){void 0!==t&&r&&(r.innerHTML=t)};var s=o.querySelector("span.info_content");return s||(s=o.querySelector(".winfo")),n.width&&(o.style.width=t.sizeToCSS(n.width),o.style.display="inline-block",e||(r.style.margin="2px")),n.height&&(s.style.height=t.sizeToCSS(n.height),s.style.overflow="auto"),o.scrollToBottom=function(){s.scrollTop=s.offsetTop},o.add=function(t){s.appendChild(t)},this.append(o,n),this.processElement(o,n),o},e.prototype.addSlider=function(i,n,o){void 0===(o=this.processOptions(o)).min&&(o.min=0),void 0===o.max&&(o.max=1),void 0===o.step&&(o.step=.01);var r=this;void 0!==n&&null!==n||(n=0),this.values[i]=n;var s=this.createWidget(i,"<span class='inputfield full'>\t\t\t\t\t<input tabIndex='"+this.tab_index+"' type='text' class='slider-text fixed liteslider-value' value='' /><span class='slider-container'></span></span>",o),a=s.querySelector(".slider-container"),l=new t.Slider(n,o);a.appendChild(l.root);var c=s.querySelector(".slider-text");return c.value=n,c.addEventListener("change",function(t){var a=parseFloat(this.value);n=a,l.setValue(a),e.onWidgetChange.call(r,s,i,a,o)}),l.onChange=function(t){c.value=t,e.onWidgetChange.call(r,s,i,t,o)},this.append(s,o),s.setValue=function(t,e){void 0!==t&&(n=t,l.setValue(t,e))},s.getValue=function(){return n},this.processElement(s,o),s},e.prototype.addCheckbox=function(i,n,o){o=this.processOptions(o),n=!!n;var r=this;this.values[i]=n;var s=o.label_on||o.label||"on",a=o.label_off||o.label||"off",l=n?s:a,c=this.createWidget(i,"<span class='inputfield'><span tabIndex='"+this.tab_index+"' class='fixed flag checkbox "+(n?"on":"off")+"'>"+l+"</span></span>",o);this.tab_index++;var d=c.querySelector(".wcontent .checkbox");return d.addEventListener("keypress",function(e){32==e.keyCode&&t.trigger(this,"click")}),c.addEventListener("click",function(){n=!n,c.querySelector("span.flag").innerHTML=n?s:a,n?d.classList.add("on"):d.classList.remove("on"),e.onWidgetChange.call(r,c,i,n,o)}),c.getValue=function(){return n},c.setValue=function(e,o){void 0!==e&&(n=e,r.values[i]==e||o||t.trigger(d,"click"))},this.append(c,o),this.processElement(c,o),c},e.prototype.addFlags=function(t,e,i){var n={};for(var o in t)n[o]=t[o];if(e)for(var o in e)void 0===n[o]&&(n[o]=!!e[o]);for(var o in n){var r={};for(var s in i)r[s]=i[s];r.callback=function(e){return function(i){t[e]=i}}(o),this.addCheckbox(o,n[o],r)}},e.prototype.addCombo=function(t,i,n){n=this.processOptions(n);var o=this;this.values[t]=i,this.tab_index++;var r=this.createWidget(t,"<span class='inputfield full inputcombo "+(n.disabled?"disabled":"")+"'></span>",n);r.options=n;var s=n.values||[];s.constructor===Function&&(s=n.values());var a="<select tabIndex='"+this.tab_index+"' "+(n.disabled?"disabled":"")+" class='"+(n.disabled?"disabled":"")+"'></select>";r.querySelector("span.inputcombo").innerHTML=a,d(s);var l=!1,c=r.querySelector(".wcontent select");function d(t,e){t||(t=[]),s=t,e&&(i=e);var n="",o=0;for(var a in s){var l=s[a],c=s.constructor===Array?o:a,d=s.constructor===Array?l:a;l&&l.title&&(d=l.title),n+="<option value='"+c+"' "+(l==i?" selected":"")+" data-index='"+c+"'>"+d+"</option>",o++}r.querySelector("select").innerHTML=n}return c.addEventListener("change",function(a){var c=a.target.value;i=s[c],l||e.onWidgetChange.call(o,r,t,i,n)}),r.getValue=function(){return i},r.setValue=function(t,e){if(void 0!==t){i=t;var n=r.querySelector("select"),o=n.querySelectorAll("option"),a=-1;if(s.constructor===Array)a=s.indexOf(t);else{var c=0;for(var d in s){if(s[c]==t){a=c;break}c++}}if(-1!=a){for(var d in l=e,o){var h=o[d];h&&h.dataset&&(parseFloat(h.dataset.index)==a?(h.setAttribute("selected",!0),n.selectedIndex=a):h.removeAttribute("selected"))}l=!1}}},r.setOptionValues=d,this.append(r,n),this.processElement(r,n),r},e.prototype.addComboButtons=function(i,n,o){o=this.processOptions(o),n=n||"";var r=this;this.values[i]=n;var s="";if(o.values)for(var a in o.values)s+="<button class='wcombobutton "+(n==o.values[a]?"selected":"")+"' data-name='options.values[i]'>"+o.values[a]+"</button>";var l=this.createWidget(i,s,o),c=l.querySelectorAll(".wcontent button");return t.bind(c,"click",function(t){var n=t.target.innerHTML;r.values[i]=n;for(var s=l.querySelectorAll(".selected"),a=0;a<s.length;++a)s[a].classList.remove("selected");this.classList.add("selected"),e.onWidgetChange.call(r,l,i,n,o)}),this.append(l,o),this.processElement(l,o),l},e.prototype.addTags=function(i,n,o){o=this.processOptions(o),n=n||[];var r=this;this.values[i]=n;var s="<select>";if(o.values)for(var a in o.values)s+="<option>"+o.values[a]+"</option>";s+="</select><div class='wtagscontainer inputfield'></div>";var l=this.createWidget(i,"<span class='inputfield full'>"+s+"</span>",o);for(var a in l.tags={},o.value)d(o.value[a]);var c=l.querySelector(".wcontent select");function d(n){if(!l.tags[n]){t.trigger(l,"wbeforechange",l.tags),l.tags[n]=!0;var s=document.createElement("div");s.data=n,s.className="wtag",s.innerHTML=n+"<span class='close'>X</span>",s.querySelector(".close").addEventListener("click",function(n){var s=this.parentNode.data;delete l.tags[s],t.remove(this.parentNode),t.trigger(l,"wremoved",s),e.onWidgetChange.call(r,l,i,l.tags,o)}),l.querySelector(".wtagscontainer").appendChild(s),r.values[i]=l.tags,o.callback&&o.callback.call(l,l.tags),t.trigger(l,"wchange",l.tags),t.trigger(l,"wadded",n),r.onchange&&r.onchange(i,l.tags,l)}}return c.addEventListener("change",function(t){d(t.target.value)}),this.append(l,o),this.processElement(l,o),l},e.prototype.addList=function(i,n,o){var r=this,s="";(o=this.processOptions(o)).height&&(s="style='height: 100%; overflow: auto;'");var a="<ul class='lite-list' "+s+" tabIndex='"+this.tab_index+"'><ul>";this.tab_index++;var l=this.createWidget(i,"<span class='inputfield full "+(o.disabled?"disabled":"")+"' style='height: 100%;'>"+a+"</span>",o),c=l.querySelector(".info_content");c.style.height="100%";l.querySelector(".lite-list");var d=l.querySelector(".inputfield");d.style.height="100%",d.style.paddingBottom="0.2em";for(var h=l.querySelectorAll("ul"),u=0;u<h.length;++u){var p=h[u];p.addEventListener("focus",function(){document.addEventListener("keydown",f,!0)}),p.addEventListener("blur",function(){document.removeEventListener("keydown",f,!0)})}function f(e){var i=l.querySelector("li.selected");if(i){if(13==e.keyCode){if(!i)return;var s=n[i.dataset.pos];o.callback_dblclick&&o.callback_dblclick.call(r,s)}else if(40==e.keyCode){var a=i.nextSibling;a&&t.trigger(a,"click"),i.scrollIntoViewIfNeeded&&i.scrollIntoViewIfNeeded({block:"end",behavior:"smooth"})}else{if(38!=e.keyCode)return;var c=i.previousSibling;c&&t.trigger(c,"click"),i.scrollIntoViewIfNeeded&&i.scrollIntoViewIfNeeded({block:"end",behavior:"smooth"})}return e.preventDefault(),e.stopPropagation(),!0}}function v(s){if(o.multiselection)this.classList.toggle("selected");else{for(var a=l.querySelectorAll("li"),c=0;c<a.length;++c)a[c].classList.remove("selected");this.classList.add("selected")}var d=n[this.dataset.pos];e.onWidgetChange.call(r,l,i,d,o),t.trigger(l,"wadded",d)}function g(t){var e=n[this.dataset.pos];o.callback_dblclick&&o.callback_dblclick.call(r,e)}function m(e,i,n){var r=n,s=n;i=!!i;var a=null,l="";null!=e&&(e.constructor===String||e.constructor===Number||e.constructor===Boolean?s=String(e):e&&(s=e.content||e.title||e.name||n,a=e.style,e.icon&&(l="<img src='"+e.icon+"' class='icon' /> "),e.selected&&(i=!0)));var c=s;c=c.replace(/<(?:.|\n)*?>/gm,"");var d=document.createElement("li");return d.classList.add("item-"+t.safeName(r)),i&&d.classList.add("selected"),d.dataset.name=c,d.dataset.pos=r,d.value=e,a&&d.setAttribute("style",a),d.innerHTML=l+s,d.addEventListener("click",v),o.callback_dblclick&&d.addEventListener("dblclick",g),d}return l.updateItems=function(e,i){i=i||o.selected;n=e;var r=this.querySelector("ul");if(r.innerHTML="",n)for(var s in n){var a=n[s],l=m(a,i,s);r.appendChild(l)}t.bind(r.querySelectorAll("li"),"click",v)},l.addItem=function(t,e,i){if(n.constructor===Array){n.push(t);var o=this.querySelector("ul"),r=m(t,e);o.appendChild(r)}else console.error("cannot add item to list of object, only array")},l.removeItem=function(e){for(var i=l.querySelectorAll(".wcontent li"),n=0;n<i.length;n++)i[n].dataset.name==e&&t.remove(i[n])},l.updateItems(n,o.selected),this.append(l,o),l.getSelected=function(){for(var t=[],e=this.querySelectorAll("ul li.selected"),i=0;i<e.length;++i)t.push(e[i].dataset.name);return t},l.getByIndex=function(t){var e=this.querySelectorAll("ul li");return e[t]},l.getIndex=l.getByIndex,l.selectIndex=function(t,e){for(var i=this.querySelectorAll("ul li"),n=0;n<i.length;++n){var o=i[n];n==t?o.classList.add("selected"):e||o.classList.remove("selected")}return i[t]},l.deselectIndex=function(t){var e=this.querySelectorAll("ul li"),i=e[t];return i&&i.classList.remove("selected"),i},l.scrollToIndex=function(t){var e=this.querySelectorAll("ul li"),i=e[t];i&&(this.scrollTop=i.offsetTop)},l.selectAll=function(){for(var e=this.querySelectorAll("ul li"),i=0;i<e.length;++i){var n=e[i];n.classList.contains("selected")||t.trigger(n,"click")}},l.deselectAll=function(){for(var e=this.querySelectorAll("ul li"),i=0;i<e.length;++i){var n=e[i];n.classList.contains("selected")&&t.trigger(n,"click")}},l.setValue=function(t){void 0!==t&&this.updateItems(t)},l.getNumberOfItems=function(){var t=this.querySelectorAll("ul li");return t.length},l.filter=function(t,e){var i=this.querySelectorAll("ul li"),n=!1;if(t&&t.constructor===String){var o=t;e&&o.toLowerCase(),n=!0,t=function(t){return-1!=(e?t:t.toLowerCase()).indexOf(o)}}for(var r=0;r<i.length;++r){var s=i[r];if(t){var a=s.value;n&&null!=a&&a.constructor!==String&&(a=s.innerHTML),t(a,s,s.classList.contains("selected"))?s.style.display="":s.style.display="none"}else s.style.display=""}},l.selectByFilter=function(t){for(var e=this.querySelectorAll("ul li"),i=0;i<e.length;++i){var n=e[i],o=t(n.value,n,n.classList.contains("selected"));!0===o?n.classList.add("selected"):!1===o&&n.classList.remove("selected")}},o.height&&(l.scrollTop=0),this.processElement(l,o),l},e.prototype.addButton=function(i,n,o){o=this.processOptions(o),n=o.button_text||n||"";var r=this,s="";null===i&&(s="single"),o.micro&&(s+=" micro");var a="";o.disabled&&(a="disabled='disabled'");var l=o.title||"",c=this.createWidget(i,"<button tabIndex='"+this.tab_index+"' "+a+"></button>",o);this.tab_index++;var d=c.querySelector("button");return d.setAttribute("title",l),d.className="litebutton "+s,d.innerHTML=n,d.addEventListener("click",function(s){e.onWidgetChange.call(r,c,i,this.innerHTML,o,!1,s),t.trigger(d,"wclick",n)}),this.append(c,o),c.wclick=function(e){o.disabled||t.bind(this,"wclick",e)},c.setValue=function(t){void 0!==t&&(d.innerHTML=t)},c.disable=function(){d.disabled=!0},c.enable=function(){d.disabled=!1},this.processElement(c,o),c},e.prototype.addButtons=function(i,n,o){o=this.processOptions(o);var r=this,s="",a="calc( "+(100/(n=n||"").length).toFixed(3)+"% - 4px )",l="width:"+a+"; width: -moz-"+a+"; width: -webkit-"+a+"; margin: 2px;";if(n&&"object"==typeof n)for(var c in n){var d="";o.title&&o.title.constructor===Array&&(d=o.title[c]||""),s+="<button class='litebutton' title='"+d+"' tabIndex='"+this.tab_index+"' style='"+l+"'>"+n[c]+"</button>",this.tab_index++}for(var h=this.createWidget(i,s,o),u=h.querySelectorAll("button"),c=0;c<u.length;++c){var p=u[c];p.addEventListener("click",function(n){e.onWidgetChange.call(r,h,i,this.innerHTML,o,null,n),t.trigger(h,"wclick",this.innerHTML)})}return this.append(h,o),this.processElement(h,o),h},e.prototype.addIcon=function(i,n,o){o=this.processOptions(o),n=n||"";var r=this,s=o.image,a=o.width||o.size||20,l=o.height||o.size||20,c=this.createWidget(i,"<span class='icon' "+(o.title?"title='"+o.title+"'":"")+" tabIndex='"+this.tab_index+"'></span>",o);this.tab_index++;var d=c.querySelector("span.wcontent"),h=c.querySelector("span.icon"),u=o.x||0;o.index&&(u=o.index*-a);var p=n?l:0;return c.style.minWidth=c.style.width=a+"px",c.style.margin="0 2px",c.style.padding="0",d.style.margin="0",d.style.padding="0",h.style.display="inline-block",h.style.cursor="pointer",h.style.width=a+"px",h.style.height=l+"px",h.style.backgroundImage="url('"+s+"')",h.style.backgroundPosition=u+"px "+p+"px",h.addEventListener("mousedown",function(s){s.preventDefault(),n=!n;var a=e.onWidgetChange.call(r,c,i,n,o);t.trigger(c,"wclick",n),void 0!==a&&(n=a);var d=n?l:0;h.style.backgroundPosition=u+"px "+d+"px",!1===o.toggle&&setTimeout(function(){h.style.backgroundPosition=u+"px 0px",n=!1},200)}),this.append(c,o),c.setValue=function(t,s){if(void 0!==t){var a=(n=t)?l:0;h.style.backgroundPosition=u+"px "+a+"px",s||e.onWidgetChange.call(r,c,i,n,o)}},c.getValue=function(){return n},this.processElement(c,o),c},e.prototype.addColor=function(i,n,o){o=this.processOptions(o),n=n||[0,0,0];var r=this;this.values[i]=n;var s="<input tabIndex='"+this.tab_index+"' id='colorpicker-"+i+"' class='color' value='"+n[0]+","+n[1]+","+n[2]+"' "+(o.disabled?"disabled":"")+"/>";this.tab_index++,o.show_rgb&&(s+="<span class='rgb-color'>"+e.parseColor(n)+"</span>");var a=this.createWidget(i,s,o);this.append(a,o);var l=a.querySelector("input.color"),c=null;if(window.jscolor){if((c=new jscolor.color(l)).pickerFaceColor="#333",c.pickerBorderColor="black",c.pickerInsetColor="#222",c.rgb_intensity=1,o.disabled&&(c.pickerOnfocus=!1),n.constructor!==String&&n.length&&n.length>2){c.fromRGB(1*n[0],1*n[1],1*n[2]),c.rgb_intensity=1}l.addEventListener("change",function(e){var i=a.querySelector(".rgb-color");i&&(i.innerHTML=t.Inspector.parseColor(c.rgb))}),c.onImmediateChange=function(){var e=[c.rgb[0]*c.rgb_intensity,c.rgb[1]*c.rgb_intensity,c.rgb[2]*c.rgb_intensity],n=[e.concat(),c.toString()];t.trigger(a,"wbeforechange",n),r.values[i]=e,o.callback&&o.callback.call(a,e.concat(),"#"+c.toString(),c),t.trigger(a,"wchange",n),r.onchange&&r.onchange(i,e.concat(),a)},o.step=o.step||.01,o.dragger_class="nano";var d=new t.Dragger(1,o);a.querySelector(".wcontent").appendChild(d.root),d.input.addEventListener("change",function(t){var e=parseFloat(this.value);c.rgb_intensity=e,c.onImmediateChange&&c.onImmediateChange()}),a.setValue=function(e,i){c.fromRGB(e[0],e[1],e[2]),i||t.trigger(d.input,"change")},a.getValue=function(){return n}}else l.addEventListener("change",function(e){var i=a.querySelector(".rgb-color");i&&(i.innerHTML=t.Inspector.parseColor(c.rgb))});return this.processElement(a,o),a},e.prototype.addFile=function(t,i,n){n=this.processOptions(n),i=i||"";var o=this;this.values[t]=i;var r=this.createWidget(t,"<span class='inputfield full whidden' style='width: calc(100% - 26px)'><span class='filename'></span></span><button class='litebutton' style='width:20px; margin-left: 2px;'>...</button><input type='file' size='100' class='file' value='"+i+"'/>",n),s=r.querySelector(".wcontent");s.style.position="relative";var a=r.querySelector(".wcontent input"),l=r.querySelector(".wcontent .filename");return i&&(l.innerText=i.name),a.addEventListener("change",function(i){if(!i.target.files.length)return l.innerText="",void e.onWidgetChange.call(o,r,t,null,n);var s=i.target.files[0];if(s.files=i.target.files,n.generate_url&&(s.url=URL.createObjectURL(i.target.files[0])),l.innerText=s.name,n.read_file){var a=new FileReader;a.onload=function(i){s.data=i.target.result,e.onWidgetChange.call(o,r,t,s,n)},"binary"==n.read_file?a.readAsArrayBuffer(s):"data_url"==n.read_file?a.readAsDataURL(s):a.readAsText(s)}else e.onWidgetChange.call(o,r,t,s,n)}),this.append(r,n),r},e.prototype.addLine=function(i,n,o){o=this.processOptions(o),n=n||"";var r=this;this.values[i]=n;var s=this.createWidget(i,"<span class='line-editor'></span>",o);s.style.width="100%";var a=new t.LineEditor(n,o);return s.querySelector("span.line-editor").appendChild(a),t.bind(a,"change",function(n){t.trigger(s,"wbeforechange",[n.target.value]),o.callback&&o.callback.call(s,n.target.value),t.trigger(s,"wchange",[n.target.value]),e.onWidgetChange.call(r,s,i,n.target.value,o)}),this.append(s,o),s},e.prototype.addTree=function(e,i,n){n=this.processOptions(n),i=i||"";var o=this.createWidget(e,"<div class='wtree inputfield full'></div>",n),r=o.querySelector(".wtree");n.height&&(r.style.height="number"==typeof n.height?n.height+"px":n.height,r.style.overflow="auto");var s=o.tree=new t.Tree(i,n.tree_options);return s.onItemSelected=function(t,e){n.callback&&n.callback.call(o,t,e)},r.appendChild(s.root),o.setValue=function(t){s.updateTree(t)},this.append(o,n),this.processElement(o,n),o},e.prototype.addDataTree=function(t,e,i){i=this.processOptions(i),e=e||"";var n=this.createWidget(t,"<div class='wtree'></div>",i),o=n.querySelector(".wtree");return function t(e,i){for(var n in i){var o=document.createElement("div");o.className="treenode","object"==typeof i[n]?(o.innerHTML="<span class='itemname'>"+n+"</span><span class='itemcontent'></span>",t(o.querySelector(".itemcontent"),i[n])):o.innerHTML="<span class='itemname'>"+n+"</span><span class='itemvalue'>"+i[n]+"</span>",e.appendChild(o)}}(o,e),this.append(n,i),n},e.prototype.addArray=function(t,e,i){var n=this;if(e&&e.constructor===Array){var o=(i=this.processOptions(i)).data_type||"string",r=i.max_items||100,s=null;this.widgets_per_row=3,this.addInfo(t,null,{name_width:"100%",width:"100% - 160px"});var a=this.addString("length",e.length||"0",{width:100,callback:function(t){var t=parseInt(t);e<0&&(e=0),e.length=t,l.call(s)}});return this.addButtons(null,["+","-"],{width:60,callback:function(t){"+"==t?e.length=e.length+1:e.length>0&&(e.length=e.length-1),a.setValue(e.length),l.call(s)}}),this.widgets_per_row=1,(s=this.addContainer(t,i)).value=e,l.call(s),s.setValue=function(t){this.value=t,l.call(s)},s.getValue=function(){return this.value=v},s}function l(){var t=this.value,e=Math.min(t.length,r);n.widgets_per_row+=1,this.innerHTML="";for(var s=0;s<e;++s){var a=null;void 0!==t[s]&&(a=t[s]);var l=document.createElement("div");l.className="array-row",l.innerHTML="<span class='row-index'>"+s+"</span><span class='row-cell'></span><button style='width: 30px;' class='litebutton single row-trash'><img src='imgs/mini-icon-trash.png'/></button>",this.appendChild(l);var d=l.querySelector(".row-cell"),h={widget_parent:d,callback:c.bind({value:this.value,index:s})};if(i.data_options)for(var u in i.data_options)h[u]=i.data_options[u];n.add(o,null,a,h)}n.widgets_per_row-=1}function c(t){this.value[this.index]=t,i.callback&&i.callback.call(s,this.value,this.index)}console.error("Inspector: Array widget value must be a valid array")},e.prototype.addContainer=function(t,e){t&&t.constructor!==String&&console.warn("LiteGUI.Inspector.addContainer first parameter must be a string with the name");var i=this.startContainer(null,e);return this.endContainer(),i},e.prototype.startContainer=function(e,i){i=this.processOptions(i);var n=document.createElement("DIV");return n.className="wcontainer",this.applyOptions(n,i),this.row_number=0,this.append(n),this.pushContainer(n),i.widgets_per_row&&(this.widgets_per_row=i.widgets_per_row),i.height&&(n.style.height=t.sizeToCSS(i.height),n.style.overflow="auto"),n.refresh=function(){n.on_refresh&&n.on_refresh.call(this,n)},n},e.prototype.endContainer=function(t,e){this.popContainer()},e.prototype.addSection=function(t,e){e=this.processOptions(e);var i=this;this.current_section&&this.current_section.end();var n=document.createElement("DIV");n.className="wsection",t||(n.className+=" notitle"),e.className&&(n.className+=" "+e.className),e.collapsed&&(n.className+=" collapsed"),e.id&&(n.id=e.id),e.instance&&(n.instance=e.instance);var o="";return t&&(o+="<div class='wsectiontitle'>"+(e.no_collapse?"":"<span class='switch-section-button'></span>")+t+"</div>"),o+="<div class='wsectioncontent'></div>",n.innerHTML=o,n._last_container_stack=this._current_container_stack.concat(),this.root.appendChild(n),this.sections.push(n),n.sectiontitle=n.querySelector(".wsectiontitle"),t&&n.sectiontitle.addEventListener("click",function(t){if("button"!=t.target.localName){n.classList.toggle("collapsed");var i=n.querySelector(".wsectioncontent");i.style.display="none"===i.style.display?null:"none",e.callback&&e.callback.call(n,!n.classList.contains("collapsed"))}}),e.collapsed&&(n.querySelector(".wsectioncontent").style.display="none"),this.setCurrentSection(n),e.widgets_per_row&&(this.widgets_per_row=e.widgets_per_row),n.refresh=function(){n.on_refresh&&n.on_refresh.call(this,n)},n.end=function(){if(i.current_section==this){i._current_container_stack=this._last_container_stack,i._current_container=null;var t=this.querySelector(".wsectioncontent");t&&(i.isContainerInStack(t)&&i.popContainer(t),i.current_section=null)}},n},e.prototype.setCurrentSection=function(t){if(this.current_section!=t){this.current_section=t;var e=t.parentNode;this.popContainer(e);var i=t.querySelector(".wsectioncontent");this.pushContainer(i)}},e.prototype.getCurrentSection=function(){for(var t=this._current_container_stack.length-1;t>=0;--t){var e=this._current_container_stack[t];if(e.classList.contains("wsectioncontent"))return e.parentNode}return null},e.prototype.endCurrentSection=function(){this.current_section&&this.current_section.end()},e.prototype.beginGroup=function(e,i){i=this.processOptions(i);var n=document.createElement("DIV");n.className="wgroup",e=e||"",n.innerHTML="<div class='wgroupheader "+(i.title?"wtitle":"")+"'><span class='switch-section-button'></span>"+e+"</div>",n.group=!0;var o=document.createElement("DIV");o.className="wgroupcontent",i.collapsed&&(o.style.display="none"),i.height&&(o.style.height=t.sizeToCSS(i.height)),i.scrollable&&(o.style.overflow="auto"),n.appendChild(o);var r=i.collapsed||!1,s=n.querySelector(".wgroupheader");return r&&s.classList.add("collapsed"),s.addEventListener("click",function(t){var e=n.querySelector(".wgroupcontent").style;e.display="none"===e.display?"":"none",(r=!r)?s.classList.add("collapsed"):s.classList.remove("collapsed"),t.preventDefault()}),this.append(n,i),this.pushContainer(o),n},e.prototype.endGroup=function(){do{this.popContainer()}while(this._current_container&&!this._current_container.classList.contains("wgroupcontent"))},e.prototype.addTitle=function(t,e){e=this.processOptions(e);var i=document.createElement("DIV"),n="<span class='wtitle'><span class='text'>"+t+"</span>";return e.help&&(n+="<span class='help'><div class='help-content'>"+e.help+"</div></span>"),n+="</span>",i.innerHTML=n,i.setValue=function(t){this.querySelector(".text").innerHTML=t},this.row_number=0,this.append(i,e),i},e.prototype.scrollTo=function(t){var e=this.root.querySelector("#"+t);if(e){var i=this.root.offsetTop,n=e.offsetTop-i;this.root.parentNode.parentNode.scrollTop=n}},e.prototype.processOptions=function(t){return"function"==typeof t&&(t={callback:t}),t||{}},e.prototype.processElement=function(t,e){e.callback_update&&t.setValue&&(t.on_update=function(){this.setValue(e.callback_update.call(this),!0)})},e.prototype.updateWidgets=function(){for(var t=0;t<this.widgets.length;++t){var e=this.widgets[t];e.on_update&&e.on_update(e)}},e.parseColor=function(t){return"<span style='color: #FAA'>"+t[0].toFixed(2)+"</span>,<span style='color: #AFA'>"+t[1].toFixed(2)+"</span>,<span style='color: #AAF'>"+t[2].toFixed(2)+"</span>"},t.Inspector=e}),t("skylark-litegui/Menubar",["./litegui"],function(t){function e(t,e){e=e||{},this.menu=[],this.panels=[],this.root=document.createElement("div"),this.root.id=t,this.root.className="litemenubar",this.content=document.createElement("ul"),this.root.appendChild(this.content),this.is_open=!1,this.auto_open=e.auto_open||!1,this.sort_entries=e.sort_entries||!1}return e.closing_time=500,e.prototype.clear=function(){this.content.innerHTML="",this.menu=[],this.panels=[]},e.prototype.attachToPanel=function(t){t.content.insertBefore(this.root,t.content.firstChild)},e.prototype.add=function(t,e){"function"==typeof(e=e||{})&&(e={callback:e});for(var i=this.menu.length,n=t.split("/"),o=0,r=0,s=this.menu,a=null;s;){if(o>5)throw"Error: Menubar too deep";if(s.length!=r){if(s[r]&&n[o]==s[r].name){if(o<n.length-1){a=s[r],s=s[r].children,r=0,o++;continue}console.warn("Warning: Adding menu that already exists: "+t);break}r++}else{var l={parent:a,children:[]};if(a=l,o==n.length-1&&(l.data=e),l.disable=function(){this.data&&(this.data.disabled=!0)},l.enable=function(){this.data&&delete this.data.disabled},l.name=n[o],s.push(l),++o==n.length)break;l.children=[],s=l.children,r=0}}i!=this.menu.length&&this.updateMenu()},e.prototype.remove=function(t){var e=this.findMenu(t);if(e){if(!e.parent||!e.parent.children)return console.warn("menu without parent?");var i=e.parent.children.indexOf(e);-1!=i&&e.parent.children.splice(i,1)}},e.prototype.separator=function(t,e){var i=this.findMenu(t);i&&i.children.push({separator:!0,order:e||10})},e.prototype.findMenu=function(t){for(var e=t.split("/"),i=0,n=0,o=this.menu;o;){if(i==e.length)return o;if(o.length<=n)return null;if("*"==e[i])return o[n].children;if(e[i]!=o[n].name)n++;else{if(i==e.length-1)return o[n];o=o[n].children,n=0,i++}}return null},e.prototype.updateMenu=function(){var t=this;for(var e in this.content.innerHTML="",this.menu){var i=document.createElement("li");i.innerHTML="<span class='icon'></span><span class='name'>"+this.menu[e].name+"</span>",this.content.appendChild(i),i.data=this.menu[e],this.menu[e].element=i,i.addEventListener("click",function(e){var i=this.data;i.data&&i.data.callback&&"function"==typeof i.data.callback&&i.data.callback(i.data),t.is_open?(t.is_open=!1,t.hidePanels()):(t.is_open=!0,t.showMenu(i,e,this))}),i.addEventListener("mouseover",function(e){t.hidePanels(),(t.is_open||t.auto_open)&&t.showMenu(this.data,e,this)})}},e.prototype.hidePanels=function(){if(this.panels.length){for(var e in this.panels)t.remove(this.panels[e]);this.panels=[]}},e.prototype.showMenu=function(e,i,n,o){if(o||this.hidePanels(),e.children&&e.children.length){var r=this;r.closing_by_leave&&clearInterval(r.closing_by_leave);var s=document.createElement("div");s.className="litemenubar-panel";var a=[];for(var l in e.children)a.push(e.children[l]);for(var l in this.sort_entries&&a.sort(function(t,e){var i=10,n=10;return t&&t.data&&null!=t.data.order&&(i=t.data.order),t&&t.separator&&null!=t.order&&(i=t.order),e&&e.data&&null!=e.data.order&&(n=e.data.order),e&&e.separator&&null!=e.order&&(n=e.order),i-n}),a){var c=document.createElement("p"),d=a[l];c.className="litemenu-entry "+(c.children?" submenu":"");var h=d.children&&d.children.length;if(h&&c.classList.add("has_submenu"),d&&d.name?c.innerHTML="<span class='icon'></span><span class='name'>"+d.name+(h?"<span class='more'>+</span>":"")+"</span>":c.classList.add("separator"),c.data=d,c.data.data){var u=c.data.data,p="checkbox"==u.type&&u.instance&&u.property&&1==u.instance[u.property]||1==u.checkbox||u.instance&&u.property&&u.hasOwnProperty("value")&&u.instance[u.property]==u.value||"function"==typeof u.isChecked&&u.isChecked.call(u.instance,u);p&&(c.className+=" checked"),u.disabled&&(c.className+=" disabled")}c.addEventListener("click",function(){var t=this.data;if(t.data){if(t.data.disabled)return;t.data.instance&&t.data.property&&("checkbox"==t.data.type?(t.data.instance[t.data.property]=!t.data.instance[t.data.property],t.data.instance[t.data.property]?this.classList.add("checked"):this.classList.remove("checked")):t.data.hasOwnProperty("value")&&(t.data.instance[t.data.property]=t.data.value)),null!=t.data.checkbox&&(t.data.checkbox=!t.data.checkbox,t.data.checkbox?this.classList.add("checked"):this.classList.remove("checked")),t.data.callback&&"function"==typeof t.data.callback&&t.data.callback(t.data)}t.children&&t.children.length?r.showMenu(t,i,this,!0):(r.is_open=!1,r.hidePanels())}),c.addEventListener("mouseenter",function(t){}),s.appendChild(c)}s.addEventListener("mouseleave",function(e){r.closing_by_leave&&clearInterval(r.closing_by_leave),r.closing_by_leave=setTimeout(function(){r.is_open=!1,r.hidePanels()},t.Menubar.closing_time)}),s.addEventListener("mouseenter",function(t){r.closing_by_leave&&clearInterval(r.closing_by_leave),r.closing_by_leave=null});var f=n.getBoundingClientRect();s.style.left=f.left+(o?200:0)+"px",s.style.top=f.top+f.height+(o?-20:10)+"px",this.panels.push(s),document.body.appendChild(s)}},t.Menubar=e}),t("skylark-litegui/Panel",["./litegui"],function(t){function e(t,e){this._ctor(t,e)}return e.title_height="20px",e.prototype._ctor=function(e,i){!i&&e&&e.constructor!==String&&(i=e,e=null),i=i||{},this.content=i.content||"";var n=this.root=document.createElement("div");e&&(n.id=e),n.className="litepanel "+(i.className||""),n.data=this;var o="";i.title&&(o+="<div class='panel-header'>"+i.title+"</div>"),o+="<div class='content'>"+this.content+"</div>",o+="<div class='panel-footer'></div>",n.innerHTML=o,i.title&&(this.header=this.root.querySelector(".panel-header")),this.content=this.root.querySelector(".content"),this.footer=this.root.querySelector(".panel-footer"),i.width&&(this.root.style.width=t.sizeToCSS(i.width)),i.height&&(this.root.style.height=t.sizeToCSS(i.height)),i.position&&(this.root.style.position="absolute",this.root.style.left=t.sizeToCSS(i.position[0]),this.root.style.top=t.sizeToCSS(i.position[1])),1==i.scroll&&(this.content.style.overflow="auto")},e.prototype.add=function(t){this.content.appendChild(t.root)},e.prototype.clear=function(){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild)},t.Panel=e}),t("skylark-litegui/Split",["./litegui"],function(t){function e(e,i){if(e&&e.constructor===String||i){var n=e;(e=i||{}).id=n,console.warn("LiteGUI.Area legacy parameter, use options as first parameter instead of id.")}e=e||{};var o=document.createElement("div");o.className="litearea",e.id&&(o.id=e.id),e.className&&(o.className+=" "+e.className),this.root=o,this.root.litearea=this;var r=e.width||"100%",s=e.height||"100%";r<0&&(r="calc( 100% - "+Math.abs(r)+"px)"),s<0&&(s="calc( 100% - "+Math.abs(s)+"px)"),o.style.width=r,o.style.height=s,this.options=e;var a=this;this._computed_size=[this.root.offsetWidth,this.root.offserHeight];var l=document.createElement("div");e.content_id&&(l.id=e.content_id),l.className="liteareacontent",l.style.width="100%",l.style.height="100%",this.root.appendChild(l),this.content=l,this.split_direction="none",this.sections=[],e.autoresize&&t.bind(t,"resized",function(){a.onResize()})}return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e.splitbar_size=4,e.prototype.getSection=function(t){return t=t||0,this.sections.length>t?this.sections[t]:null},e.prototype.onResize=function(t){var e=[this.root.offsetWidth,this.root.offsetHeight];t&&this._computed_size&&e[0]==this._computed_size[0]&&e[1]==this._computed_size[1]||this.sendResizeEvent(t)},e.prototype.sendResizeEvent=function(e){if(this.sections.length)for(var i in this.sections){var n=this.sections[i];n.onResize(e)}else for(var o=0;o<this.root.childNodes.length;o++){var r=this.root.childNodes[o];r.litearea?r.litearea.onResize():t.trigger(r,"resize")}this.onresize&&this.onresize()},e.prototype.getWidth=function(){return this.root.offsetWidth},e.prototype.getHeight=function(){return this.root.offsetHeight},e.prototype.isVisible=function(){return"none"!=this.root.style.display},e.prototype.adjustHeight=function(){if(this.root.parentNode){this.root.parentNode.offsetHeight;var t=this.root.getClientRects()[0].top;this.root.style.height="calc( 100% - "+t+"px )"}else console.error("Cannot adjust height of LiteGUI.Area without parent")},e.prototype.split=function(i,n,o){if(!i||i.constructor!==String)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(n||(n=["50%",null]),"vertical"!=i&&"horizontal"!=i)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(this.sections.length)throw"cannot split twice";var r=new t.Area({content_id:this.content.id});r.root.style.display="inline-block";var s=new t.Area;s.root.style.display="inline-block";var a="",l=null,c=null;if(o&&(a=" - "+(e.splitbar_size+2)+"px",(l=document.createElement("div")).className="litesplitbar "+i,"vertical"==i?l.style.height=e.splitbar_size+"px":l.style.width=e.splitbar_size+"px",this.splitbar=l,l.addEventListener("mousedown",function(t){var e=g.root.ownerDocument;e.addEventListener("mousemove",y),e.addEventListener("mouseup",b),m[0]=t.pageX,m[1]=t.pageY,t.stopPropagation(),t.preventDefault()})),n=n||["50%",null],"vertical"==i)if(r.root.style.width="100%",s.root.style.width="100%",null==n[0]){var d=n[1];"number"==typeof d&&(d=n[1]+"px"),r.root.style.height="-moz-calc( 100% - "+d+a+" )",r.root.style.height="-webkit-calc( 100% - "+d+a+" )",r.root.style.height="calc( 100% - "+d+a+" )",s.root.style.height=d,s.size=d,c=r}else if(null==n[1]){var d=n[0];"number"==typeof d&&(d=n[0]+"px"),r.root.style.height=d,r.size=d,s.root.style.height="-moz-calc( 100% - "+d+a+" )",s.root.style.height="-webkit-calc( 100% - "+d+a+" )",s.root.style.height="calc( 100% - "+d+a+" )",c=s}else{var h=n[0];"number"==typeof h&&(h=n[0]+"px");var u=n[1];"number"==typeof u&&(u=n[1]+"px"),r.root.style.height=h,r.size=h,s.root.style.height=u,s.size=u}else if(r.root.style.height="100%",s.root.style.height="100%",null==n[0]){var p=n[1];"number"==typeof p&&(p=n[1]+"px"),r.root.style.width="-moz-calc( 100% - "+p+a+" )",r.root.style.width="-webkit-calc( 100% - "+p+a+" )",r.root.style.width="calc( 100% - "+p+a+" )",s.root.style.width=p,s.size=n[1],c=r}else if(null==n[1]){var p=n[0];"number"==typeof p&&(p=n[0]+"px"),r.root.style.width=p,r.size=p,s.root.style.width="-moz-calc( 100% - "+p+a+" )",s.root.style.width="-webkit-calc( 100% - "+p+a+" )",s.root.style.width="calc( 100% - "+p+a+" )",c=s}else{var f=n[0];"number"==typeof f&&(f=n[0]+"px");var v=n[1];"number"==typeof v&&(v=n[1]+"px"),r.root.style.width=f,r.size=f,s.root.style.width=v,s.size=v}r.root.removeChild(r.content),r.root.appendChild(this.content),r.content=this.content,this.root.appendChild(r.root),l&&this.root.appendChild(l),this.root.appendChild(s.root),this.sections=[r,s],this.dynamic_section=c,this.direction=i;var g=this,m=[0,0];function y(t){"horizontal"==i?m[0]!=t.pageX&&g.moveSplit(m[0]-t.pageX):"vertical"==i&&m[1]!=t.pageY&&g.moveSplit(t.pageY-m[1]),m[0]=t.pageX,m[1]=t.pageY,t.stopPropagation(),t.preventDefault(),(g.options.immediateResize||g.options.inmediateResize)&&g.onResize()}function b(t){var e=g.root.ownerDocument;e.removeEventListener("mousemove",y),e.removeEventListener("mouseup",b),g.onResize()}},e.prototype.hide=function(){this.root.style.display="none"},e.prototype.show=function(){this.root.style.display="block"},e.prototype.showSection=function(t){var e=this.sections[t],i=0;if(!e||"none"==e.root.style.display){for(var n in-1!=(i="horizontal"==this.direction?e.root.style.width:e.root.style.height).indexOf("calc")&&(i="50%"),this.sections){var e=this.sections[n];n==t?e.root.style.display="inline-block":"horizontal"==this.direction?e.root.style.width="calc( 100% - "+i+" - 5px)":e.root.style.height="calc( 100% - "+i+" - 5px)"}this.splitbar&&(this.splitbar.style.display="inline-block"),this.sendResizeEvent()}},e.prototype.hideSection=function(t){for(var e in this.sections){var i=this.sections[e];e==t?i.root.style.display="none":"horizontal"==this.direction?i.root.style.width="100%":i.root.style.height="100%"}this.splitbar&&(this.splitbar.style.display="none"),this.sendResizeEvent()},e.prototype.moveSplit=function(i){if(this.sections){var n=this.sections[0],o=this.sections[1],r=" - "+e.splitbar_size+"px",s=this.options.minSplitSize||10;if("horizontal"==this.direction)if(this.dynamic_section==n){var a=o.root.offsetWidth+i;a<s&&(a=s),n.root.style.width="-moz-calc( 100% - "+a+"px "+r+" )",n.root.style.width="-webkit-calc( 100% - "+a+"px "+r+" )",n.root.style.width="calc( 100% - "+a+"px "+r+" )",o.root.style.width=a+"px"}else{var a=n.root.offsetWidth-i;a<s&&(a=s),o.root.style.width="-moz-calc( 100% - "+a+"px "+r+" )",o.root.style.width="-webkit-calc( 100% - "+a+"px "+r+" )",o.root.style.width="calc( 100% - "+a+"px "+r+" )",n.root.style.width=a+"px"}else if("vertical"==this.direction)if(this.dynamic_section==n){var a=o.root.offsetHeight-i;a<s&&(a=s),n.root.style.height="-moz-calc( 100% - "+a+"px "+r+" )",n.root.style.height="-webkit-calc( 100% - "+a+"px "+r+" )",n.root.style.height="calc( 100% - "+a+"px "+r+" )",o.root.style.height=a+"px"}else{var a=n.root.offsetHeight+i;a<s&&(a=s),o.root.style.height="-moz-calc( 100% - "+a+"px "+r+" )",o.root.style.height="-webkit-calc( 100% - "+a+"px "+r+" )",o.root.style.height="calc( 100% - "+a+"px "+r+" )",n.root.style.height=a+"px"}t.trigger(this.root,"split_moved");for(var l=this.root.querySelectorAll(".litearea"),c=0;c<l.length;++c)t.trigger(l[c],"split_moved")}},e.prototype.addEventListener=function(t,e,i,n){return this.root.addEventListener(t,e,i,n)},e.prototype.setAreaSize=function(t,i){var n=this.sections[1],o=" - "+e.splitbar_size+"px";n.root.style.width="-moz-calc( 100% - "+i+o+" )",n.root.style.width="-webkit-calc( 100% - "+i+o+" )",n.root.style.width="calc( 100% - "+i+o+" )"},e.prototype.merge=function(t){if(0==this.sections.length)throw"not splitted";var e=this.sections[t||0];this.root.appendChild(e.content),this.content=e.content,this.root.removeChild(this.sections[0].root),this.root.removeChild(this.sections[1].root),this.sections=[],this._computed_size=null,this.onResize()},e.prototype.add=function(t){if("string"==typeof t){var e=document.createElement("div");e.innerHTML=t,t=e}this.content.appendChild(t.root||t)},e.prototype.query=function(t){return this.root.querySelector(t)},t.Area=e}),t("skylark-litegui/Table",["./litegui"],function(t){function e(e){e=e||{},this.root=document.createElement("table"),this.root.classList.add("litetable"),this.columns=[],this.column_fields=[],this.rows=[],this.data=[],this._must_update_header=!0,e.colums&&this.setColumns(e.colums),e.scrollable&&(this.root.style.overflow="auto"),e.height&&(this.root.style.height=t.sizeToCSS(e.height)),e.columns&&this.setColumns(e.columns),e.rows&&this.setRows(e.data)}return e.prototype.setRows=function(t,e){this.data=t,this.updateContent(e)},e.prototype.addRow=function(t,e){for(var i=document.createElement("tr"),n=0;n<this.column_fields.length;++n){var o=document.createElement("td"),r=null;void 0===(r=t.constructor===Array?t[n]:t[this.column_fields[n]])&&(r=""),o.innerHTML=r;var s=this.columns[n];if(void 0===s)break;s.className&&(o.className=s.className),s.width&&(o.style.width=s.width),i.appendChild(o)}return this.root.appendChild(i),this.rows.push(i),e||this.data.push(t),i},e.prototype.updateRow=function(t,e){this.data[t]=e;var i=this.rows[t];if(i){for(var n=i.querySelectorAll("td"),o=0;o<n.length;++o){var r=this.columns[o],s=null;void 0===(s=e.constructor===Array?e[o]:e[r.field])&&(s=""),n[o].innerHTML=s}return i}},e.prototype.updateCell=function(t,e,i){var n=this.rows[t];if(n){var e=n.childNodes[e];if(e)return e.innerHTML=i,e}},e.prototype.setColumns=function(e){this.columns.length=0,this.column_fields.length=0;for(var i=Math.floor(100/e.length).toFixed(1)+"%",n=[],o=0;o<e.length;++o){var r=e[o];if(null!==r&&void 0!==r){r.constructor!==String&&r.constructor!==Number||(r={name:String(r)});var s={name:r.name||"",width:t.sizeToCSS(r.width||i),field:(r.field||r.name||"").toLowerCase(),className:r.className};o==e.length-1?s.width=" calc( 100% - ( "+n.join(" + ")+" ) )":n.push(s.width),this.columns.push(s),this.column_fields.push(s.field)}}this._must_update_header=!0,this.updateContent()},e.prototype.updateContent=function(t){if(this.root.innerHTML="",this._must_update_header){this.header=document.createElement("tr");for(var e=0;e<this.columns.length;++e){var i=this.columns[e],n=document.createElement("th");n.innerHTML=i.name,i.width&&(n.style.width=i.width),i.th=n,this.header.appendChild(n)}this._must_update_header=!1}if(this.root.appendChild(this.header),this.data)if(this.data.length!=this.rows.length&&(t=!1),t)for(var e=0;e<this.rows.length;++e){var o=this.data[e],r=this.updateRow(e,o);this.root.appendChild(r)}else{this.rows.length=0;for(var e=0;e<this.data.length;++e){var s=this.data[e];this.addRow(s,!0)}}},t.Table=e}),t("skylark-litegui/Tabs",["./litegui"],function(t){function e(e,i){if(i||e&&e.constructor===String){var n=e;(e=i||{}).id=n,console.warn("LiteGUI.Tabs legacy parameter, use options as first parameter instead of id.")}e=e||{},this.options=e;var o=this.mode=e.mode||"horizontal",r=document.createElement("DIV");e.id&&(r.id=e.id),r.data=this,r.className="litetabs "+o,this.root=r,this.root.tabs=this,this.current_tab=null,"horizontal"==o?e.size&&("full"==e.size?this.root.style.height="100%":this.root.style.height=e.size):"vertical"==o&&e.size&&("full"==e.size?this.root.style.width="100%":this.root.style.width=e.size),e.width&&(this.root.style.width=e.width.constructor===Number?e.width.toFixed(0)+"px":e.width),e.height&&(this.root.style.height=e.height.constructor===Number?e.height.toFixed(0)+"px":e.height);var s=document.createElement("UL");function a(t){t.deltaY&&(s.scrollLeft+=t.deltaY)}s.className="wtabcontainer","vertical"==o?s.style.width=t.Tabs.tabs_width+"px":s.style.height=t.Tabs.tabs_height+"px",s.addEventListener("wheel",a),s.addEventListener("mousewheel",a),this.list=s,this.root.appendChild(this.list),this.tabs_root=s,this.tabs={},this.tabs_by_index=[],this.selected=null,this.onchange=e.callback,e.parent&&this.appendTo(e.parent)}return e.tabs_width=64,e.tabs_height=26,e.prototype.show=function(){this.root.style.display="block"},e.prototype.hide=function(){this.root.style.display="none"},e.prototype.getCurrentTab=function(){return this.current_tab?this.tabs[this.current_tab[0]]:null},e.prototype.getCurrentTabId=function(){return this.current_tab[0]},e.prototype.getPreviousTab=function(){return this.previous_tab?this.tabs[this.previous_tab[0]]:null},e.prototype.appendTo=function(t,e){e?t.prepend(this.root):t.appendChild(this.root)},e.prototype.getTab=function(t){return this.tabs[t]},e.prototype.getTabByIndex=function(t){return this.tabs_by_index[t]},e.prototype.getNumOfTabs=function(){var t=0;for(var e in this.tabs)t++;return t},e.prototype.getTabContent=function(t){var e=this.tabs[t];if(e)return e.content},e.prototype.getTabIndex=function(t){var e=this.tabs[t];if(!e)return-1;for(var i=0;i<this.list.childNodes.length;i++)if(this.list.childNodes[i]==e.tab)return i;return-1},e.prototype.addTab=function(i,n,o){"function"==typeof(n=n||{})&&(n={callback:n});var r=this;void 0!==i&&null!==i||(i="rand_"+(1e6*Math.random()|0));var s=document.createElement("LI"),a=i.replace(/ /gi,"_");if(s.className="wtab wtab-"+a+" ",s.dataset.id=i,s.innerHTML="<span class='tabtitle'>"+(n.title||i)+"</span>",n.button&&(s.className+="button "),n.tab_className&&(s.className+=n.tab_className),n.bigicon&&(s.innerHTML="<img class='tabbigicon' src='"+n.bigicon+"'/>"+s.innerHTML),n.closable&&(s.innerHTML+="<span class='tabclose'>"+t.special_codes.close+"</span>",s.querySelector("span.tabclose").addEventListener("click",function(t){r.removeTab(i),t.preventDefault(),t.stopPropagation()},!0)),void 0!==n.index){var l=this.list.childNodes[n.index];l?this.list.insertBefore(s,l):this.list.appendChild(s)}else this.plus_tab?this.list.insertBefore(s,this.plus_tab):this.list.appendChild(s);n.tab_width&&(s.style.width=n.tab_width.constructor===Number?n.tab_width.toFixed(0)+"px":n.tab_width,s.style.minWidth="0"),this.options.autoswitch&&(s.classList.add("autoswitch"),s.addEventListener("dragenter",function(e){r._timeout_mouseover&&clearTimeout(r._timeout_mouseover),r._timeout_mouseover=setTimeout(function(){t.trigger(this,"click"),r._timeout_mouseover=null}.bind(this),500)}),s.addEventListener("dragleave",function(t){r._timeout_mouseover&&(clearTimeout(r._timeout_mouseover),r._timeout_mouseover=null)}));var c=document.createElement("div");n.id&&(c.id=n.id),c.className="wtabcontent wtabcontent-"+a+" "+(n.className||""),c.dataset.id=i,c.style.display="none","horizontal"==this.mode?n.size&&(c.style.overflow="auto","full"==n.size?(c.style.width="100%",c.style.height="calc( 100% - "+t.Tabs.tabs_height+"px )",c.style.height="-moz-calc( 100% - "+t.Tabs.tabs_height+"px )",c.style.height="-webkit-calc( 100% - "+t.Tabs.tabs_height+"px )"):c.style.height=n.size):"vertical"==this.mode&&n.size&&(c.style.overflow="auto","full"==n.size?(c.style.height="100%",c.style.width="calc( 100% - "+t.Tabs.tabs_width+"px )",c.style.width="-moz-calc( 100% - "+t.Tabs.tabs_width+"px )",c.style.width="-webkit-calc( 100% - "+t.Tabs.tabs_width+"px )"):c.style.width=n.size),void 0!==n.width&&(c.style.width="string"==typeof n.width?n.width:n.width+"px"),void 0!==n.height&&(c.style.height="string"==typeof n.height?n.height:n.height+"px"),n.content&&("string"==typeof n.content?c.innerHTML=n.content:c.appendChild(n.content)),this.root.appendChild(c),n.button?s.addEventListener("click",function(t){var e=this.dataset.id;n.callback&&n.callback(e,t)}):s.addEventListener("click",e.prototype.onTabClicked),s.options=n,s.tabs=this;var d=s.querySelector("span.tabtitle"),h={id:i,tab:s,content:c,title:d,add:function(t){this.content.appendChild(t.root||t)},setTitle:function(t){this.title.innerHTML=t},click:function(){t.trigger(this.tab,"click")},destroy:function(){r.removeTab(this.id)}};return n.onclose&&(h.onclose=n.onclose),this.tabs[i]=h,this.recomputeTabsByIndex(),s.addEventListener("contextmenu",function(t){return 2==t.button&&(t.preventDefault(),n.callback_context&&n.callback_context.call(h),!1)}.bind(this)),1!=n.selected&&null!=this.selected||this.selectTab(i,n.skip_callbacks),h},e.prototype.addPlusTab=function(t){this.plus_tab&&console.warn("There is already a plus tab created in this tab widget"),this.plus_tab=this.addTab("plus_tab",{title:"+",tab_width:20,button:!0,callback:t,skip_callbacks:!0})},e.prototype.addButtonTab=function(t,e,i){return this.addTab(t,{title:e,tab_width:20,button:!0,callback:i,skip_callbacks:!0})},e.prototype.onTabClicked=function(e){if(!this.classList.contains("selected")&&this.parentNode){var i=this.options,n=this.parentNode.parentNode.tabs;if(!n)throw"tabs not found";var o=n;if(!i.callback_canopen||0!=i.callback_canopen()){o.current_tab&&o.current_tab[0]!=r&&o.current_tab[2]&&o.current_tab[2].callback_leave&&o.current_tab[2].callback_leave(o.current_tab[0],o.current_tab[1],o.current_tab[2]);var r=this.dataset.id,s=null;for(var a in o.tabs){var l=o.tabs[a];a==r?(l.selected=!0,l.content.style.display="",s=l.content):(delete l.selected,l.content.style.display="none")}for(var c=o.list.querySelectorAll("li.wtab"),a=0;a<c.length;++a)c[a].classList.remove("selected");this.classList.add("selected"),o.previous_tab=o.current_tab,o.current_tab=[r,s,i],e&&(i.callback&&i.callback(r,s,e),t.trigger(o,"wchange",[r,s]),o.onchange&&o.onchange(r,s)),o.selected=r}}},e.prototype.selectTab=function(t,e){if(t){t.constructor!=String&&(t=t.id);for(var i=this.list.querySelectorAll("li.wtab"),n=0;n<i.length;n++)if(t==i[n].dataset.id){this.onTabClicked.call(i[n],!e);break}}},e.prototype.setTabVisibility=function(t,e){var i=this.tabs[t];i&&(i.tab.style.display=e?"none":null,i.content.style.display=e?"none":null)},e.prototype.recomputeTabsByIndex=function(){for(var t in this.tabs_by_index=[],this.tabs){for(var e=this.tabs[t],i=0,n=e.tab;null!=(n=n.previousSibling);)i++;this.tabs_by_index[i]=e}},e.prototype.removeTab=function(t){var e=this.tabs[t];e?(e.onclose&&e.onclose(e),e.tab.parentNode&&e.tab.parentNode.removeChild(e.tab),e.content.parentNode&&e.content.parentNode.removeChild(e.content),delete this.tabs[t],this.recomputeTabsByIndex()):console.warn("tab not found: "+t)},e.prototype.removeAllTabs=function(t){var e=[];for(var i in this.tabs)e.push(this.tabs[i]);for(var i in e){var n=e[i];n==this.plus_tab&&t||(n.tab.parentNode&&n.tab.parentNode.removeChild(n.tab),n.content.parentNode&&n.content.parentNode.removeChild(n.content),delete this.tabs[n.id])}this.recomputeTabsByIndex()},e.prototype.clear=function(){this.removeAllTabs()},e.prototype.hideTab=function(t){this.setTabVisibility(t,!1)},e.prototype.showTab=function(t){this.setTabVisibility(t,!0)},e.prototype.transferTab=function(t,e,i){var n=this.tabs[t];if(n){e.tabs[t]=n,void 0!==i?e.list.insertBefore(n.tab,e.list.childNodes[i]):e.list.appendChild(n.tab),e.root.appendChild(n.content),delete this.tabs[t];var o=null;for(var r in this.tabs){o=r;break}o&&this.selectTab(o),n.tab.classList.remove("selected"),e.selectTab(t)}},e.prototype.detachTab=function(e,i,n){var o=this.tabs[e];if(o){var r=this.getTabIndex(e),s=window.open("","","width=800, height=600, location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");s.document.write("<head><title>"+e+"</title>");for(var a=document.querySelectorAll("link[rel='stylesheet'],style"),l=0;l<a.length;l++)s.document.write(a[l].outerHTML);s.document.write("</head><body></body>"),s.document.close();var c=this,d=new t.Tabs(null,this.options);return s.tabs=d,s.onbeforeunload=function(){d.transferTab(e,c,r),n&&n()},d.list.style.height="20px",s.document.body.appendChild(d.root),c.transferTab(e,d),d.tabs[e].tab.classList.add("selected"),this.recomputeTabsByIndex(),i&&i(),s}},t.Tabs=e}),t("skylark-litegui/Tree",["./litegui"],function(t){function e(t,e,i){if(i||t&&t.constructor===String){var n=t;t=e,(e=i||{}).id=n,console.warn("LiteGUI.Tree legacy parameter, use data as first parameter instead of id.")}e=e||{};var o=document.createElement("div");this.root=o,e.id&&(o.id=e.id),o.className="litetree",this.tree=t;var r=this;e=e||{allow_rename:!1,allow_drag:!0,allow_multiselection:!1},this.options=e,this.indent_offset=e.indent_offset||0,e.height&&(this.root.style.height="string"==typeof e.height?e.height:Math.round(e.height)+"px"),this.collapsed_depth=3,null!=e.collapsed_depth&&(this.collapsed_depth=e.collapsed_depth),o.addEventListener("click",function(t){t.srcElement==r.root&&r.onBackgroundClicked&&r.onBackgroundClicked(t,r)}),o.addEventListener("contextmenu",function(t){return 2==t.button&&(r.onContextMenu&&r.onContextMenu(t),t.preventDefault(),!1)});var s=this.createAndInsert(t,e,null);if(!s)throw"Error in LiteGUI.Tree, createAndInsert returned null";s.className+=" root_item",this.root_item=s}return e.INDENT=20,e.prototype.updateTree=function(t){this.root.innerHTML="";var e=this.createAndInsert(t,this.options,null);e?(e.className+=" root_item",this.root_item=e):this.root_item=null},e.prototype.insertItem=function(t,e,i,n){if(!e){var o=this.root.childNodes[0];o&&(e=o.dataset.item_id)}var r=this.createAndInsert(t,n,e,i);return e&&this._updateListBox(this._findElement(e)),r},e.prototype.createAndInsert=function(t,e,i,n){var o=-1;i?o=this._findElementIndex(i):void 0===i&&(o=0);var r=null,s=0;-1!=o&&(r=this.root.childNodes[o],s=parseInt(r.dataset.level)+1);var a=this.createTreeItem(t,e,s);if(a){a.parent_id=i;var l=this.getItem(a.dataset.item_id);if(l&&console.warn("There another item with the same ID in this tree"),-1==o?this.root.appendChild(a):this._insertInside(a,o,n),r&&!this._isNodeChildrenVisible(i)&&a.classList.add("hidden"),t.children)for(var c=0;c<t.children.length;++c)this.createAndInsert(t.children[c],e,t.id);return this._updateListBox(a,e,s),e&&e.selected&&this.markAsSelected(a,!0),a}},e.prototype._insertInside=function(t,i,n,o){var r=this.root.childNodes[i];if(!r)throw"No parent node found, index: "+i+", nodes: "+this.root.childNodes.length;var s=parseInt(r.dataset.level),a=void 0!==o?o:s+1,l=t.querySelector(".indentblock");l&&(l.style.paddingLeft=(a+this.indent_offset)*e.INDENT+"px"),t.dataset.level=a;for(var c=i+1;c<this.root.childNodes.length;++c){var d=this.root.childNodes[c];if(d.classList&&d.classList.contains("ltreeitem")){var h=parseInt(d.dataset.level);if(h==a&&n)n--;else if(h<a||0===n&&h===a)return void this.root.insertBefore(t,d)}}this.root.appendChild(t)},e.prototype._isNodeChildrenVisible=function(t){var e=this.getItem(t);if(!e)return!1;if(e.classList.contains("hidden"))return!1;var i=e.querySelector(".listbox");return!i||"closed"!=i.getValue()},e.prototype._findElement=function(t){if(!t||t.constructor!==String)throw"findElement param must be string with item id";for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem")&&i.classList.contains("ltreeitem-"+t))return i}return null},e.prototype._findElementIndex=function(t){for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem"))if("string"==typeof t){if(i.dataset.item_id===t)return e}else if(i===t)return e}return-1},e.prototype._findElementLastChildIndex=function(t){if(-1==t)return-1;for(var e=parseInt(this.root.childNodes[t].dataset.level),i=t+1;i<this.root.childNodes.length;++i){var n=this.root.childNodes[i];if(n.classList&&n.classList.contains("ltreeitem")){var o=parseInt(n.dataset.level);if(o==e)return i}}return-1},e.prototype._findChildElements=function(t,e){var i=this._findElementIndex(t);if(-1!=i){for(var n=this.root.childNodes[i],o=parseInt(n.dataset.level),r=[],s=i+1;s<this.root.childNodes.length;++s){var a=this.root.childNodes[s];if(a.classList&&a.classList.contains("ltreeitem")){var l=parseInt(a.dataset.level);if(!(e&&l>o+1)){if(l<=o)return r;r.push(a)}}}return r}},e.prototype.createTreeItem=function(e,i,n){if(null!==e&&void 0!==e){i=i||this.options;var o=document.createElement("li");o.className="ltreeitem";var r=this;if(e.id){var s=e.id.replace(/\s/g,"_");o.className+=" ltreeitem-"+s,o.dataset.item_id=e.id}if(e.dataset)for(var a in e.dataset)o.dataset[a]=e.dataset[a];e.DOM=o,o.data=e,void 0!==n&&(o.dataset.level=n,o.classList.add("ltree-level-"+n));var l=document.createElement("div");l.className="ltreeitemtitle",e.className&&(l.className+=" "+e.className),l.innerHTML="<span class='precontent'></span><span class='indentblock'></span><span class='collapsebox'></span><span class='incontent'></span><span class='postcontent'></span>";var c=e.content||e.id||"";if(l.querySelector(".incontent").innerHTML=c,e.precontent&&(l.querySelector(".precontent").innerHTML=e.precontent),e.postcontent&&(l.querySelector(".postcontent").innerHTML=e.postcontent),e.dataset)for(var a in e.dataset)o.dataset[a]=e.dataset[a];o.appendChild(l),o.title_element=l,!1===e.visible&&(o.style.display="none");var d=o;d.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();if(this.title_element._editing)return;if(i.ctrlKey&&r.options.allow_multiselection){if(r.isNodeSelected(this))return this.classList.remove("selected"),t.trigger(r,"item_remove_from_selection",{item:this,data:this.data}),void t.trigger(r.root,"item_remove_from_selection",{item:this,data:this.data});r.markAsSelected(this,!0),t.trigger(r,"item_add_to_selection",{item:this,data:this.data}),t.trigger(r.root,"item_add_to_selection",{item:this,data:this.data});var n=!1;e.callback&&(n=e.callback.call(r,this)),!n&&r.onItemAddToSelection&&r.onItemAddToSelection(this.data,this)}if(i.shiftKey&&r.options.allow_multiselection){var o=r.getSelectedItem();if(!o)return;if(o===this)return;for(var s=Array.prototype.slice.call(o.parentNode.children),a=s.indexOf(o),l=s.indexOf(this),c=l>a?s.slice(a,l):s.slice(l,a),d=0;d<c.length;++d){var h=c[d];r.markAsSelected(h,!0),t.trigger(r,"item_add_to_selection",{item:h,data:h.data}),t.trigger(r.root,"item_add_to_selection",{item:h,data:h.data})}}else{r.markAsSelected(this),r._skip_scroll=!0,t.trigger(r,"item_selected",{item:this,data:this.data}),t.trigger(r.root,"item_selected",{item:this,data:this.data});var n=!1;e.callback&&(n=e.callback.call(r,this)),!n&&r.onItemSelected&&r.onItemSelected(this.data,this),r._skip_scroll=!1}}),d.addEventListener("dblclick",function(e){var i=this,n=i.title_element.querySelector(".incontent");if(t.trigger(r,"item_dblclicked",i),t.trigger(r.root,"item_dblclicked",i),!n._editing&&r.options.allow_rename){n._editing=!0,n._old_name=n.innerHTML;var o=n;n.innerHTML="<input type='text' value='"+n.innerHTML+"' />";var s=n.querySelector("input");s.addEventListener("blur",function(e){var n=e.target.value;setTimeout(function(){o.innerHTML=n},1),delete o._editing,t.trigger(r.root,"item_renamed",{old_name:o._old_name,new_name:n,item:i,data:i.data}),delete o._old_name}),s.addEventListener("keydown",function(t){13==t.keyCode&&this.blur()}),s.focus(),e.preventDefault()}e.preventDefault(),e.stopPropagation()}),d.addEventListener("contextmenu",function(t){if(t.preventDefault(),t.stopPropagation(),2==t.button)return!!r.onItemContextMenu&&r.onItemContextMenu(t,{item:this,data:this.data})});var h=l;this.options.allow_drag&&(h.draggable=!0,h.addEventListener("dragstart",function(t){if(t.dataTransfer.setData("item_id",this.parentNode.dataset.item_id),e.onDragData){var i=e.onDragData();if(i)for(var n in i)t.dataTransfer.setData(n,i[n])}}));var u=0;return h.addEventListener("dragenter",function(t){if(t.preventDefault(),e.skipdrag)return!1;0==u&&l.classList.add("dragover"),u++}),h.addEventListener("dragleave",function(t){t.preventDefault(),0==--u&&l.classList.remove("dragover")}),h.addEventListener("dragover",function(t){t.preventDefault()}),h.addEventListener("drop",function(i){if(l.classList.remove("dragover"),i.preventDefault(),e.skipdrag)return!1;var n=i.dataTransfer.getData("item_id");if(!n)return t.trigger(r.root,"drop_on_item",{item:this,event:i}),void(r.onDropItem&&r.onDropItem(i,this.parentNode.data));var o=this.parentNode.dataset.item_id;(!r.onMoveItem||r.onMoveItem&&0!=r.onMoveItem(r.getItem(n),r.getItem(o)))&&r.moveItem(n,o)&&t.trigger(r.root,"item_moved",{item:r.getItem(n),parent_item:r.getItem(o)}),r.onDropItem&&r.onDropItem(i,this.parentNode.data)}),o}console.error("Tree item cannot be null")},e.prototype.filterByName=function(t){for(var i=0;i<this.root.childNodes.length;++i){var n=this.root.childNodes[i];if(n.classList&&n.classList.contains("ltreeitem")){var o=n.querySelector(".incontent");if(o){var r=o.innerHTML.toLowerCase();if(t&&-1==r.indexOf(t.toLowerCase()))n.classList.add("filtered");else{n.data&&!1!==n.data.visible&&n.classList.remove("filtered");var s=n.querySelector(".indentblock");s&&(s.style.paddingLeft=t?0:paddingLeft=(parseInt(n.dataset.level)+this.indent_offset)*e.INDENT+"px")}}}}},e.prototype.filterByRule=function(e,i){if(!e)throw"filterByRule requires a callback";for(var n=0;n<this.root.childNodes.length;++n){var o=this.root.childNodes[n];if(o.classList&&o.classList.contains("ltreeitem")){var r=o.querySelector(".incontent");if(r)if(e(o.data,r,i)){o.data&&!1!==o.data.visible&&o.classList.remove("filtered");var s=o.querySelector(".indentblock");s&&(name?s.style.paddingLeft=0:s.style.paddingLeft=paddingLeft=(parseInt(o.dataset.level)+this.indent_offset)*t.Tree.INDENT+"px")}else o.classList.add("filtered")}}},e.prototype.getItem=function(t){if(!t)return null;if(t.classList)return t;for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem")&&i.dataset.item_id===t)return i}return null},e.prototype.expandItem=function(t,e){var i=this.getItem(t);if(i&&i.listbox&&(i.listbox.setValue(!0),e)){var n=this.getParent(i);n&&this.expandItem(n,e)}},e.prototype.collapseItem=function(t){var e=this.getItem(t);e&&e.listbox&&listbox.setValue(!1)},e.prototype.isInsideArea=function(t){var e=t.constructor===String?this.getItem(t):t;if(!e)return!1;var i=this.root.getClientRects();if(!i.length)return!1;var n=i[0],o=n.height,r=e.offsetTop;return this.root.scrollTop<r&&r<this.root.scrollTop+o},e.prototype.scrollToItem=function(t){var i=t.constructor===String?this.getItem(t):t;if(i){var n=this.root.parentNode;if(n){var o=n.getBoundingClientRect();if(o){var r=o.height,s=(parseInt(i.dataset.level)+this.indent_offset)*e.INDENT+50;n.scrollTop=i.offsetTop-.5*r|0,.75*o.width<s?n.scrollLeft=s:n.scrollLeft=0}}}},e.prototype.setSelectedItem=function(e,i,n){if(e){var o=this.getItem(e);if(!o)return null;if(!o.classList.contains("selected"))return this.markAsSelected(o),i&&!this._skip_scroll&&this.scrollToItem(o),this.expandItem(o,!0),n&&t.trigger(o,"click"),o}else this.unmarkAllAsSelected()},e.prototype.addItemToSelection=function(t){if(t){var e=this.getItem(t);return e?(this.markAsSelected(e,!0),e):null}},e.prototype.removeItemFromSelection=function(t){if(t){var e=this.getItem(t);if(!e)return null;e.classList.remove("selected")}},e.prototype.getSelectedItem=function(){return this.root.querySelector(".ltreeitem.selected")},e.prototype.getSelectedItems=function(){return this.root.querySelectorAll(".ltreeitem.selected")},e.prototype.isItemSelected=function(t){var e=this.getItem(t);return!!e&&this.isNodeSelected(e)},e.prototype.getChildren=function(t,e){return t&&t.constructor!==String&&t.dataset&&(t=t.dataset.item_id),this._findChildElements(t,e)},e.prototype.getParent=function(t){var e=this.getItem(t);return e?this.getItem(e.parent_id):null},e.prototype.getAncestors=function(t,e){e=e||[];var i=this.getItem(t);return i?(e.push(i),this.getAncestors(i.parent_id,e)):e},e.prototype.isAncestor=function(t,e){var i=this.getItem(t);if(!i)return!1;var n=this.getItem(e),o=this.getItem(i.parent_id);return!!o&&(o==n||this.isAncestor(o,e))},e.prototype.moveItem=function(t,e){if(t===e)return!1;var i=this.getItem(t),n=this.getItem(e);if(this.isAncestor(n,i))return!1;var o=this._findElementIndex(n),r=parseInt(n.dataset.level),s=this.getParent(i);if(!s)return console.error("node parent not found by id, maybe id has changed"),!1;var a=parseInt(s.dataset.level),l=r-a;if(!n||!i)return!1;if(n==s)return!1;i.parent_id=e;var c=this.getChildren(i);if(c){c.unshift(i);for(var d=0;d<c.length;d++)c[d].parentNode.removeChild(c[d]);for(var d=0;d<c.length;d++){var h=c[d],u=parseInt(h.dataset.level)+l;h.dataset.level=u}o=this._findElementIndex(n);var p=this._findElementLastChildIndex(o);-1==p&&(p=0);for(var d=0;d<c.length;d++){var h=c[d];this._insertInside(h,o,p+d-1,parseInt(h.dataset.level))}}return this._updateListBox(n),s&&this._updateListBox(s),!0},e.prototype.removeItem=function(t,e){var i=t;if("string"==typeof t&&(i=this.getItem(t)),!i)return!1;var n=this.getParent(i),o=null;if(e&&(o=this.getChildren(i)),this.root.removeChild(i),o)for(var r=0;r<o.length;r++)this.root.removeChild(o[r]);return n&&this._updateListBox(n),!0},e.prototype.updateItem=function(t,e){var i=this.getItem(t);if(!i)return!1;if(i.data=e,e.id&&(i.id=e.id),e.content){var n=i.title_element.querySelector(".incontent");n.innerHTML=e.content}return!0},e.prototype.updateItemId=function(t,e){var i=this.getItem(t);if(!i)return!1;var n=this.getChildren(t,!0);i.id=e;for(var o=0;o<n.length;++o){var r=n[o];r.parent_id=e}return!0},e.prototype.clear=function(t){if(t)for(var e=this.root.querySelectorAll(".ltreeitem"),i=1;i<e.length;i++){var n=e[i];this.root.removeChild(n)}else this.root.innerHTML=""},e.prototype.getNodeByIndex=function(t){var e=this.root.querySelectorAll(".ltreeitem");return e[t]},e.prototype.unmarkAllAsSelected=function(){this.root.classList.remove("selected");var t=this.root.querySelectorAll(".ltreeitem.selected");if(t)for(var e=0;e<t.length;e++)t[e].classList.remove("selected");for(var i=this.root.querySelectorAll(".ltreeitem.semiselected"),e=0;e<i.length;e++)i[e].classList.remove("semiselected")},e.prototype.isNodeSelected=function(t){return!!t.classList.contains("selected")},e.prototype.markAsSelected=function(t,e){if(!t.classList.contains("selected")){e||this.unmarkAllAsSelected(),t.classList.add("selected");for(var i=this.getParent(t),n=[];i&&-1==n.indexOf(i);)i.classList.add("semiselected"),n.push(i),i=this.getParent(i)}},e.prototype._updateListBox=function(e,i,n){if(e){var o=this;if(!e.listbox){var r=e.title_element.querySelector(".collapsebox"),s=t.createLitebox(!0,function(i){o.onClickBox(i,e),t.trigger(o.root,"item_collapse_change",{item:e,data:s.getValue()})});s.stopPropagation=!0,s.setEmpty(!0),r.appendChild(s),e.listbox=s}(i&&i.collapsed||n>=this.collapsed_depth)&&e.listbox.collapse();var a=this.getChildren(e.dataset.item_id);a&&(a.length?e.listbox.setEmpty(!1):e.listbox.setEmpty(!0))}},e.prototype.onClickBox=function(t,e){var i=this.getChildren(e);if(i)for(var n=0;n<i.length;++n){var o=i[n],r=this.getParent(o),s=!0;r&&(s=this._isNodeChildrenVisible(r)),s?o.classList.remove("hidden"):o.classList.add("hidden")}},t.Tree=e}),t("skylark-litegui/widgets",["./litegui"],function(t){function e(t,e){e=e||{},t=t||"";var i=document.createElement("div");i.className="litegui searchbox";var n=null!=e.placeholder?e.placeholder:"Search";i.innerHTML="<input value='"+t+"' placeholder='"+n+"'/>",this.input=i.querySelector("input"),this.root=i;var o=this;this.input.onchange=function(t){var i=t.target.value;e.callback&&e.callback.call(o,i)}}function i(t,e){e=e||{},this.options=e;var i=this;e.parentMenu&&(e.parentMenu.constructor!==this.constructor?(console.error("parentMenu must be of class ContextMenu, ignoring it"),e.parentMenu=null):(this.parentMenu=e.parentMenu,this.parentMenu.lock=!0,this.parentMenu.current_submenu=this)),e.event&&"MouseEvent"!==e.event.constructor.name&&"PointerEvent"!==e.event.constructor.name&&"CustomEvent"!==e.event.constructor.name&&(console.error("Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it."),e.event=null);var n=document.createElement("div");if(n.className="litecontextmenu litemenubar-panel",n.style.minWidth=100,n.style.minHeight=100,n.style.pointerEvents="none",setTimeout(function(){n.style.pointerEvents="auto"},100),n.addEventListener("mouseup",function(t){return t.preventDefault(),!0},!0),n.addEventListener("contextmenu",function(t){return 2==t.button&&(t.preventDefault(),!1)},!0),n.addEventListener("mousedown",function(t){if(2==t.button)return i.close(),t.preventDefault(),!0},!0),this.root=n,e.title){var o=document.createElement("div");o.className="litemenu-title",o.innerHTML=e.title,n.appendChild(o)}for(var r in t){var s=t.constructor==Array?t[r]:r;null!=s&&s.constructor!==String&&(s=void 0===s.content?String(s):s.content);var a=t[r];this.addItem(s,a,e),0}function l(t){var e=parseInt(n.style.top);return n.style.top=(e+.1*t.deltaY).toFixed()+"px",t.preventDefault(),!0}n.addEventListener("mouseleave",function(t){i.lock||(n.closing_timer&&clearTimeout(n.closing_timer),n.closing_timer=setTimeout(i.close.bind(i,t),500))}),n.addEventListener("mouseenter",function(t){n.closing_timer&&clearTimeout(n.closing_timer)}),n.addEventListener("wheel",l,!0),n.addEventListener("mousewheel",l,!0);var c=document;e.event&&(c=e.event.target.ownerDocument),c||(c=document),c.body.appendChild(n);var d=e.left||0,h=e.top||0;if(e.event)if("MouseEvent"!==e.event.constructor.name&&"PointerEvent"!==e.event.constructor.name&&"CustomEvent"!==e.event.constructor.name)console.warn("Event passed to ContextMenu is not of type MouseEvent"),e.event=null;else{if(d=e.event.pageX-10,h=e.event.pageY-10,e.title&&(h-=20),e.parentMenu){var u=e.parentMenu.root.getBoundingClientRect();d=u.left+u.width}var p=document.body.getBoundingClientRect(),f=n.getBoundingClientRect();d>p.width-f.width-10&&(d=p.width-f.width-10),h>p.height-f.height-10&&(h=p.height-f.height-10)}n.style.left=d+"px",n.style.top=h+"px"}function n(e,i,n){n=n||{};var o=this.root=document.createElement("ul");o.id=e,o.className="litelist",this.items=[];var r=this;for(var s in this.callback=n.callback,i){var a=document.createElement("li");a.className="list-item",a.data=i[s],a.dataset.value=i[s];var l="";"string"==typeof i[s]?l=i[s]+"<span class='arrow'></span>":(l=(i[s].name||i[s].title||"")+"<span class='arrow'></span>",i[s].id&&(a.id=i[s].id)),a.innerHTML=l,a.addEventListener("click",function(){for(var e=o.querySelectorAll(".list-item.selected"),i=0;i<e.length;++i)e[i].classList.remove("selected");this.classList.add("selected"),t.trigger(r.root,"wchanged",this),r.callback&&r.callback(this.data)}),o.appendChild(a)}n.parent&&(n.parent.root?n.parent.root.appendChild(o):n.parent.appendChild(o))}function o(e){e=e||{},this.root=document.createElement("div"),this.root.className="litecomplexlist",this.item_code=e.item_code||"<div class='listitem'><span class='tick'><span>"+t.special_codes.tick+"</span></span><span class='title'></span><button class='trash'>"+t.special_codes.close+"</button></div>",e.height&&(this.root.style.height=t.sizeToCSS(e.height)),this.selected=null,this.onItemSelected=null,this.onItemToggled=null,this.onItemRemoved=null}return t.Button=function(t,e){"function"==typeof(e=e||{})&&(e={callback:e});var i=this,n=document.createElement("div");n.className="litegui button",this.root=n;var o=document.createElement("button");o.className="litebutton",this.content=o,n.appendChild(o),o.innerHTML=t,o.addEventListener("click",function(t){i.click()}),this.click=function(){e.callback&&e.callback.call(i)}},e.prototype.setValue=function(t){this.input.value=t,this.input.onchange()},e.prototype.getValue=function(){return this.input.value},t.SearchBox=e,i.prototype.addItem=function(e,i,n){var o=this;n=n||{};var r=document.createElement("div");r.className="litemenu-entry submenu";var s=!1;function a(e){var i=this.value,r=!0;if(o.current_submenu&&o.current_submenu.close(e),n.callback){var s=n.callback.call(o,i,n,e);!0===s&&(r=!1)}if(i){if(i.callback&&!n.ignore_item_callbacks&&!0!==i.disabled){var s=i.callback.call(this,i,n,e,o);!0===s&&(r=!1)}if(i.submenu){if(!i.submenu.options)throw"ContextMenu submenu needs options";new t.ContextMenu(i.submenu.options,{callback:i.submenu.callback,event:e,parentMenu:o,ignore_item_callbacks:i.submenu.ignore_item_callbacks,title:i.submenu.title,autoopen:n.autoopen});r=!1}}r&&!o.lock&&o.close()}return null===i?r.classList.add("separator"):(r.innerHTML=i&&i.title?i.title:e,r.value=i,i&&(i.disabled&&(s=!0,r.classList.add("disabled")),(i.submenu||i.has_submenu)&&r.classList.add("has_submenu")),"function"==typeof i?(r.dataset.value=e,r.onclick_callback=i):r.dataset.value=i),this.root.appendChild(r),s||r.addEventListener("click",a),n.autoopen&&r.addEventListener("mouseenter",function(t){var e=this.value;if(!e||!e.has_submenu)return;a.call(this,t)}),r},i.prototype.close=function(e,i){this.root.parentNode&&this.root.parentNode.removeChild(this.root),this.parentMenu&&!i&&(this.parentMenu.lock=!1,this.parentMenu.current_submenu=null,void 0===e?this.parentMenu.close():e&&!t.isCursorOverElement(e,this.parentMenu.root)&&t.trigger(this.parentMenu.root,"mouseleave",e)),this.current_submenu&&this.current_submenu.close(e,!0),this.root.closing_timer&&clearTimeout(this.root.closing_timer)},i.prototype.getTopMenu=function(){return this.options.parentMenu?this.options.parentMenu.getTopMenu():this},i.prototype.getFirstEvent=function(){return this.options.parentMenu?this.options.parentMenu.getFirstEvent():this.options.event},t.ContextMenu=i,t.ContextualMenu=i,t.Checkbox=function(t,e){this.value=t;var i=this.root=document.createElement("span");i.className="litecheckbox inputfield",i.dataset.value=t;var n=this.element=document.createElement("span");n.className="fixed flag checkbox "+(t?"on":"off"),i.appendChild(n),i.addEventListener("click",function(t){this.setValue("true"!=this.root.dataset.value),t.preventDefault(),t.stopPropagation()}.bind(this)),this.setValue=function(t){if(this.value!==t&&this.root.dataset.value!=t.toString()){this.root.dataset.value=t,t?(this.element.classList.remove("off"),this.element.classList.add("on")):(this.element.classList.remove("on"),this.element.classList.add("off"));var i=this.value;this.value=t,e&&e(t,i)}},this.getValue=function(){return this.value}},t.createLitebox=function(t,e){var i=document.createElement("span");return i.className="listbox "+(t?"listopen":"listclosed"),i.innerHTML=t?"&#9660;":"&#9658;",i.dataset.value=t?"open":"closed",i.addEventListener("click",function(t){t.target.setValue("open"!=this.dataset.value),this.stopPropagation&&t.stopPropagation()}),i.on_change_callback=e,i.setEmpty=function(t){t?this.classList.add("empty"):this.classList.remove("empty")},i.expand=function(){this.setValue(!0)},i.collapse=function(){this.setValue(!1)},i.setValue=function(t){this.dataset.value!=(t?"open":"closed")&&(t?(this.dataset.value="open",this.innerHTML="&#9660;",this.classList.add("listopen"),this.classList.remove("listclosed")):(this.dataset.value="closed",this.innerHTML="&#9658;",this.classList.remove("listopen"),this.classList.add("listclosed")),e&&e(this.dataset.value))},i.getValue=function(){return this.dataset.value},i},n.prototype.getSelectedItem=function(){return this.root.querySelector(".list-item.selected")},n.prototype.setSelectedItem=function(e){for(var i=this.root.querySelectorAll(".list-item"),n=0;n<i.length;n++){var o=i[n];if(o.data==e){t.trigger(o,"click");break}}},t.List=n,t.Slider=function(e,i){i=i||{};var n=this.root=document.createElement("div"),o=this;function r(t){var e=n.getBoundingClientRect();if(e){var r=e.width,s=t/r,a=i.min||0,l=i.max||1,c=l-a;o.setValue(c*s+a)}}this.value=e,n.className="liteslider",this.setValue=function(e,o){var r=i.min||0,s=i.max||1;e<r?e=r:e>s&&(e=s);var a=s-r,l=(e-r)/a,c=(100*l).toFixed(1)+"%",d=(100*l+2).toFixed(1)+"%";n.style.background="linear-gradient(to right, #999 "+c+", #FC0 "+d+", #333 "+d+")",e!=this.value&&(this.value=e,o||(t.trigger(this.root,"change",e),this.onChange&&this.onChange(e)))};var s=null;function a(t){var e=n.getBoundingClientRect();if(e){var i=void 0===t.x?t.pageX:t.x,o=i-e.left;return r(o),t.preventDefault(),!1}}function l(t){var e=s||document;return s=null,e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",l),t.preventDefault(),!1}n.addEventListener("mousedown",function(t){var e;t.offsetX?(e=t.offsetX,t.offsetY):t.layerX&&(e=t.layerX,t.layerY),r(e),(s=n.ownerDocument).addEventListener("mousemove",a),s.addEventListener("mouseup",l),t.preventDefault(),t.stopPropagation()}),this.setValue(e)},t.LineEditor=function(e,i){i=i||{};var n=document.createElement("div");n.className="curve "+(i.extraclass?i.extraclass:""),n.style.minHeight="50px",n.style.width=i.width||"100%",n.bgcolor=i.bgcolor||"#222",n.pointscolor=i.pointscolor||"#5AF",n.linecolor=i.linecolor||"#444",n.value=e||[],n.xrange=i.xrange||[0,1],n.yrange=i.yrange||[0,1],n.defaulty=null!=i.defaulty?i.defaulty:.5,n.no_trespassing=i.no_trespassing||!1,n.show_samples=i.show_samples||0,n.options=i,n.style.minWidth="50px",n.style.minHeight="20px";var o=document.createElement("canvas");function r(t){return[o.width*((n.xrange[1]-n.xrange[0])*t[0]+n.xrange[0]),o.height*((n.yrange[1]-n.yrange[0])*t[1]+n.yrange[0])]}function s(t){return[(t[0]/o.width-n.xrange[0])/(n.xrange[1]-n.xrange[0]),(t[1]/o.height-n.yrange[0])/(n.yrange[1]-n.yrange[0])]}o.width=i.width||200,o.height=i.height||50,n.appendChild(o),n.canvas=o,n.addEventListener("mousedown",function(t){document.addEventListener("mousemove",c),document.addEventListener("mouseup",d);var e=o.getBoundingClientRect(),i=t.clientX-e.left,h=t.clientY-e.top;if(-1==(a=function(t,e){for(var i=1e5,o=-1,s=0;s<n.value.length;s++){var a=n.value[s],l=r(a),c=u([t,e],l);c<i&&c<8&&(i=c,o=s)}return o}(i,o.height-h))){var f=s([i,o.height-h]);n.value.push(f),p(),a=n.value.indexOf(f)}l=[i,h],n.redraw(),t.preventDefault(),t.stopPropagation()}),n.getValueAt=function(t){if(t<n.xrange[0]||t>n.xrange[1])return n.defaulty;for(var e=[n.xrange[0],n.defaulty],i=0,o=0;o<n.value.length;o+=1){var r=n.value[o];if(t==r[0])return r[1];if(t<r[0])return i=(t-e[0])/(r[0]-e[0]),e[1]*(1-i)+r[1]*i;e=r}return r=[n.xrange[1],n.defaulty],i=(t-e[0])/(r[0]-e[0]),e[1]*(1-i)+r[1]*i},n.resample=function(t){for(var e=[],i=(n.xrange[1]-n.xrange[0])/t,o=n.xrange[0];o<=n.xrange[1];o+=i)e.push(n.getValueAt(o));return e},n.addValue=function(t){for(var e=0;e<n.value;e++){var i=n.value[e];if(!(i[0]<t[0]))return n.value.splice(e,0,t),void redraw()}n.value.push(t),redraw()};var a=-1;n.redraw=function(){var t=o.parentNode.getBoundingClientRect();t&&o.width!=t.width&&t.width&&t.width<1e3&&(o.width=t.width),t&&o.height!=t.height&&t.height&&t.height<1e3&&(o.height=t.height);var e=o.getContext("2d");e.setTransform(1,0,0,1,0,0),e.translate(0,o.height),e.scale(1,-1),e.fillStyle=n.bgcolor,e.fillRect(0,0,o.width,o.height),e.strokeStyle=n.linecolor,e.beginPath();var i=r([n.xrange[0],n.defaulty]);for(var s in e.moveTo(i[0],i[1]),n.value){var l=n.value[s];i=r(l),e.lineTo(i[0],i[1])}i=r([n.xrange[1],n.defaulty]),e.lineTo(i[0],i[1]),e.stroke();for(var s=0;s<n.value.length;s+=1){var l=n.value[s];i=r(l),e.fillStyle=a==s?"white":n.pointscolor,e.beginPath(),e.arc(i[0],i[1],a==s?4:2,0,2*Math.PI),e.fill()}if(n.show_samples){var c=n.resample(n.show_samples);e.fillStyle="#888";for(var s=0;s<c.length;s+=1){var l=[s*((n.xrange[1]-n.xrange[0])/n.show_samples)+n.xrange[0],c[s]];i=r(l),e.beginPath(),e.arc(i[0],i[1],2,0,2*Math.PI),e.fill()}}};var l=[0,0];function c(t){var e=o.getBoundingClientRect(),i=t.clientX-e.left,r=t.clientY-e.top;if(i<0?i=0:i>o.width&&(i=o.width),r<0?r=0:r>o.height&&(r=o.height),-1!=a&&u([t.clientX-e.left,t.clientY-e.top],[i,r])>.5*o.height)return n.value.splice(a,1),void d(t);var c=l[0]-i,f=l[1]-r,v=s([-c,f]);if(-1!=a){var g=n.xrange[0],m=n.xrange[1];n.no_trespassing&&(a>0&&(g=n.value[a-1][0]),a<n.value.length-1&&(m=n.value[a+1][0]));var y=n.value[a];y[0]+=v[0],y[1]+=v[1],y[0]<g?y[0]=g:y[0]>m&&(y[0]=m),y[1]<n.yrange[0]?y[1]=n.yrange[0]:y[1]>n.yrange[1]&&(y[1]=n.yrange[1])}p(),n.redraw(),l[0]=i,l[1]=r,h(),t.preventDefault(),t.stopPropagation()}function d(t){a=-1,n.redraw(),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d),h(),t.preventDefault(),t.stopPropagation()}function h(){i.callback?i.callback.call(n,n.value):t.trigger(n,"change")}function u(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function p(){var t=null;-1!=a&&(t=n.value[a]),n.value.sort(function(t,e){return t[0]-e[0]}),t&&(a=n.value.indexOf(t))}return n.redraw(),n},o.prototype.addTitle=function(e){var i=t.createElement("div",".listtitle",e);return this.root.appendChild(i),i},o.prototype.addHTML=function(e,i){var n=t.createElement("div",".listtext",e);return i&&n.addEventListener("mousedown",i),this.root.appendChild(n),n},o.prototype.clear=function(){this.root.innerHTML=""},o.prototype.addItem=function(e,i,n,o){var r=i||e.content||e.name,s=t.createListItem(this.item_code,{".title":r});s.item=e,n&&s.classList.add("enabled"),o||(s.querySelector(".trash").style.display="none");var a=this;return s.addEventListener("mousedown",function(t){t.preventDefault(),this.setSelected(!0),a.onItemSelected&&a.onItemSelected(e,s)}),s.querySelector(".tick").addEventListener("mousedown",function(t){t.preventDefault(),s.classList.toggle("enabled"),a.onItemToggled&&a.onItemToggled(e,s,s.classList.contains("enabled"))}),s.querySelector(".trash").addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),a.onItemRemoved&&a.onItemRemoved(e,s)}),s.setContent=function(t,e){e?s.querySelector(".title").innerHTML=t:s.querySelector(".title").innerText=t},s.toggleEnabled=function(t){s.classList.toggle("enabled")},s.setSelected=function(e){t.removeClass(a.root,"selected"),e?this.classList.add("selected"):this.classList.remove("selected"),a.selected=s.item},s.show=function(){this.style.display=""},s.hide=function(){this.style.display="none"},this.root.appendChild(s),s},t.ComplexList=o,t}),t("skylark-litegui/main",["./litegui","./Area","./Console","./Dialog","./Dragger","./Inspector","./Menubar","./Panel","./Split","./Table","./Tabs","./Tree","./widgets"],function(t){return t}),t("skylark-litegui",["skylark-litegui/main"],function(t){return t})}(i),!n){var s=require("skylark-langx-ns");o?module.exports=s:e.skylarkjs=s}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-litegui.js.map
