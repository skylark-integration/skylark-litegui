/**
 * skylark-litegui - A version of litegui.js  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-litegui/
 * @license MIT
 */
define(["./litegui"],function(t){function e(e,i){if(i||e&&e.constructor===String){var s=e;(e=i||{}).id=s,console.warn("LiteGUI.Tabs legacy parameter, use options as first parameter instead of id.")}e=e||{},this.options=e;var a=this.mode=e.mode||"horizontal",o=document.createElement("DIV");e.id&&(o.id=e.id),o.data=this,o.className="litetabs "+a,this.root=o,this.root.tabs=this,this.current_tab=null,"horizontal"==a?e.size&&("full"==e.size?this.root.style.height="100%":this.root.style.height=e.size):"vertical"==a&&e.size&&("full"==e.size?this.root.style.width="100%":this.root.style.width=e.size),e.width&&(this.root.style.width=e.width.constructor===Number?e.width.toFixed(0)+"px":e.width),e.height&&(this.root.style.height=e.height.constructor===Number?e.height.toFixed(0)+"px":e.height);var n=document.createElement("UL");function r(t){t.deltaY&&(n.scrollLeft+=t.deltaY)}n.className="wtabcontainer","vertical"==a?n.style.width=t.Tabs.tabs_width+"px":n.style.height=t.Tabs.tabs_height+"px",n.addEventListener("wheel",r),n.addEventListener("mousewheel",r),this.list=n,this.root.appendChild(this.list),this.tabs_root=n,this.tabs={},this.tabs_by_index=[],this.selected=null,this.onchange=e.callback,e.parent&&this.appendTo(e.parent)}return e.tabs_width=64,e.tabs_height=26,e.prototype.show=function(){this.root.style.display="block"},e.prototype.hide=function(){this.root.style.display="none"},e.prototype.getCurrentTab=function(){return this.current_tab?this.tabs[this.current_tab[0]]:null},e.prototype.getCurrentTabId=function(){return this.current_tab[0]},e.prototype.getPreviousTab=function(){return this.previous_tab?this.tabs[this.previous_tab[0]]:null},e.prototype.appendTo=function(t,e){e?t.prepend(this.root):t.appendChild(this.root)},e.prototype.getTab=function(t){return this.tabs[t]},e.prototype.getTabByIndex=function(t){return this.tabs_by_index[t]},e.prototype.getNumOfTabs=function(){var t=0;for(var e in this.tabs)t++;return t},e.prototype.getTabContent=function(t){var e=this.tabs[t];if(e)return e.content},e.prototype.getTabIndex=function(t){var e=this.tabs[t];if(!e)return-1;for(var i=0;i<this.list.childNodes.length;i++)if(this.list.childNodes[i]==e.tab)return i;return-1},e.prototype.addTab=function(i,s,a){"function"==typeof(s=s||{})&&(s={callback:s});var o=this;void 0!==i&&null!==i||(i="rand_"+(1e6*Math.random()|0));var n=document.createElement("LI"),r=i.replace(/ /gi,"_");if(n.className="wtab wtab-"+r+" ",n.dataset.id=i,n.innerHTML="<span class='tabtitle'>"+(s.title||i)+"</span>",s.button&&(n.className+="button "),s.tab_className&&(n.className+=s.tab_className),s.bigicon&&(n.innerHTML="<img class='tabbigicon' src='"+s.bigicon+"'/>"+n.innerHTML),s.closable&&(n.innerHTML+="<span class='tabclose'>"+t.special_codes.close+"</span>",n.querySelector("span.tabclose").addEventListener("click",function(t){o.removeTab(i),t.preventDefault(),t.stopPropagation()},!0)),void 0!==s.index){var l=this.list.childNodes[s.index];l?this.list.insertBefore(n,l):this.list.appendChild(n)}else this.plus_tab?this.list.insertBefore(n,this.plus_tab):this.list.appendChild(n);s.tab_width&&(n.style.width=s.tab_width.constructor===Number?s.tab_width.toFixed(0)+"px":s.tab_width,n.style.minWidth="0"),this.options.autoswitch&&(n.classList.add("autoswitch"),n.addEventListener("dragenter",function(e){o._timeout_mouseover&&clearTimeout(o._timeout_mouseover),o._timeout_mouseover=setTimeout(function(){t.trigger(this,"click"),o._timeout_mouseover=null}.bind(this),500)}),n.addEventListener("dragleave",function(t){o._timeout_mouseover&&(clearTimeout(o._timeout_mouseover),o._timeout_mouseover=null)}));var c=document.createElement("div");s.id&&(c.id=s.id),c.className="wtabcontent wtabcontent-"+r+" "+(s.className||""),c.dataset.id=i,c.style.display="none","horizontal"==this.mode?s.size&&(c.style.overflow="auto","full"==s.size?(c.style.width="100%",c.style.height="calc( 100% - "+t.Tabs.tabs_height+"px )",c.style.height="-moz-calc( 100% - "+t.Tabs.tabs_height+"px )",c.style.height="-webkit-calc( 100% - "+t.Tabs.tabs_height+"px )"):c.style.height=s.size):"vertical"==this.mode&&s.size&&(c.style.overflow="auto","full"==s.size?(c.style.height="100%",c.style.width="calc( 100% - "+t.Tabs.tabs_width+"px )",c.style.width="-moz-calc( 100% - "+t.Tabs.tabs_width+"px )",c.style.width="-webkit-calc( 100% - "+t.Tabs.tabs_width+"px )"):c.style.width=s.size),void 0!==s.width&&(c.style.width="string"==typeof s.width?s.width:s.width+"px"),void 0!==s.height&&(c.style.height="string"==typeof s.height?s.height:s.height+"px"),s.content&&("string"==typeof s.content?c.innerHTML=s.content:c.appendChild(s.content)),this.root.appendChild(c),s.button?n.addEventListener("click",function(t){var e=this.dataset.id;s.callback&&s.callback(e,t)}):n.addEventListener("click",e.prototype.onTabClicked),n.options=s,n.tabs=this;var h=n.querySelector("span.tabtitle"),d={id:i,tab:n,content:c,title:h,add:function(t){this.content.appendChild(t.root||t)},setTitle:function(t){this.title.innerHTML=t},click:function(){t.trigger(this.tab,"click")},destroy:function(){o.removeTab(this.id)}};return s.onclose&&(d.onclose=s.onclose),this.tabs[i]=d,this.recomputeTabsByIndex(),n.addEventListener("contextmenu",function(t){return 2==t.button&&(t.preventDefault(),s.callback_context&&s.callback_context.call(d),!1)}.bind(this)),1!=s.selected&&null!=this.selected||this.selectTab(i,s.skip_callbacks),d},e.prototype.addPlusTab=function(t){this.plus_tab&&console.warn("There is already a plus tab created in this tab widget"),this.plus_tab=this.addTab("plus_tab",{title:"+",tab_width:20,button:!0,callback:t,skip_callbacks:!0})},e.prototype.addButtonTab=function(t,e,i){return this.addTab(t,{title:e,tab_width:20,button:!0,callback:i,skip_callbacks:!0})},e.prototype.onTabClicked=function(e){if(!this.classList.contains("selected")&&this.parentNode){var i=this.options,s=this.parentNode.parentNode.tabs;if(!s)throw"tabs not found";var a=s;if(!i.callback_canopen||0!=i.callback_canopen()){a.current_tab&&a.current_tab[0]!=o&&a.current_tab[2]&&a.current_tab[2].callback_leave&&a.current_tab[2].callback_leave(a.current_tab[0],a.current_tab[1],a.current_tab[2]);var o=this.dataset.id,n=null;for(var r in a.tabs){var l=a.tabs[r];r==o?(l.selected=!0,l.content.style.display="",n=l.content):(delete l.selected,l.content.style.display="none")}var c=a.list.querySelectorAll("li.wtab");for(r=0;r<c.length;++r)c[r].classList.remove("selected");this.classList.add("selected"),a.previous_tab=a.current_tab,a.current_tab=[o,n,i],e&&(i.callback&&i.callback(o,n,e),t.trigger(a,"wchange",[o,n]),a.onchange&&a.onchange(o,n)),a.selected=o}}},e.prototype.selectTab=function(t,e){if(t){t.constructor!=String&&(t=t.id);for(var i=this.list.querySelectorAll("li.wtab"),s=0;s<i.length;s++)if(t==i[s].dataset.id){this.onTabClicked.call(i[s],!e);break}}},e.prototype.setTabVisibility=function(t,e){var i=this.tabs[t];i&&(i.tab.style.display=e?"none":null,i.content.style.display=e?"none":null)},e.prototype.recomputeTabsByIndex=function(){for(var t in this.tabs_by_index=[],this.tabs){for(var e=this.tabs[t],i=0,s=e.tab;null!=(s=s.previousSibling);)i++;this.tabs_by_index[i]=e}},e.prototype.removeTab=function(t){var e=this.tabs[t];e?(e.onclose&&e.onclose(e),e.tab.parentNode&&e.tab.parentNode.removeChild(e.tab),e.content.parentNode&&e.content.parentNode.removeChild(e.content),delete this.tabs[t],this.recomputeTabsByIndex()):console.warn("tab not found: "+t)},e.prototype.removeAllTabs=function(t){var e=[];for(var i in this.tabs)e.push(this.tabs[i]);for(var i in e){var s=e[i];s==this.plus_tab&&t||(s.tab.parentNode&&s.tab.parentNode.removeChild(s.tab),s.content.parentNode&&s.content.parentNode.removeChild(s.content),delete this.tabs[s.id])}this.recomputeTabsByIndex()},e.prototype.clear=function(){this.removeAllTabs()},e.prototype.hideTab=function(t){this.setTabVisibility(t,!1)},e.prototype.showTab=function(t){this.setTabVisibility(t,!0)},e.prototype.transferTab=function(t,e,i){var s=this.tabs[t];if(s){e.tabs[t]=s,void 0!==i?e.list.insertBefore(s.tab,e.list.childNodes[i]):e.list.appendChild(s.tab),e.root.appendChild(s.content),delete this.tabs[t];var a=null;for(var o in this.tabs){a=o;break}a&&this.selectTab(a),s.tab.classList.remove("selected"),e.selectTab(t)}},e.prototype.detachTab=function(e,i,s){if(this.tabs[e]){var a=this.getTabIndex(e),o=window.open("","","width=800, height=600, location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");o.document.write("<head><title>"+e+"</title>");for(var n=document.querySelectorAll("link[rel='stylesheet'],style"),r=0;r<n.length;r++)o.document.write(n[r].outerHTML);o.document.write("</head><body></body>"),o.document.close();var l=this,c=new t.Tabs(null,this.options);return o.tabs=c,o.onbeforeunload=function(){c.transferTab(e,l,a),s&&s()},c.list.style.height="20px",o.document.body.appendChild(c.root),l.transferTab(e,c),c.tabs[e].tab.classList.add("selected"),this.recomputeTabsByIndex(),i&&i(),o}},t.Tabs=e});
//# sourceMappingURL=sourcemaps/Tabs.js.map
