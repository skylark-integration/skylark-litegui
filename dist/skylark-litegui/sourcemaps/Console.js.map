{"version":3,"sources":["Console.js"],"names":["define","LiteGUI","Console","options","this","root","document","createElement","className","innerHTML","log_element","querySelector","input","addEventListener","processKeyDown","bind","_prompt","prompt","onAutocomplete","onProcessCommand","history","_history_offset","prototype","e","_input_blocked","keyCode","cmd","value","trim","addMessage","push","length","shift","pos","preventDefault","stopPropagation","text","as_text","content","element","constructor","Array","i","add","Object","JSON","stringify","txt","con","innerText","appendChild","children","removeChild","scrollTop","update","v","log","d","slice","call","arguments","join","warn","error","clear"],"mappings":"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","file":"../Console.js","sourcesContent":["//enclose in a scope\r\ndefine([\r\n\t\"./litegui\"\r\n],function(LiteGUI){\r\n\r\n\tfunction Console( options )\r\n\t{\r\n\t\toptions = options || {};\r\n\r\n\t\tthis.root = document.createElement(\"div\");\r\n\t\tthis.root.className = \"liteconsole\";\r\n\t\tthis.root.innerHTML = \"<div class='log'></div><div class='foot'><input type='text'/></div>\";\r\n\r\n\t\tthis.log_element = this.root.querySelector('.log');\r\n\t\tthis.input = this.root.querySelector('input');\r\n\r\n\t\tthis.input.addEventListener(\"keydown\", this.processKeyDown.bind(this) );\r\n\t\tthis._prompt = options.prompt || \"]\";\r\n\r\n\t\tthis.onAutocomplete = null; //receives string, must return final string\r\n\t\tthis.onProcessCommand = null; //receives input value\r\n\r\n\t\tthis.history = [];\r\n\t\tthis._history_offset = 0;\r\n\t}\r\n\r\n\tConsole.prototype.processKeyDown = function(e)\r\n\t{\r\n\t\tif(this._input_blocked)\r\n\t\t\treturn;\r\n\r\n\t\tif(e.keyCode == 13) //return and exec\r\n\t\t{\r\n\t\t\tvar value = this.input.value;\r\n\t\t\tvar cmd = value.trim();\r\n\t\t\tthis.addMessage( this._prompt + cmd, \"me\",true);\r\n\t\t\tthis.input.value = \"\";\r\n\t\t\tthis.history.push(cmd);\r\n\t\t\tif(this.history.length > 10)\r\n\t\t\t\tthis.history.shift();\r\n\t\t\tif( this.onProcessCommand )\r\n\t\t\t\tthis.onProcessCommand( cmd );\r\n\t\t\tthis._history_offset = 0;\r\n\t\t}\r\n\t\telse if(e.keyCode == 38 || e.keyCode == 40) //up & down history\r\n\t\t{\r\n\t\t\tthis._history_offset += (e.keyCode == 38 ? -1 : 1);\r\n\t\t\tif(this._history_offset > 0)\r\n\t\t\t\tthis._history_offset = 0;\r\n\t\t\telse if(this._history_offset < -this.history.length)\r\n\t\t\t\tthis._history_offset = -this.history.length;\r\n\t\t\tvar pos = this.history.length + this._history_offset;\r\n\t\t\tif(pos < 0)\r\n\t\t\t\treturn;\r\n\t\t\tif( pos >= this.history.length)\r\n\t\t\t\tthis.input.value = \"\";\r\n\t\t\telse\r\n\t\t\t\tthis.input.value = this.history[ pos ];\r\n\t\t}\r\n\t\telse if(e.keyCode == 9) //tab autocompletion\r\n\t\t{\r\n\t\t\tif(this.onAutocomplete)\r\n\t\t\t\tthis.input.value = this.onAutocomplete( this.input.value );\r\n\t\t\telse\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn;\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n\tConsole.prototype.addMessage = function(text,className,as_text)\r\n\t{\r\n\t\tvar content = this.log_element;\r\n\t\tvar element = null; //contains the last message sent\r\n\r\n\t\tif(text && text.constructor === Array)\r\n\t\t{\r\n\t\t\tfor( var i = 0; i < text.length; ++i )\r\n\t\t\t\tadd( text[i] );\r\n\t\t}\r\n\t\telse if(text && text.constructor === Object)\r\n\t\t{\r\n\t\t\tadd( JSON.stringify(text,null,\"\"), this );\r\n\t\t}\r\n\t\telse\r\n\t\t\tadd( text, this );\r\n\r\n\t\tfunction add(txt, con)\r\n\t\t{\r\n\t\t\telement = document.createElement(\"pre\");\r\n\t\t\tif(as_text)\r\n\t\t\t\telement.innerText = txt;\r\n\t\t\telse\r\n\t\t\t\telement.innerHTML = txt;\r\n\t\t\telement.className = \"msg\";\r\n\t\t\tif(className)\r\n\t\t\t\telement.className += \" \" + className;\r\n\t\t\tcontent.appendChild(element);\r\n\t\t\tif( content.children.length > 1000 )\r\n\t\t\t\tcontent.removeChild( content.children[0] );\r\n\t\t}\r\n\r\n\t\tthis.log_element.scrollTop = 1000000;\r\n\t\telement.update = function(v)\r\n\t\t{\r\n\t\t\tthis.innerHTML = v;\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tConsole.prototype.log = function()\r\n\t{\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\tvar d = args.join(\",\");\r\n\t\treturn this.addMessage( d, \"msglog\" );\r\n\t}\r\n\r\n\tConsole.prototype.warn = function()\r\n\t{\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\tvar d = args.join(\",\");\r\n\t\treturn this.addMessage( d, \"msgwarn\" );\r\n\t}\r\n\r\n\tConsole.prototype.error = function()\r\n\t{\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\tvar d = args.join(\",\");\r\n\t\treturn this.addMessage( d, \"msgerror\" );\r\n\t}\r\n\r\n\tConsole.prototype.clear = function()\r\n\t{\r\n\t\tthis.log_element.innerHTML = \"\";\r\n\t}\r\n\r\n\treturn LiteGUI.Console = Console;\r\n\r\n});"]}