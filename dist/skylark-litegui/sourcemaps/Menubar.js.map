{"version":3,"sources":["Menubar.js"],"names":["define","LiteGUI","Menubar","id","options","this","menu","panels","root","document","createElement","className","content","appendChild","is_open","auto_open","sort_entries","closing_time","prototype","clear","innerHTML","attachToPanel","panel","insertBefore","firstChild","add","path","data","callback","prev_length","length","tokens","split","current_token","current_pos","last_item","name","children","console","warn","v","parent","disable","disabled","enable","push","updateMenu","remove","findMenu","index","indexOf","splice","separator","order","that","i","element","addEventListener","e","item","hidePanels","showMenu","is_submenu","closing_by_leave","clearInterval","sorted_entries","sort","a","b","a_order","b_order","menu_item","has_submenu","classList","type","instance","property","checkbox","hasOwnProperty","value","isChecked","call","setTimeout","box","getBoundingClientRect","style","left","top","height","body"],"mappings":"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","file":"../Menubar.js","sourcesContent":["define([\r\n\t\"./litegui\"\r\n],function(LiteGUI){\r\n\r\n\r\n\t/************** MENUBAR ************************/\r\n\tfunction Menubar(id, options)\r\n\t{\r\n\t\toptions = options || {};\r\n\r\n\t\tthis.menu = [];\r\n\t\tthis.panels = [];\r\n\r\n\t\tthis.root = document.createElement(\"div\");\r\n\t\tthis.root.id = id;\r\n\t\tthis.root.className = \"litemenubar\";\r\n\r\n\t\tthis.content = document.createElement(\"ul\");\r\n\t\tthis.root.appendChild( this.content );\r\n\r\n\t\tthis.is_open = false;\r\n\t\tthis.auto_open = options.auto_open || false;\r\n\t\tthis.sort_entries = options.sort_entries || false;\r\n\t}\r\n\r\n\tMenubar.closing_time = 500;\r\n\r\n\tMenubar.prototype.clear = function()\r\n\t{\r\n\t\tthis.content.innerHTML = \"\";\r\n\t\tthis.menu = [];\r\n\t\tthis.panels = [];\r\n\t}\r\n\r\n\tMenubar.prototype.attachToPanel = function(panel)\r\n\t{\r\n\t\tpanel.content.insertBefore( this.root, panel.content.firstChild );\r\n\t}\r\n\r\n\tMenubar.prototype.add = function( path, data )\r\n\t{\r\n\t\tdata = data || {};\r\n\r\n\t\tif( typeof(data) == \"function\" )\r\n\t\t\tdata = { callback: data };\r\n\r\n\t\tvar prev_length = this.menu.length;\r\n\r\n\t\tvar tokens = path.split(\"/\");\r\n\t\tvar current_token = 0;\r\n\t\tvar current_pos = 0;\r\n\t\tvar menu = this.menu;\r\n\t\tvar last_item = null;\r\n\r\n\t\twhile( menu )\r\n\t\t{\r\n\t\t\tif(current_token > 5)\r\n\t\t\t\tthrow(\"Error: Menubar too deep\");\r\n\t\t\t//token not found in this menu, create it\r\n\t\t\tif( menu.length == current_pos )\r\n\t\t\t{\r\n\t\t\t\tvar v = { parent: last_item, children: [] };\r\n\t\t\t\tlast_item = v;\r\n\t\t\t\tif(current_token == tokens.length - 1)\r\n\t\t\t\t\tv.data = data;\r\n\r\n\t\t\t\tv.disable = function() { if( this.data ) this.data.disabled = true; }\r\n\t\t\t\tv.enable = function() { if( this.data ) delete this.data.disabled; }\r\n\r\n\t\t\t\tv.name = tokens[ current_token ];\r\n\t\t\t\tmenu.push( v );\r\n\t\t\t\tcurrent_token++;\r\n\t\t\t\tif( current_token == tokens.length )\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tv.children = [];\r\n\t\t\t\tmenu = v.children;\r\n\t\t\t\tcurrent_pos = 0;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t//token found in this menu, get inside for next token\r\n\t\t\tif( menu[ current_pos ] && tokens[ current_token ] == menu[ current_pos ].name )\r\n\t\t\t{\r\n\t\t\t\tif(current_token < tokens.length - 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tlast_item = menu[ current_pos ];\r\n\t\t\t\t\tmenu = menu[ current_pos ].children;\r\n\t\t\t\t\tcurrent_pos = 0;\r\n\t\t\t\t\tcurrent_token++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\telse //last token\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.warn(\"Warning: Adding menu that already exists: \" + path );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcurrent_pos++;\r\n\t\t}\r\n\r\n\t\tif(prev_length != this.menu.length)\r\n\t\t\tthis.updateMenu();\r\n\t};\r\n\r\n\tMenubar.prototype.remove = function( path )\r\n\t{\r\n\t\tvar menu = this.findMenu( path );\r\n\t\tif(!menu)\r\n\t\t\treturn;\r\n\t\tif(!menu.parent || !menu.parent.children)\r\n\t\t\treturn console.warn(\"menu without parent?\");\r\n\t\t\r\n\t\tvar index = menu.parent.children.indexOf( menu );\r\n\t\tif(index != -1)\r\n\t\t\tmenu.parent.children.splice( index, 1 );\r\n\t},\r\n\r\n\tMenubar.prototype.separator = function( path, order )\r\n\t{\r\n\t\tvar menu = this.findMenu( path );\r\n\t\tif(!menu)\r\n\t\t\treturn;\r\n\t\tmenu.children.push( {separator: true, order: order || 10 } );\r\n\t}\r\n\r\n\t//returns the menu entry that matches this path\r\n\tMenubar.prototype.findMenu = function( path )\r\n\t{\r\n\t\tvar tokens = path.split(\"/\");\r\n\t\tvar current_token = 0;\r\n\t\tvar current_pos = 0;\r\n\t\tvar menu = this.menu;\r\n\r\n\t\twhile( menu )\r\n\t\t{\r\n\t\t\t//no more tokens, return last found menu\r\n\t\t\tif(current_token == tokens.length)\r\n\t\t\t\treturn menu;\r\n\r\n\t\t\t//this menu doesnt have more entries\r\n\t\t\tif(menu.length <= current_pos)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\tif(tokens[ current_token ] == \"*\")\r\n\t\t\t\treturn menu[ current_pos ].children;\r\n\r\n\t\t\t//token found in this menu, get inside for next token\r\n\t\t\tif( tokens[ current_token ] == menu[ current_pos ].name )\r\n\t\t\t{\r\n\t\t\t\tif(current_token == tokens.length - 1) //last token\r\n\t\t\t\t{\r\n\t\t\t\t\treturn menu[ current_pos ];\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmenu = menu[ current_pos ].children;\r\n\t\t\t\t\tcurrent_pos = 0;\r\n\t\t\t\t\tcurrent_token++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//check next entry in this menu\r\n\t\t\tcurrent_pos++;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t//update top main menu\r\n\tMenubar.prototype.updateMenu = function()\r\n\t{\r\n\t\tvar that = this;\r\n\r\n\t\tthis.content.innerHTML = \"\";\r\n\t\tfor(var i in this.menu)\r\n\t\t{\r\n\t\t\tvar element = document.createElement(\"li\");\r\n\t\t\telement.innerHTML = \"<span class='icon'></span><span class='name'>\" + this.menu[i].name + \"</span>\";\r\n\t\t\tthis.content.appendChild(element);\r\n\t\t\telement.data = this.menu[i];\r\n\t\t\tthis.menu[i].element = element;\r\n\r\n\t\t\t/* ON CLICK TOP MAIN MENU ITEM */\r\n\t\t\telement.addEventListener(\"click\", function(e) {\r\n\t\t\t\tvar item = this.data;\r\n\r\n\t\t\t\tif(item.data && item.data.callback && typeof(item.data.callback) == \"function\")\r\n\t\t\t\t\titem.data.callback(item.data);\r\n\r\n\t\t\t\tif(!that.is_open)\r\n\t\t\t\t{\r\n\t\t\t\t\tthat.is_open = true;\r\n\t\t\t\t\tthat.showMenu( item, e, this );\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tthat.is_open = false;\r\n\t\t\t\t\tthat.hidePanels();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\telement.addEventListener(\"mouseover\", function(e) {\r\n\t\t\t\tthat.hidePanels();\r\n\t\t\t\tif(that.is_open || that.auto_open)\r\n\t\t\t\t\tthat.showMenu( this.data, e, this );\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tMenubar.prototype.hidePanels = function() {\r\n\t\tif(!this.panels.length)\r\n\t\t\treturn;\r\n\r\n\t\tfor(var i in this.panels)\r\n\t\t\tLiteGUI.remove(this.panels[i]);\r\n\t\tthis.panels = [];\r\n\t}\r\n\r\n\t//Create the panel with the drop menu\r\n\tMenubar.prototype.showMenu = function(menu, e, root, is_submenu) {\r\n\r\n\t\tif(!is_submenu)\r\n\t\t\tthis.hidePanels();\r\n\r\n\t\tif(!menu.children || !menu.children.length)\r\n\t\t\treturn;\r\n\r\n\t\tvar that = this;\r\n\t\tif(that.closing_by_leave)\r\n\t\t\tclearInterval(that.closing_by_leave);\r\n\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"litemenubar-panel\";\r\n\r\n\t\tvar sorted_entries = [];\r\n\t\tfor(var i in menu.children)\r\n\t\t\tsorted_entries.push(menu.children[i]);\r\n\r\n\t\tif(this.sort_entries)\r\n\t\t\tsorted_entries.sort(function(a,b) {\r\n\t\t\t\tvar a_order = 10;\r\n\t\t\t\tvar b_order = 10;\r\n\t\t\t\tif(a && a.data && a.data.order != null) a_order = a.data.order;\r\n\t\t\t\tif(a && a.separator && a.order != null) a_order = a.order;\r\n\t\t\t\tif(b && b.data && b.data.order != null) b_order = b.data.order;\r\n\t\t\t\tif(b && b.separator && b.order != null) b_order = b.order;\r\n\t\t\t\treturn a_order - b_order;\r\n\t\t\t});\r\n\r\n\t\tfor(var i in sorted_entries)\r\n\t\t{\r\n\t\t\tvar item = document.createElement(\"p\");\r\n\t\t\tvar menu_item = sorted_entries[i];\r\n\r\n\t\t\titem.className = 'litemenu-entry ' + ( item.children ? \" submenu\" : \"\" );\r\n\t\t\tvar has_submenu = menu_item.children && menu_item.children.length;\r\n\r\n\t\t\tif(has_submenu)\r\n\t\t\t\titem.classList.add(\"has_submenu\");\r\n\r\n\t\t\tif(menu_item && menu_item.name)\r\n\t\t\t\titem.innerHTML = \"<span class='icon'></span><span class='name'>\" + menu_item.name + (has_submenu ? \"<span class='more'>+</span>\":\"\") + \"</span>\";\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\titem.classList.add(\"separator\");\r\n\t\t\t\t//item.innerHTML = \"<span class='separator'></span>\";\r\n\t\t\t}\r\n\r\n\t\t\titem.data = menu_item;\r\n\r\n\t\t\t//check if it has to show the item being 'checked'\r\n\t\t\tif( item.data.data )\r\n\t\t\t{\r\n\t\t\t\tvar data = item.data.data;\r\n\r\n\t\t\t\tvar checked = (data.type == \"checkbox\" && data.instance && data.property && data.instance[ data.property ] == true) || \r\n\t\t\t\t\tdata.checkbox == true ||\r\n\t\t\t\t\t(data.instance && data.property && data.hasOwnProperty(\"value\") && data.instance[data.property] == data.value) ||\r\n\t\t\t\t\t(typeof( data.isChecked ) == \"function\" && data.isChecked.call(data.instance, data) );\r\n\r\n\t\t\t\tif(checked)\r\n\t\t\t\t\titem.className += \" checked\";\r\n\r\n\t\t\t\tif(data.disabled)\r\n\t\t\t\t\titem.className += \" disabled\";\r\n\t\t\t}\r\n\r\n\t\t\t/* ON CLICK SUBMENU ITEM */\r\n\t\t\titem.addEventListener(\"click\",function(){\r\n\t\t\t\tvar item = this.data;\r\n\t\t\t\tif(item.data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(item.data.disabled)\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t//to change variables directly\r\n\t\t\t\t\tif(item.data.instance && item.data.property)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif( item.data.type == \"checkbox\" )\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\titem.data.instance[item.data.property] = !item.data.instance[item.data.property];\r\n\t\t\t\t\t\t\tif(\titem.data.instance[item.data.property] )\r\n\t\t\t\t\t\t\t\tthis.classList.add(\"checked\");\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tthis.classList.remove(\"checked\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if( item.data.hasOwnProperty(\"value\") )\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\titem.data.instance[item.data.property] = item.data.value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//to have a checkbox behaviour\r\n\t\t\t\t\tif(item.data.checkbox != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titem.data.checkbox = !item.data.checkbox;\r\n\t\t\t\t\t\tif(\titem.data.checkbox )\r\n\t\t\t\t\t\t\tthis.classList.add(\"checked\");\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tthis.classList.remove(\"checked\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//execute a function\r\n\t\t\t\t\tif(item.data.callback && typeof(item.data.callback) == \"function\")\r\n\t\t\t\t\t\titem.data.callback(item.data);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//more menus\r\n\t\t\t\tif(item.children && item.children.length)\r\n\t\t\t\t{\r\n\t\t\t\t\tthat.showMenu( item, e, this, true );\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tthat.is_open = false;\r\n\t\t\t\t\tthat.hidePanels();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\titem.addEventListener(\"mouseenter\",function(e){\r\n\t\t\t\t/*\r\n\t\t\t\tif( that.auto_open && this.classList.contains(\"has_submenu\") )\r\n\t\t\t\t\tLiteGUI.trigger( this, \"click\" );\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\r\n\t\t\telement.appendChild( item );\r\n\t\t}\r\n\r\n\t\telement.addEventListener(\"mouseleave\",function(e){\r\n\t\t\r\n\t\t\tif(that.closing_by_leave)\r\n\t\t\t\tclearInterval(that.closing_by_leave);\r\n\r\n\t\t\tthat.closing_by_leave = setTimeout( function() { \r\n\t\t\t\tthat.is_open = false;\r\n\t\t\t\tthat.hidePanels();\r\n\t\t\t},LiteGUI.Menubar.closing_time);\r\n\t\t});\r\n\r\n\t\telement.addEventListener(\"mouseenter\",function(e){\r\n\t\t\tif(that.closing_by_leave)\r\n\t\t\t\tclearInterval(that.closing_by_leave);\r\n\t\t\tthat.closing_by_leave = null;\r\n\t\t});\r\n\r\n\t\t//compute X and Y for menu\r\n\t\tvar box = root.getBoundingClientRect();\r\n\t\telement.style.left = box.left + ( is_submenu ? 200 : 0 ) + \"px\";\r\n\t\telement.style.top = box.top + box.height + ( is_submenu ? -20 : 10 ) + \"px\";\r\n\t\t/* animation, not working well, flickers\r\n\t\telement.style.opacity = \"0.1\";\r\n\t\telement.style.transform = \"translate(0,-10px)\";\r\n\t\telement.style.transition = \"all 0.2s\";\r\n\t\tsetTimeout( function(){ \r\n\t\t\telement.style.opacity = \"1\"; \r\n\t\t\telement.style.transform = \"translate(0,0)\";\r\n\t\t},1);\r\n\t\t*/\r\n\r\n\t\tthis.panels.push(element);\r\n\t\tdocument.body.appendChild( element );\r\n\t}\r\n\r\n\treturn LiteGUI.Menubar = Menubar;\r\n});"]}