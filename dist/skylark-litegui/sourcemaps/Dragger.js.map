{"version":3,"sources":["Dragger.js"],"names":["define","LiteGUI","Dragger","value","options","undefined","constructor","String","parseFloat","Number","this","precision","element","document","createElement","className","extraclass","root","wrap","full","disabled","appendChild","dragger_class","input","toFixed","units","tabIndex","tab_index","addEventListener","e","keyCode","inner_inc","stopPropagation","preventDefault","dragger","doc_binded","ownerDocument","removeEventListener","inner_move","inner_up","requestPointerLock","data","screenX","screenY","trigger","inner_wheel","diff","movementX","movementY","horizontal","activeElement","wheelDelta","deltaY","doc","exitPointerLock","v","linear","Math","pow","abs","scale","step","shiftKey","ctrlKey","max","min","prototype","setRange","setValue","skip_event","getValue"],"mappings":"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","file":"../Dragger.js","sourcesContent":["define([\r\n\t\"./litegui\"\r\n],function(LiteGUI){\r\n\r\n\r\n\t/***** DRAGGER **********/\r\n\tfunction Dragger(value, options)\r\n\t{\r\n\t\tif(value === null || value === undefined)\r\n\t\t\tvalue = 0;\r\n\t\telse if(value.constructor === String)\r\n\t\t\tvalue = parseFloat(value);\r\n\t\telse if(value.constructor !== Number)\r\n\t\t\tvalue = 0;\r\n\r\n\t\tthis.value = value;\r\n\t\tvar that = this;\r\n\t\tvar precision = options.precision != undefined ? options.precision : 3; //num decimals\r\n\r\n\t\tthis.options = options || {};\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"dragger \" + (options.extraclass ? options.extraclass : \"\");\r\n\t\tthis.root = element;\r\n\r\n\t\tvar wrap = document.createElement(\"span\");\r\n\t\twrap.className = \"inputfield \" + (options.extraclass ? options.extraclass : \"\") + (options.full ? \" full\" : \"\");\r\n\t\tif(options.disabled)\r\n\t\twrap.className += \" disabled\";\r\n\t\telement.appendChild(wrap);\r\n\r\n\t\tvar dragger_class = options.dragger_class || \"full\";\r\n\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.className = \"text number \" + (dragger_class ? dragger_class : \"\");\r\n\t\tinput.value = value.toFixed( precision ) + (options.units ? options.units : \"\");\r\n\t\tinput.tabIndex = options.tab_index;\r\n\t\tthis.input = input;\r\n\t\telement.input = input;\r\n\r\n\t\tif(options.disabled)\r\n\t\t\tinput.disabled = true;\r\n\t\tif(options.tab_index)\r\n\t\t\tinput.tabIndex = options.tab_index;\r\n\t\twrap.appendChild(input);\r\n\r\n\t\tinput.addEventListener(\"keydown\",function(e) {\r\n\t\t\tif(e.keyCode == 38)\r\n\t\t\t\tinner_inc(1,e);\r\n\t\t\telse if(e.keyCode == 40)\r\n\t\t\t\tinner_inc(-1,e);\r\n\t\t\telse\r\n\t\t\t\treturn;\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tvar dragger = document.createElement(\"div\");\r\n\t\tdragger.className = \"drag_widget\";\r\n\t\tif(options.disabled)\r\n\t\t\tdragger.className += \" disabled\";\r\n\r\n\t\twrap.appendChild(dragger);\r\n\t\telement.dragger = dragger;\r\n\r\n\t\tdragger.addEventListener(\"mousedown\",inner_down);\r\n\t\tinput.addEventListener(\"wheel\",inner_wheel,false);\r\n\t\tinput.addEventListener(\"mousewheel\",inner_wheel,false);\r\n\r\n\t\tvar doc_binded = null;\r\n\r\n\t\tfunction inner_down(e)\r\n\t\t{\r\n\t\t\tdoc_binded = input.ownerDocument;\r\n\r\n\t\t\tdoc_binded.removeEventListener(\"mousemove\", inner_move);\r\n\t\t\tdoc_binded.removeEventListener(\"mouseup\", inner_up);\r\n\r\n\t\t\tif(!options.disabled)\r\n\t\t\t{\r\n\t\t\t\tif(element.requestPointerLock)\r\n\t\t\t\t\telement.requestPointerLock();\r\n\t\t\t\tdoc_binded.addEventListener(\"mousemove\", inner_move);\r\n\t\t\t\tdoc_binded.addEventListener(\"mouseup\", inner_up);\r\n\r\n\t\t\t\tdragger.data = [e.screenX, e.screenY];\r\n\r\n\t\t\t\tLiteGUI.trigger( element,\"start_dragging\");\r\n\t\t\t}\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tfunction inner_move(e)\r\n\t\t{\r\n\t\t\tvar deltax = e.screenX - dragger.data[0];\r\n\t\t\tvar deltay = dragger.data[1] - e.screenY;\r\n\t\t\tvar diff = [ deltax, deltay ];\r\n\t\t\tif(e.movementX !== undefined)\r\n\t\t\t\tdiff = [e.movementX, -e.movementY]\r\n\t\t\t//console.log(e);\r\n\t\t\tdragger.data = [e.screenX, e.screenY];\r\n\t\t\tvar axis = options.horizontal ? 0 : 1;\r\n\t\t\tinner_inc( diff[axis], e );\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tfunction inner_wheel(e)\r\n\t\t{\r\n\t\t\t//console.log(\"wheel!\");\r\n\t\t\tif(document.activeElement !== this)\r\n\t\t\t\treturn;\r\n\t\t\tvar delta = e.wheelDelta !== undefined ? e.wheelDelta : (e.deltaY ? -e.deltaY/3 : 0);\r\n\t\t\tinner_inc( delta > 0 ? 1 : -1, e );\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tfunction inner_up(e)\r\n\t\t{\r\n\t\t\tLiteGUI.trigger(element, \"stop_dragging\");\r\n\t\t\tvar doc = doc_binded || document;\r\n\t\t\tdoc_binded = null;\r\n\t\t\tdoc.removeEventListener(\"mousemove\", inner_move);\r\n\t\t\tdoc.removeEventListener(\"mouseup\", inner_up);\r\n\t\t\tif(doc.exitPointerLock)\r\n\t\t\t\tdoc.exitPointerLock();\r\n\t\t\tLiteGUI.trigger(dragger,\"blur\");\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tfunction inner_inc(v,e)\r\n\t\t{\r\n\t\t\tif(!options.linear)\r\n\t\t\t\tv = v > 0 ? Math.pow(v,1.2) : Math.pow( Math.abs(v), 1.2) * -1;\r\n\t\t\tvar scale = (options.step ? options.step : 1.0);\r\n\t\t\tif(e && e.shiftKey)\r\n\t\t\t\tscale *= 10;\r\n\t\t\telse if(e && e.ctrlKey)\r\n\t\t\t\tscale *= 0.1;\r\n\t\t\tvar value = parseFloat( input.value ) + v * scale;\r\n\t\t\tif(options.max != null && value > options.max)\r\n\t\t\t\tvalue = options.max;\r\n\t\t\tif(options.min != null && value < options.min)\r\n\t\t\t\tvalue = options.min;\r\n\r\n\t\t\tinput.value = value.toFixed( precision );\r\n\t\t\t//input.value = ((value * 1000)<<0) / 1000; //remove ugly decimals\r\n\t\t\tif(options.units)\r\n\t\t\t\tinput.value += options.units;\r\n\t\t\tLiteGUI.trigger(input,\"change\");\r\n\t\t}\r\n\t}\r\n\r\n\tDragger.prototype.setRange = function(min,max)\r\n\t{\r\n\t\tthis.options.min = min;\r\n\t\tthis.options.max = max;\r\n\t}\r\n\r\n\tDragger.prototype.setValue = function(v, skip_event) { \r\n\t\tv = parseFloat(v);\r\n\t\tthis.value = v;\r\n\t\tif(this.options.precision)\r\n\t\t\tv = v.toFixed(this.options.precision);\r\n\t\tif(this.options.units)\r\n\t\t\tv += this.options.units;\r\n\t\tthis.input.value = v;\r\n\t\tif(!skip_event)\r\n\t\t\tLiteGUI.trigger( this.input, \"change\" );\r\n\t}\r\n\r\n\tDragger.prototype.getValue = function()\r\n\t{\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\treturn LiteGUI.Dragger = Dragger;\r\n});"]}