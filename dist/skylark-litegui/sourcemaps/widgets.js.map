{"version":3,"sources":["widgets.js"],"names":["define","LiteGUI","SearchBox","value","options","element","document","createElement","className","placeholder","innerHTML","this","input","querySelector","root","that","onchange","e","target","callback","call","ContextMenu","values","parentMenu","constructor","console","error","lock","current_submenu","event","name","style","minWidth","minHeight","pointerEvents","setTimeout","addEventListener","preventDefault","button","close","title","appendChild","i","Array","String","undefined","content","addItem","num","on_mouse_wheel","pos","parseInt","top","deltaY","toFixed","closing_timer","clearTimeout","bind","root_document","ownerDocument","body","left","warn","pageX","pageY","rect","getBoundingClientRect","width","body_rect","root_rect","height","List","id","items","item","data","dataset","list","querySelectorAll","j","length","classList","remove","add","trigger","parent","ComplexList","item_code","special_codes","tick","sizeToCSS","selected","onItemSelected","onItemToggled","onItemRemoved","Button","click","prototype","setValue","v","getValue","disabled","inner_onclick","close_parent","ignore_item_callbacks","submenu","autoopen","has_submenu","onclick_callback","ignore_parent_menu","parentNode","removeChild","isCursorOverElement","getTopMenu","getFirstEvent","ContextualMenu","Checkbox","on_change","stopPropagation","toString","old_value","createLitebox","state","on_change_callback","setEmpty","expand","collapse","getSelectedItem","setSelectedItem","Slider","setFromX","x","norm","min","range","max","skip_event","percentage","percentage2","background","onChange","doc_binded","onMouseMove","onMouseUp","doc","removeEventListener","mouseX","offsetX","offsetY","layerX","layerY","LineEditor","extraclass","bgcolor","pointscolor","linecolor","xrange","yrange","defaulty","no_trespassing","show_samples","canvas","convert","unconvert","evt","onmousemove","onmouseup","mousex","clientX","mousey","clientY","y","min_dist","dist","distance","computeSelected","push","sortValues","indexOf","last_mouse","redraw","getValueAt","last","f","resample","samples","r","dx","addValue","splice","ctx","getContext","setTransform","translate","scale","fillStyle","fillRect","strokeStyle","beginPath","moveTo","lineTo","stroke","arc","Math","PI","fill","delta","minx","maxx","a","b","sqrt","pow","sort","addTitle","text","elem","addHTML","html","on_click","clear","is_enabled","can_be_removed","createListItem",".title","display","setSelected","toggle","contains","stopImmediatePropagation","setContent","is_html","innerText","toggleEnabled","removeClass","show","hide"],"mappings":"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","file":"../widgets.js","sourcesContent":["//enclose in a scope\r\ndefine([\r\n\t\"./litegui\"\r\n],function(LiteGUI){\r\n\r\n\r\n\r\n\tfunction Button( value, options )\r\n\t{\r\n\t\toptions = options || {};\r\n\r\n\t\tif(typeof(options) === \"function\")\r\n\t\t\toptions = { callback: options };\r\n\r\n\t\tvar that = this;\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"litegui button\";\r\n\r\n\t\tthis.root = element;\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.className = \"litebutton\";\r\n\t\tthis.content = button;\r\n\t\telement.appendChild(button);\r\n\r\n\t\tbutton.innerHTML = value;\t\t\r\n\t\tbutton.addEventListener(\"click\", function(e) { \r\n\t\t\tthat.click();\r\n\t\t});\r\n\r\n\t\tthis.click = function()\r\n\t\t{\r\n\t\t\tif(options.callback)\r\n\t\t\t\toptions.callback.call(that);\r\n\t\t}\r\n\t}\r\n\r\n\tLiteGUI.Button = Button;\r\n\r\n\t/**\r\n\t* SearchBox \r\n\t*\r\n\t* @class SearchBox\r\n\t* @constructor\r\n\t* @param {*} value\r\n\t* @param {Object} options\r\n\t*/\r\n\r\n\tfunction SearchBox( value, options )\r\n\t{\r\n\t\toptions = options || {};\r\n\t\tvalue = value || \"\";\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"litegui searchbox\";\r\n\t\tvar placeholder = (options.placeholder != null ? options.placeholder : \"Search\");\r\n\t\telement.innerHTML = \"<input value='\"+value+\"' placeholder='\"+ placeholder +\"'/>\";\r\n\t\tthis.input = element.querySelector(\"input\");\r\n\t\tthis.root = element;\r\n\t\tvar that = this;\r\n\r\n\t\tthis.input.onchange = function(e) { \r\n\t\t\tvar value = e.target.value;\r\n\t\t\tif(options.callback)\r\n\t\t\t\toptions.callback.call(that,value);\r\n\t\t};\r\n\t}\r\n\r\n\tSearchBox.prototype.setValue = function(v) { this.input.value = v; this.input.onchange(); };\r\n\tSearchBox.prototype.getValue = function() { return this.input.value; };\r\n\r\n\tLiteGUI.SearchBox = SearchBox;\r\n\r\n\r\n\t/**\r\n\t* ContextMenu \r\n\t*\r\n\t* @class ContextMenu \r\n\t* @constructor\r\n\t* @param {Array} values (allows object { title: \"Nice text\", callback: function ... })\r\n\t* @param {Object} options [optional] Some options:\\\r\n\t* - title: title to show on top of the menu\r\n\t* - callback: function to call when an option is clicked, it receives the item information\r\n\t* - ignore_item_callbacks: ignores the callback inside the item, it just calls the options.callback \r\n\t* - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\r\n\t*/\r\n\tfunction ContextMenu( values, options )\r\n\t{\r\n\t\toptions = options || {};\r\n\t\tthis.options = options;\r\n\t\tvar that = this;\r\n\r\n\t\t//to link a menu with its parent\r\n\t\tif(options.parentMenu)\r\n\t\t{\r\n\t\t\tif( options.parentMenu.constructor !== this.constructor )\r\n\t\t\t{\r\n\t\t\t\tconsole.error(\"parentMenu must be of class ContextMenu, ignoring it\");\r\n\t\t\t\toptions.parentMenu = null;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.parentMenu = options.parentMenu;\r\n\t\t\t\tthis.parentMenu.lock = true;\r\n\t\t\t\tthis.parentMenu.current_submenu = this;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( options.event && options.event.constructor.name !== \"MouseEvent\" && options.event.constructor.name !== \"PointerEvent\" && options.event.constructor.name !== \"CustomEvent\" )\r\n\t\t{\r\n\t\t\tconsole.error(\"Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it.\");\r\n\t\t\toptions.event = null;\r\n\t\t}\r\n\r\n\t\tvar root = document.createElement(\"div\");\r\n\t\troot.className = \"litecontextmenu litemenubar-panel\";\r\n\t\troot.style.minWidth = 100;\r\n\t\troot.style.minHeight = 100;\r\n\t\troot.style.pointerEvents = \"none\";\r\n\t\tsetTimeout( function() { root.style.pointerEvents = \"auto\"; },100); //delay so the mouse up event is not caugh by this element\r\n\r\n\t\t//this prevents the default context browser menu to open in case this menu was created when pressing right button \r\n\t\troot.addEventListener(\"mouseup\", function(e){ \r\n\t\t\te.preventDefault(); return true; \r\n\t\t}, true);\r\n\t\troot.addEventListener(\"contextmenu\", function(e) { \r\n\t\t\tif(e.button != 2) //right button\r\n\t\t\t\treturn false;\r\n\t\t\te.preventDefault(); \r\n\t\t\treturn false;\r\n\t\t},true);\r\n\r\n\t\troot.addEventListener(\"mousedown\", function(e){ \r\n\t\t\tif(e.button == 2)\r\n\t\t\t{\r\n\t\t\t\tthat.close();\r\n\t\t\t\te.preventDefault(); return true; \r\n\t\t\t}\r\n\t\t}, true);\r\n\r\n\r\n\t\tthis.root = root;\r\n\r\n\t\t//title\r\n\t\tif(options.title)\r\n\t\t{\r\n\t\t\tvar element = document.createElement(\"div\");\r\n\t\t\telement.className = \"litemenu-title\";\r\n\t\t\telement.innerHTML = options.title;\r\n\t\t\troot.appendChild(element);\r\n\t\t}\r\n\r\n\t\t//entries\r\n\t\tvar num = 0;\r\n\t\tfor(var i in values)\r\n\t\t{\r\n\t\t\tvar name = values.constructor == Array ? values[i] : i;\r\n\t\t\tif( name != null && name.constructor !== String )\r\n\t\t\t\tname = name.content === undefined ? String(name) : name.content;\r\n\t\t\tvar value = values[i];\r\n\t\t\tthis.addItem( name, value, options );\r\n\t\t\tnum++;\r\n\t\t}\r\n\r\n\t\t//close on leave\r\n\t\troot.addEventListener(\"mouseleave\", function(e) {\r\n\t\t\tif(that.lock)\r\n\t\t\t\treturn;\r\n\t\t\tif(root.closing_timer)\r\n\t\t\t\tclearTimeout( root.closing_timer );\r\n\t\t\troot.closing_timer = setTimeout( that.close.bind(that, e), 500 );\r\n\t\t\t//that.close(e);\r\n\t\t});\r\n\r\n\t\troot.addEventListener(\"mouseenter\", function(e) {\r\n\t\t\tif(root.closing_timer)\r\n\t\t\t\tclearTimeout( root.closing_timer );\r\n\t\t});\r\n\r\n\t\tfunction on_mouse_wheel(e)\r\n\t\t{\r\n\t\t\tvar pos = parseInt( root.style.top );\r\n\t\t\troot.style.top = (pos + e.deltaY * 0.1).toFixed() + \"px\";\r\n\t\t\te.preventDefault();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\troot.addEventListener(\"wheel\", on_mouse_wheel, true);\r\n\t\troot.addEventListener(\"mousewheel\", on_mouse_wheel, true);\r\n\r\n\r\n\t\t//insert before checking position\r\n\t\tvar root_document = document;\r\n\t\tif(options.event)\r\n\t\t\troot_document = options.event.target.ownerDocument; \r\n\r\n\t\tif(!root_document)\r\n\t\t\troot_document = document;\r\n\t\troot_document.body.appendChild(root);\r\n\r\n\t\t//compute best position\r\n\t\tvar left = options.left || 0;\r\n\t\tvar top = options.top || 0;\r\n\t\tif(options.event)\r\n\t\t{\r\n\t\t\tif( options.event.constructor.name !== \"MouseEvent\" && options.event.constructor.name !== \"PointerEvent\" && options.event.constructor.name !== \"CustomEvent\" )\r\n\t\t\t{\r\n\t\t\t\tconsole.warn(\"Event passed to ContextMenu is not of type MouseEvent\");\r\n\t\t\t\toptions.event = null;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tleft = (options.event.pageX - 10);\r\n\t\t\t\ttop = (options.event.pageY - 10);\r\n\t\t\t\tif(options.title)\r\n\t\t\t\t\ttop -= 20;\r\n\r\n\t\t\t\tif(options.parentMenu)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar rect = options.parentMenu.root.getBoundingClientRect();\r\n\t\t\t\t\tleft = rect.left + rect.width;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar body_rect = document.body.getBoundingClientRect();\r\n\t\t\t\tvar root_rect = root.getBoundingClientRect();\r\n\r\n\t\t\t\tif(left > (body_rect.width - root_rect.width - 10))\r\n\t\t\t\t\tleft = (body_rect.width - root_rect.width - 10);\r\n\t\t\t\tif(top > (body_rect.height - root_rect.height - 10))\r\n\t\t\t\t\ttop = (body_rect.height - root_rect.height - 10);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\troot.style.left = left + \"px\";\r\n\t\troot.style.top = top  + \"px\";\r\n\t}\r\n\r\n\tContextMenu.prototype.addItem = function( name, value, options )\r\n\t{\r\n\t\tvar that = this;\r\n\t\toptions = options || {};\r\n\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"litemenu-entry submenu\";\r\n\r\n\t\tvar disabled = false;\r\n\r\n\t\tif(value === null)\r\n\t\t{\r\n\t\t\telement.classList.add(\"separator\");\r\n\t\t\t//element.innerHTML = \"<hr/>\"\r\n\t\t\t//continue;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\telement.innerHTML = value && value.title ? value.title : name;\r\n\t\t\telement.value = value;\r\n\r\n\t\t\tif(value)\r\n\t\t\t{\r\n\t\t\t\tif(value.disabled)\r\n\t\t\t\t{\r\n\t\t\t\t\tdisabled = true;\r\n\t\t\t\t\telement.classList.add(\"disabled\");\r\n\t\t\t\t}\r\n\t\t\t\tif(value.submenu || value.has_submenu)\r\n\t\t\t\t\telement.classList.add(\"has_submenu\");\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof(value) == \"function\")\r\n\t\t\t{\r\n\t\t\t\telement.dataset[\"value\"] = name;\r\n\t\t\t\telement.onclick_callback = value;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\telement.dataset[\"value\"] = value;\r\n\t\t}\r\n\r\n\t\tthis.root.appendChild(element);\r\n\t\tif(!disabled)\r\n\t\t\telement.addEventListener(\"click\", inner_onclick);\r\n\t\tif(options.autoopen)\r\n\t\t\telement.addEventListener(\"mouseenter\", inner_over);\r\n\r\n\t\tfunction inner_over(e)\r\n\t\t{\r\n\t\t\tvar value = this.value;\r\n\t\t\tif(!value || !value.has_submenu)\r\n\t\t\t\treturn;\r\n\t\t\tinner_onclick.call(this,e);\r\n\t\t}\r\n\r\n\t\t//menu option clicked\r\n\t\tfunction inner_onclick(e) {\r\n\t\t\tvar value = this.value;\r\n\t\t\tvar close_parent = true;\r\n\r\n\t\t\tif(that.current_submenu)\r\n\t\t\t\tthat.current_submenu.close(e);\r\n\r\n\t\t\t//global callback\r\n\t\t\tif(options.callback) \r\n\t\t\t{\r\n\t\t\t\tvar r = options.callback.call(that, value, options, e );\r\n\t\t\t\tif(r === true)\r\n\t\t\t\t\tclose_parent = false;\r\n\t\t\t}\r\n\r\n\t\t\t//special cases\r\n\t\t\tif(value)\r\n\t\t\t{\r\n\t\t\t\tif (value.callback && !options.ignore_item_callbacks && value.disabled !== true )  //item callback\r\n\t\t\t\t{\r\n\t\t\t\t\tvar r = value.callback.call( this, value, options, e, that );\r\n\t\t\t\t\tif(r === true)\r\n\t\t\t\t\t\tclose_parent = false;\r\n\t\t\t\t}\r\n\t\t\t\tif(value.submenu)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(!value.submenu.options)\r\n\t\t\t\t\t\tthrow(\"ContextMenu submenu needs options\");\r\n\t\t\t\t\tvar submenu = new LiteGUI.ContextMenu( value.submenu.options, {\r\n\t\t\t\t\t\tcallback: value.submenu.callback,\r\n\t\t\t\t\t\tevent: e,\r\n\t\t\t\t\t\tparentMenu: that,\r\n\t\t\t\t\t\tignore_item_callbacks: value.submenu.ignore_item_callbacks,\r\n\t\t\t\t\t\ttitle: value.submenu.title,\r\n\t\t\t\t\t\tautoopen: options.autoopen\r\n\t\t\t\t\t});\r\n\t\t\t\t\tclose_parent = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\tif(close_parent && !that.lock)\r\n\t\t\t\tthat.close();\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tContextMenu.prototype.close = function(e, ignore_parent_menu)\r\n\t{\r\n\t\tif(this.root.parentNode)\r\n\t\t\tthis.root.parentNode.removeChild( this.root );\r\n\t\tif(this.parentMenu && !ignore_parent_menu)\r\n\t\t{\r\n\t\t\tthis.parentMenu.lock = false;\r\n\t\t\tthis.parentMenu.current_submenu = null;\r\n\t\t\tif( e === undefined )\r\n\t\t\t\tthis.parentMenu.close();\r\n\t\t\telse if( e && !LiteGUI.isCursorOverElement( e, this.parentMenu.root) )\r\n\t\t\t\tLiteGUI.trigger( this.parentMenu.root, \"mouseleave\", e );\r\n\t\t}\r\n\t\tif(this.current_submenu)\r\n\t\t\tthis.current_submenu.close(e, true);\r\n\t\tif(this.root.closing_timer)\r\n\t\t\tclearTimeout( this.root.closing_timer );\r\n\t}\r\n\r\n\t//returns the top most menu\r\n\tContextMenu.prototype.getTopMenu = function()\r\n\t{\r\n\t\tif( this.options.parentMenu )\r\n\t\t\treturn this.options.parentMenu.getTopMenu();\r\n\t\treturn this;\r\n\t}\r\n\r\n\tContextMenu.prototype.getFirstEvent = function()\r\n\t{\r\n\t\tif( this.options.parentMenu )\r\n\t\t\treturn this.options.parentMenu.getFirstEvent();\r\n\t\treturn this.options.event;\r\n\t}\r\n\r\n\tLiteGUI.ContextMenu = ContextMenu;\r\n\tLiteGUI.ContextualMenu = ContextMenu; //LEGACY: REMOVE\r\n\r\n\r\n\tfunction Checkbox( value, on_change)\r\n\t{\r\n\t\tvar that = this;\r\n\t\tthis.value = value;\r\n\r\n\t\tvar root = this.root = document.createElement(\"span\");\r\n\t\troot.className = \"litecheckbox inputfield\";\r\n\t\troot.dataset[\"value\"] = value;\r\n\r\n\t\tvar element = this.element = document.createElement(\"span\");\r\n\t\telement.className = \"fixed flag checkbox \"+(value ? \"on\" : \"off\");\r\n\t\troot.appendChild( element );\r\n\t\t\r\n\t\troot.addEventListener(\"click\", onClick.bind(this) );\r\n\r\n\t\tfunction onClick(e) {\r\n\t\t\tthis.setValue( this.root.dataset[\"value\"] != \"true\" );\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\tthis.setValue = function(v)\r\n\t\t{\r\n\t\t\tif(this.value === v)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif( this.root.dataset[\"value\"] == v.toString())\r\n\t\t\t\treturn;\r\n\r\n\t\t\tthis.root.dataset[\"value\"] = v;\r\n\t\t\tif(v)\r\n\t\t\t{\r\n\t\t\t\tthis.element.classList.remove(\"off\");\r\n\t\t\t\tthis.element.classList.add(\"on\");\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.element.classList.remove(\"on\");\r\n\t\t\t\tthis.element.classList.add(\"off\");\r\n\t\t\t}\r\n\t\t\tvar old_value = this.value;\r\n\t\t\tthis.value = v;\r\n\r\n\t\t\tif(on_change)\r\n\t\t\t\ton_change( v, old_value );\r\n\t\t}\r\n\r\n\t\tthis.getValue = function()\r\n\t\t{\r\n\t\t\treturn this.value;\r\n\t\t\t//return this.root.dataset[\"value\"] == \"true\";\r\n\t\t}\r\n\t}\t\r\n\r\n\tLiteGUI.Checkbox = Checkbox;\r\n\r\n\r\n\t//the tiny box to expand the children of a node\r\n\tfunction createLitebox(state, on_change)\r\n\t{\r\n\t\tvar element = document.createElement(\"span\");\r\n\t\telement.className = \"listbox \" + (state ? \"listopen\" : \"listclosed\");\r\n\t\telement.innerHTML = state ? \"&#9660;\" : \"&#9658;\";\r\n\t\telement.dataset[\"value\"] = state ? \"open\" : \"closed\";\r\n\t\telement.addEventListener(\"click\", onClick );\r\n\t\telement.on_change_callback = on_change;\r\n\r\n\t\telement.setEmpty = function(v)\r\n\t\t{\r\n\t\t\tif(v)\r\n\t\t\t\tthis.classList.add(\"empty\");\r\n\t\t\telse\r\n\t\t\t\tthis.classList.remove(\"empty\");\r\n\t\t}\r\n\r\n\t\telement.expand = function()\r\n\t\t{\r\n\t\t\tthis.setValue(true);\r\n\t\t}\r\n\r\n\t\telement.collapse = function()\r\n\t\t{\r\n\t\t\tthis.setValue(false);\r\n\t\t}\r\n\r\n\t\telement.setValue = function(v)\r\n\t\t{\r\n\t\t\tif(this.dataset[\"value\"] == (v ? \"open\" : \"closed\"))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif(!v)\r\n\t\t\t{\r\n\t\t\t\tthis.dataset[\"value\"] = \"closed\";\r\n\t\t\t\tthis.innerHTML = \"&#9658;\";\r\n\t\t\t\tthis.classList.remove(\"listopen\");\r\n\t\t\t\tthis.classList.add(\"listclosed\");\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.dataset[\"value\"] = \"open\";\r\n\t\t\t\tthis.innerHTML = \"&#9660;\";\r\n\t\t\t\tthis.classList.add(\"listopen\");\r\n\t\t\t\tthis.classList.remove(\"listclosed\");\r\n\t\t\t}\r\n\r\n\t\t\tif(on_change)\r\n\t\t\t\ton_change( this.dataset[\"value\"] );\r\n\t\t}\r\n\r\n\t\telement.getValue = function()\r\n\t\t{\r\n\t\t\treturn this.dataset[\"value\"];\r\n\t\t}\r\n\r\n\t\tfunction onClick(e) {\r\n\t\t\t//console.log(\"CLICK\");\r\n\t\t\tvar box = e.target;\r\n\t\t\tbox.setValue( this.dataset[\"value\"] == \"open\" ? false : true );\r\n\t\t\tif(this.stopPropagation)\r\n\t\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\t\r\n\r\n\tLiteGUI.createLitebox = createLitebox;\r\n\r\n\t/**\r\n\t* List \r\n\t*\r\n\t* @class List\r\n\t* @constructor\r\n\t* @param {String} id\r\n\t* @param {Array} values\r\n\t* @param {Object} options\r\n\t*/\r\n\tfunction List( id, items, options )\r\n\t{\r\n\t\toptions = options || {};\r\n\r\n\t\tvar root = this.root = document.createElement(\"ul\");\r\n\t\troot.id = id;\r\n\t\troot.className = \"litelist\";\r\n\t\tthis.items = [];\r\n\t\tvar that = this;\r\n\r\n\t\tthis.callback = options.callback;\r\n\r\n\t\t//walk over every item in the list\r\n\t\tfor(var i in items)\r\n\t\t{\r\n\t\t\tvar item = document.createElement(\"li\");\r\n\t\t\titem.className = \"list-item\";\r\n\t\t\titem.data = items[i];\r\n\t\t\titem.dataset[\"value\"] = items[i];\r\n\r\n\t\t\tvar content = \"\";\r\n\t\t\tif(typeof(items[i]) == \"string\")\r\n\t\t\t\tcontent = items[i] + \"<span class='arrow'></span>\";\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcontent = (items[i].name || items[i].title || \"\") + \"<span class='arrow'></span>\";\r\n\t\t\t\tif(items[i].id)\r\n\t\t\t\t\titem.id = items[i].id;\r\n\t\t\t}\r\n\t\t\titem.innerHTML = content;\r\n\r\n\t\t\titem.addEventListener(\"click\", function() {\r\n\r\n\t\t\t\tvar list = root.querySelectorAll(\".list-item.selected\");\r\n\t\t\t\tfor(var j = 0; j < list.length; ++j)\r\n\t\t\t\t\tlist[j].classList.remove(\"selected\");\r\n\t\t\t\tthis.classList.add(\"selected\");\r\n\t\t\t\tLiteGUI.trigger( that.root, \"wchanged\", this );\r\n\t\t\t\tif(that.callback)\r\n\t\t\t\t\tthat.callback( this.data  );\r\n\t\t\t});\r\n\r\n\t\t\troot.appendChild(item);\r\n\t\t}\r\n\r\n\r\n\t\tif(options.parent)\r\n\t\t{\r\n\t\t\tif(options.parent.root)\r\n\t\t\t\toptions.parent.root.appendChild( root );\r\n\t\t\telse\r\n\t\t\t\toptions.parent.appendChild( root );\r\n\t\t}\r\n\t}\r\n\r\n\tList.prototype.getSelectedItem = function()\r\n\t{\r\n\t\treturn this.root.querySelector(\".list-item.selected\");\r\n\t}\r\n\r\n\tList.prototype.setSelectedItem = function( name )\r\n\t{\r\n\t\tvar items = this.root.querySelectorAll(\".list-item\");\r\n\t\tfor(var i = 0; i < items.length; i++)\r\n\t\t{\r\n\t\t\tvar item = items[i];\r\n\t\t\tif(item.data == name)\r\n\t\t\t{\r\n\t\t\t\tLiteGUI.trigger( item, \"click\" );\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tLiteGUI.List = List;\r\n\r\n\t/**\r\n\t* Slider \r\n\t*\r\n\t* @class Slider\r\n\t* @constructor\r\n\t* @param {Number} value\r\n\t* @param {Object} options\r\n\t*/\r\n\tfunction Slider(value, options)\r\n\t{\r\n\t\toptions = options || {};\r\n\t\tvar root = this.root = document.createElement(\"div\");\r\n\t\tvar that = this;\r\n\t\tthis.value = value;\r\n\t\troot.className = \"liteslider\";\r\n\r\n\t\tthis.setValue = function(value, skip_event)\r\n\t\t{\r\n\t\t\t//var width = canvas.getClientRects()[0].width;\r\n\t\t\tvar min = options.min || 0.0;\r\n\t\t\tvar max = options.max || 1.0;\r\n\t\t\tif(value < min) value = min;\r\n\t\t\telse if(value > max) value = max;\r\n\t\t\tvar range = max - min;\r\n\t\t\tvar norm = (value - min) / range;\r\n\t\t\tvar percentage = (norm*100).toFixed(1) + \"%\";\r\n\t\t\tvar percentage2 = (norm*100+2).toFixed(1) + \"%\";\r\n\t\t\troot.style.background = \"linear-gradient(to right, #999 \" + percentage + \", #FC0 \"+percentage2+\", #333 \" + percentage2 + \")\";\r\n\r\n\t\t\tif(value != this.value)\r\n\t\t\t{\r\n\t\t\t\tthis.value = value;\r\n\t\t\t\tif(!skip_event)\r\n\t\t\t\t{\r\n\t\t\t\t\tLiteGUI.trigger(this.root, \"change\", value );\r\n\t\t\t\t\tif(this.onChange)\r\n\t\t\t\t\t\tthis.onChange( value );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction setFromX(x)\r\n\t\t{\r\n\t\t\tvar rect = root.getBoundingClientRect();\r\n\t\t\tif(!rect)\r\n\t\t\t\treturn;\r\n\t\t\tvar width = rect.width;\r\n\t\t\tvar norm = x / width;\r\n\t\t\tvar min = options.min || 0.0;\r\n\t\t\tvar max = options.max || 1.0;\r\n\t\t\tvar range = max - min;\r\n\t\t\tthat.setValue( range * norm + min );\r\n\t\t}\r\n\r\n\t\tvar doc_binded = null;\r\n\r\n\t\troot.addEventListener(\"mousedown\", function(e) {\r\n\t\t\tvar mouseX, mouseY;\r\n\t\t\tif(e.offsetX) { mouseX = e.offsetX; mouseY = e.offsetY; }\r\n\t\t\telse if(e.layerX) { mouseX = e.layerX; mouseY = e.layerY; }\t\r\n\t\t\tsetFromX(mouseX);\r\n\t\t\tdoc_binded = root.ownerDocument;\r\n\t\t\tdoc_binded.addEventListener(\"mousemove\", onMouseMove );\r\n\t\t\tdoc_binded.addEventListener(\"mouseup\", onMouseUp );\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\r\n\t\tfunction onMouseMove(e)\r\n\t\t{\r\n\t\t\tvar rect = root.getBoundingClientRect();\r\n\t\t\tif(!rect)\r\n\t\t\t\treturn;\r\n\t\t\tvar x = e.x === undefined ? e.pageX : e.x;\r\n\t\t\tvar mouseX = x - rect.left;\r\n\t\t\tsetFromX(mouseX);\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfunction onMouseUp(e)\r\n\t\t{\r\n\t\t\tvar doc = doc_binded || document;\r\n\t\t\tdoc_binded = null;\r\n\t\t\tdoc.removeEventListener(\"mousemove\", onMouseMove );\r\n\t\t\tdoc.removeEventListener(\"mouseup\", onMouseUp );\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.setValue(value);\r\n\t}\r\n\r\n\tLiteGUI.Slider = Slider;\r\n\r\n\t/**\r\n\t* LineEditor \r\n\t*\r\n\t* @class LineEditor\r\n\t* @constructor\r\n\t* @param {Number} value\r\n\t* @param {Object} options\r\n\t*/\r\n\r\n\tfunction LineEditor(value, options)\r\n\t{\r\n\t\toptions = options || {};\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.className = \"curve \" + (options.extraclass ? options.extraclass : \"\");\r\n\t\telement.style.minHeight = \"50px\";\r\n\t\telement.style.width = options.width || \"100%\";\r\n\r\n\t\telement.bgcolor = options.bgcolor || \"#222\";\r\n\t\telement.pointscolor = options.pointscolor || \"#5AF\";\r\n\t\telement.linecolor = options.linecolor || \"#444\";\r\n\r\n\t\telement.value = value || [];\r\n\t\telement.xrange = options.xrange || [0,1]; //min,max\r\n\t\telement.yrange = options.yrange || [0,1]; //min,max\r\n\t\telement.defaulty = options.defaulty != null ? options.defaulty : 0.5;\r\n\t\telement.no_trespassing = options.no_trespassing || false;\r\n\t\telement.show_samples = options.show_samples || 0;\r\n\t\telement.options = options;\r\n\t\telement.style.minWidth = \"50px\";\r\n\t\telement.style.minHeight = \"20px\";\r\n\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tcanvas.width = options.width || 200;\r\n\t\tcanvas.height = options.height || 50;\r\n\t\telement.appendChild( canvas );\r\n\t\telement.canvas = canvas;\r\n\r\n\t\telement.addEventListener(\"mousedown\",onmousedown);\r\n\r\n\t\telement.getValueAt = function(x)\r\n\t\t{\r\n\t\t\tif(x < element.xrange[0] || x > element.xrange[1])\r\n\t\t\t\treturn element.defaulty;\r\n\r\n\t\t\tvar last = [ element.xrange[0], element.defaulty ];\r\n\t\t\tvar f = 0;\r\n\t\t\tfor(var i = 0; i < element.value.length; i += 1)\r\n\t\t\t{\r\n\t\t\t\tvar v = element.value[i];\r\n\t\t\t\tif(x == v[0]) return v[1];\r\n\t\t\t\tif(x < v[0])\r\n\t\t\t\t{\r\n\t\t\t\t\tf = (x - last[0]) / (v[0] - last[0]);\r\n\t\t\t\t\treturn last[1] * (1-f) + v[1] * f;\r\n\t\t\t\t}\r\n\t\t\t\tlast = v;\r\n\t\t\t}\r\n\r\n\t\t\tv = [ element.xrange[1], element.defaulty ];\r\n\t\t\tf = (x - last[0]) / (v[0] - last[0]);\r\n\t\t\treturn last[1] * (1-f) + v[1] * f;\r\n\t\t}\r\n\r\n\t\telement.resample = function(samples)\r\n\t\t{\r\n\t\t\tvar r = [];\r\n\t\t\tvar dx = (element.xrange[1] - element.xrange[0]) / samples;\r\n\t\t\tfor(var i = element.xrange[0]; i <= element.xrange[1]; i += dx)\r\n\t\t\t{\r\n\t\t\t\tr.push( element.getValueAt(i) );\r\n\t\t\t}\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\telement.addValue = function(v)\r\n\t\t{\r\n\t\t\tfor(var i = 0; i < element.value; i++)\r\n\t\t\t{\r\n\t\t\t\tvar value = element.value[i];\r\n\t\t\t\tif(value[0] < v[0]) continue;\r\n\t\t\t\telement.value.splice(i,0,v);\r\n\t\t\t\tredraw();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\telement.value.push(v);\r\n\t\t\tredraw();\r\n\t\t}\r\n\r\n\t\t//value to canvas\r\n\t\tfunction convert(v)\r\n\t\t{\r\n\t\t\treturn [ canvas.width * ( (element.xrange[1] - element.xrange[0]) * v[0] + element.xrange[0]),\r\n\t\t\t\tcanvas.height * ((element.yrange[1] - element.yrange[0]) * v[1] + element.yrange[0])];\r\n\t\t}\r\n\r\n\t\t//canvas to value\r\n\t\tfunction unconvert(v)\r\n\t\t{\r\n\t\t\treturn [(v[0] / canvas.width - element.xrange[0]) / (element.xrange[1] - element.xrange[0]),\r\n\t\t\t\t\t(v[1] / canvas.height - element.yrange[0]) / (element.yrange[1] - element.yrange[0])];\r\n\t\t}\r\n\r\n\t\tvar selected = -1;\r\n\r\n\t\telement.redraw = function()\r\n\t\t{\r\n\t\t\tvar rect = canvas.parentNode.getBoundingClientRect();\r\n\t\t\tif(rect && canvas.width != rect.width && rect.width && rect.width < 1000)\r\n\t\t\t\tcanvas.width = rect.width;\r\n\t\t\tif(rect && canvas.height != rect.height && rect.height && rect.height < 1000)\r\n\t\t\t\tcanvas.height = rect.height;\r\n\r\n\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\tctx.translate(0,canvas.height);\r\n\t\t\tctx.scale(1,-1);\r\n\r\n\t\t\tctx.fillStyle = element.bgcolor;\r\n\t\t\tctx.fillRect(0,0,canvas.width,canvas.height);\r\n\r\n\t\t\tctx.strokeStyle = element.linecolor;\r\n\t\t\tctx.beginPath();\r\n\r\n\t\t\t//draw line\r\n\t\t\tvar pos = convert([element.xrange[0],element.defaulty]);\r\n\t\t\tctx.moveTo( pos[0], pos[1] );\r\n\r\n\t\t\tfor(var i in element.value)\r\n\t\t\t{\r\n\t\t\t\tvar value = element.value[i];\r\n\t\t\t\tpos = convert(value);\r\n\t\t\t\tctx.lineTo( pos[0], pos[1] );\r\n\t\t\t}\r\n\r\n\t\t\tpos = convert([element.xrange[1],element.defaulty]);\r\n\t\t\tctx.lineTo( pos[0], pos[1] );\r\n\t\t\tctx.stroke();\r\n\r\n\t\t\t//draw points\r\n\t\t\tfor(var i = 0; i < element.value.length; i += 1)\r\n\t\t\t{\r\n\t\t\t\tvar value = element.value[i];\r\n\t\t\t\tpos = convert(value);\r\n\t\t\t\tif(selected == i)\r\n\t\t\t\t\tctx.fillStyle = \"white\";\r\n\t\t\t\telse\r\n\t\t\t\t\tctx.fillStyle = element.pointscolor;\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.arc( pos[0], pos[1], selected == i ? 4 : 2, 0, Math.PI * 2);\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\r\n\t\t\tif(element.show_samples)\r\n\t\t\t{\r\n\t\t\t\tvar samples = element.resample(element.show_samples);\r\n\t\t\t\tctx.fillStyle = \"#888\";\r\n\t\t\t\tfor(var i = 0; i < samples.length; i += 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar value = [ i * ((element.xrange[1] - element.xrange[0]) / element.show_samples) + element.xrange[0], samples[i] ];\r\n\t\t\t\t\tpos = convert(value);\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.arc( pos[0], pos[1], 2, 0, Math.PI * 2);\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar last_mouse = [0,0];\r\n\t\tfunction onmousedown(evt)\r\n\t\t{\r\n\t\t\tdocument.addEventListener(\"mousemove\",onmousemove);\r\n\t\t\tdocument.addEventListener(\"mouseup\",onmouseup);\r\n\r\n\t\t\tvar rect = canvas.getBoundingClientRect();\r\n\t\t\tvar mousex = evt.clientX - rect.left;\r\n\t\t\tvar mousey = evt.clientY - rect.top;\r\n\r\n\t\t\tselected = computeSelected(mousex,canvas.height-mousey);\r\n\r\n\t\t\tif(selected == -1)\r\n\t\t\t{\r\n\t\t\t\tvar v = unconvert([mousex,canvas.height-mousey]);\r\n\t\t\t\telement.value.push(v);\r\n\t\t\t\tsortValues();\r\n\t\t\t\tselected = element.value.indexOf(v);\r\n\t\t\t}\r\n\r\n\t\t\tlast_mouse = [mousex,mousey];\r\n\t\t\telement.redraw();\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\r\n\t\tfunction onmousemove(evt)\r\n\t\t{\r\n\t\t\tvar rect = canvas.getBoundingClientRect();\r\n\t\t\tvar mousex = evt.clientX - rect.left;\r\n\t\t\tvar mousey = evt.clientY - rect.top;\r\n\r\n\t\t\tif(mousex < 0) mousex = 0;\r\n\t\t\telse if(mousex > canvas.width) mousex = canvas.width;\r\n\t\t\tif(mousey < 0) mousey = 0;\r\n\t\t\telse if(mousey > canvas.height) mousey = canvas.height;\r\n\r\n\t\t\t//dragging to remove\r\n\t\t\tif( selected != -1 && distance( [evt.clientX - rect.left, evt.clientY - rect.top], [mousex,mousey] ) > canvas.height * 0.5 )\r\n\t\t\t{\r\n\t\t\t\telement.value.splice(selected,1);\r\n\t\t\t\tonmouseup(evt);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar dx = last_mouse[0] - mousex;\r\n\t\t\tvar dy = last_mouse[1] - mousey;\r\n\t\t\tvar delta = unconvert([-dx,dy]);\r\n\t\t\tif(selected != -1)\r\n\t\t\t{\r\n\t\t\t\tvar minx = element.xrange[0];\r\n\t\t\t\tvar maxx = element.xrange[1];\r\n\r\n\t\t\t\tif(element.no_trespassing)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(selected > 0) minx = element.value[selected-1][0];\r\n\t\t\t\t\tif(selected < (element.value.length-1) ) maxx = element.value[selected+1][0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar v = element.value[selected];\r\n\t\t\t\tv[0] += delta[0];\r\n\t\t\t\tv[1] += delta[1];\r\n\t\t\t\tif(v[0] < minx) v[0] = minx;\r\n\t\t\t\telse if(v[0] > maxx) v[0] = maxx;\r\n\t\t\t\tif(v[1] < element.yrange[0]) v[1] = element.yrange[0];\r\n\t\t\t\telse if(v[1] > element.yrange[1]) v[1] = element.yrange[1];\r\n\t\t\t}\r\n\r\n\t\t\tsortValues();\r\n\t\t\telement.redraw();\r\n\t\t\tlast_mouse[0] = mousex;\r\n\t\t\tlast_mouse[1] = mousey;\r\n\t\t\tonchange();\r\n\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\r\n\t\tfunction onmouseup(evt)\r\n\t\t{\r\n\t\t\tselected = -1;\r\n\t\t\telement.redraw();\r\n\t\t\tdocument.removeEventListener(\"mousemove\",onmousemove);\r\n\t\t\tdocument.removeEventListener(\"mouseup\",onmouseup);\r\n\t\t\tonchange();\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\r\n\t\tfunction onresize(e)\r\n\t\t{\r\n\t\t\telement.redraw();\r\n\t\t}\r\n\t\t\r\n\t\tfunction onchange()\r\n\t\t{\r\n\t\t\tif(options.callback)\r\n\t\t\t\toptions.callback.call(element,element.value);\r\n\t\t\telse\r\n\t\t\t\tLiteGUI.trigger(element,\"change\");\r\n\t\t}\r\n\r\n\t\tfunction distance(a,b) { return Math.sqrt( Math.pow(b[0]-a[0],2) + Math.pow(b[1]-a[1],2) ); };\r\n\r\n\t\tfunction computeSelected(x,y)\r\n\t\t{\r\n\t\t\tvar min_dist = 100000;\r\n\t\t\tvar max_dist = 8; //pixels\r\n\t\t\tvar selected = -1;\r\n\t\t\tfor(var i=0; i < element.value.length; i++)\r\n\t\t\t{\r\n\t\t\t\tvar value = element.value[i];\r\n\t\t\t\tvar pos = convert(value);\r\n\t\t\t\tvar dist = distance([x,y],pos);\r\n\t\t\t\tif(dist < min_dist && dist < max_dist)\r\n\t\t\t\t{\r\n\t\t\t\t\tmin_dist = dist;\r\n\t\t\t\t\tselected = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn selected;\r\n\t\t}\r\n\r\n\t\tfunction sortValues()\r\n\t\t{\r\n\t\t\tvar v = null;\r\n\t\t\tif(selected != -1)\r\n\t\t\t\tv = element.value[selected];\r\n\t\t\telement.value.sort(function(a,b) { return a[0] - b[0]; });\r\n\t\t\tif(v)\r\n\t\t\t\tselected = element.value.indexOf(v);\r\n\t\t}\r\n\t\t\r\n\t\telement.redraw();\r\n\t\treturn element;\r\n\t}\r\n\r\n\tLiteGUI.LineEditor = LineEditor;\r\n\r\n\r\n\tfunction ComplexList( options )\r\n\t{\r\n\t\toptions = options || {};\r\n\r\n\t\tthis.root = document.createElement(\"div\");\r\n\t\tthis.root.className = \"litecomplexlist\";\r\n\r\n\t\tthis.item_code = options.item_code || \"<div class='listitem'><span class='tick'><span>\"+LiteGUI.special_codes.tick+\"</span></span><span class='title'></span><button class='trash'>\"+LiteGUI.special_codes.close+\"</button></div>\";\r\n\r\n\t\tif(options.height)\r\n\t\t\tthis.root.style.height = LiteGUI.sizeToCSS( options.height );\r\n\r\n\t\tthis.selected = null;\r\n\t\tthis.onItemSelected = null;\r\n\t\tthis.onItemToggled = null;\r\n\t\tthis.onItemRemoved = null;\r\n\t}\r\n\r\n\tComplexList.prototype.addTitle = function( text )\r\n\t{\r\n\t\tvar elem = LiteGUI.createElement(\"div\",\".listtitle\",text);\r\n\t\tthis.root.appendChild( elem );\r\n\t\treturn elem;\r\n\t}\r\n\r\n\tComplexList.prototype.addHTML = function( html, on_click )\r\n\t{\r\n\t\tvar elem = LiteGUI.createElement(\"div\",\".listtext\", html );\r\n\t\tif(on_click)\r\n\t\t\telem.addEventListener(\"mousedown\", on_click);\r\n\t\tthis.root.appendChild( elem );\r\n\t\treturn elem;\r\n\t}\r\n\r\n\tComplexList.prototype.clear = function()\r\n\t{\r\n\t\tthis.root.innerHTML = \"\";\r\n\t}\r\n\r\n\tComplexList.prototype.addItem = function( item, text, is_enabled, can_be_removed )\r\n\t{\r\n\t\tvar title = text || item.content || item.name;\r\n\t\tvar elem = LiteGUI.createListItem( this.item_code, { \".title\": title } );\r\n\t\telem.item = item;\r\n\r\n\t\tif(is_enabled)\r\n\t\t\telem.classList.add(\"enabled\");\r\n\r\n\t\tif(!can_be_removed)\r\n\t\t\telem.querySelector(\".trash\").style.display = \"none\";\r\n\r\n\t\tvar that = this;\r\n\t\telem.addEventListener(\"mousedown\", function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.setSelected(true);\r\n\t\t\tif(that.onItemSelected)\r\n\t\t\t\tthat.onItemSelected( item, elem );\r\n\t\t});\r\n\t\telem.querySelector(\".tick\").addEventListener(\"mousedown\",  function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\telem.classList.toggle(\"enabled\");\r\n\t\t\tif(that.onItemToggled)\r\n\t\t\t\tthat.onItemToggled( item, elem, elem.classList.contains(\"enabled\"));\r\n\t\t});\r\n\r\n\t\telem.querySelector(\".trash\").addEventListener(\"mousedown\",function(e){\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\tif(that.onItemRemoved)\r\n\t\t\t\tthat.onItemRemoved( item, elem );\r\n\t\t});\r\n\r\n\t\telem.setContent = function(v, is_html){\r\n\t\t\tif(is_html)\r\n\t\t\t\telem.querySelector(\".title\").innerHTML = v;\r\n\t\t\telse\r\n\t\t\t\telem.querySelector(\".title\").innerText = v;\r\n\t\t}\r\n\r\n\t\telem.toggleEnabled = function(v){\r\n\t\t\telem.classList.toggle(\"enabled\");\r\n\t\t}\r\n\r\n\t\telem.setSelected = function(v)\r\n\t\t{\r\n\t\t\tLiteGUI.removeClass( that.root, \"selected\" );\r\n\t\t\tif(v)\r\n\t\t\t\tthis.classList.add(\"selected\");\r\n\t\t\telse\r\n\t\t\t\tthis.classList.remove(\"selected\");\r\n\t\t\tthat.selected = elem.item;\r\n\t\t}\r\n\r\n\t\telem.show = function() { this.style.display = \"\"; }\r\n\t\telem.hide = function() { this.style.display = \"none\"; }\r\n\r\n\t\tthis.root.appendChild( elem );\r\n\t\treturn elem;\r\n\t}\r\n\r\n\tLiteGUI.ComplexList = ComplexList;\r\n\r\n\treturn LiteGUI;\r\n});"]}