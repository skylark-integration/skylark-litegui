/**
 * skylark-litegui - A version of litegui.js  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-litegui/
 * @license MIT
 */
define(["./litegui"],function(e){function t(e,t){t=t||{},this.menu=[],this.panels=[],this.root=document.createElement("div"),this.root.id=e,this.root.className="litemenubar",this.content=document.createElement("ul"),this.root.appendChild(this.content),this.is_open=!1,this.auto_open=t.auto_open||!1,this.sort_entries=t.sort_entries||!1}return t.closing_time=500,t.prototype.clear=function(){this.content.innerHTML="",this.menu=[],this.panels=[]},t.prototype.attachToPanel=function(e){e.content.insertBefore(this.root,e.content.firstChild)},t.prototype.add=function(e,t){"function"==typeof(t=t||{})&&(t={callback:t});for(var n=this.menu.length,a=e.split("/"),i=0,s=0,r=this.menu,o=null;r;){if(i>5)throw"Error: Menubar too deep";if(r.length!=s){if(r[s]&&a[i]==r[s].name){if(i<a.length-1){o=r[s],r=r[s].children,s=0,i++;continue}console.warn("Warning: Adding menu that already exists: "+e);break}s++}else{var l={parent:o,children:[]};if(o=l,i==a.length-1&&(l.data=t),l.disable=function(){this.data&&(this.data.disabled=!0)},l.enable=function(){this.data&&delete this.data.disabled},l.name=a[i],r.push(l),++i==a.length)break;l.children=[],r=l.children,s=0}}n!=this.menu.length&&this.updateMenu()},t.prototype.remove=function(e){var t=this.findMenu(e);if(t){if(!t.parent||!t.parent.children)return console.warn("menu without parent?");var n=t.parent.children.indexOf(t);-1!=n&&t.parent.children.splice(n,1)}},t.prototype.separator=function(e,t){var n=this.findMenu(e);n&&n.children.push({separator:!0,order:t||10})},t.prototype.findMenu=function(e){for(var t=e.split("/"),n=0,a=0,i=this.menu;i;){if(n==t.length)return i;if(i.length<=a)return null;if("*"==t[n])return i[a].children;if(t[n]!=i[a].name)a++;else{if(n==t.length-1)return i[a];i=i[a].children,a=0,n++}}return null},t.prototype.updateMenu=function(){var e=this;for(var t in this.content.innerHTML="",this.menu){var n=document.createElement("li");n.innerHTML="<span class='icon'></span><span class='name'>"+this.menu[t].name+"</span>",this.content.appendChild(n),n.data=this.menu[t],this.menu[t].element=n,n.addEventListener("click",function(t){var n=this.data;n.data&&n.data.callback&&"function"==typeof n.data.callback&&n.data.callback(n.data),e.is_open?(e.is_open=!1,e.hidePanels()):(e.is_open=!0,e.showMenu(n,t,this))}),n.addEventListener("mouseover",function(t){e.hidePanels(),(e.is_open||e.auto_open)&&e.showMenu(this.data,t,this)})}},t.prototype.hidePanels=function(){if(this.panels.length){for(var t in this.panels)e.remove(this.panels[t]);this.panels=[]}},t.prototype.showMenu=function(t,n,a,i){if(i||this.hidePanels(),t.children&&t.children.length){var s=this;s.closing_by_leave&&clearInterval(s.closing_by_leave);var r=document.createElement("div");r.className="litemenubar-panel";var o=[];for(var l in t.children)o.push(t.children[l]);for(var l in this.sort_entries&&o.sort(function(e,t){var n=10,a=10;return e&&e.data&&null!=e.data.order&&(n=e.data.order),e&&e.separator&&null!=e.order&&(n=e.order),t&&t.data&&null!=t.data.order&&(a=t.data.order),t&&t.separator&&null!=t.order&&(a=t.order),n-a}),o){var c=document.createElement("p"),d=o[l];c.className="litemenu-entry "+(c.children?" submenu":"");var h=d.children&&d.children.length;if(h&&c.classList.add("has_submenu"),d&&d.name?c.innerHTML="<span class='icon'></span><span class='name'>"+d.name+(h?"<span class='more'>+</span>":"")+"</span>":c.classList.add("separator"),c.data=d,c.data.data){var p=c.data.data;("checkbox"==p.type&&p.instance&&p.property&&1==p.instance[p.property]||1==p.checkbox||p.instance&&p.property&&p.hasOwnProperty("value")&&p.instance[p.property]==p.value||"function"==typeof p.isChecked&&p.isChecked.call(p.instance,p))&&(c.className+=" checked"),p.disabled&&(c.className+=" disabled")}c.addEventListener("click",function(){var e=this.data;if(e.data){if(e.data.disabled)return;e.data.instance&&e.data.property&&("checkbox"==e.data.type?(e.data.instance[e.data.property]=!e.data.instance[e.data.property],e.data.instance[e.data.property]?this.classList.add("checked"):this.classList.remove("checked")):e.data.hasOwnProperty("value")&&(e.data.instance[e.data.property]=e.data.value)),null!=e.data.checkbox&&(e.data.checkbox=!e.data.checkbox,e.data.checkbox?this.classList.add("checked"):this.classList.remove("checked")),e.data.callback&&"function"==typeof e.data.callback&&e.data.callback(e.data)}e.children&&e.children.length?s.showMenu(e,n,this,!0):(s.is_open=!1,s.hidePanels())}),c.addEventListener("mouseenter",function(e){}),r.appendChild(c)}r.addEventListener("mouseleave",function(t){s.closing_by_leave&&clearInterval(s.closing_by_leave),s.closing_by_leave=setTimeout(function(){s.is_open=!1,s.hidePanels()},e.Menubar.closing_time)}),r.addEventListener("mouseenter",function(e){s.closing_by_leave&&clearInterval(s.closing_by_leave),s.closing_by_leave=null});var u=a.getBoundingClientRect();r.style.left=u.left+(i?200:0)+"px",r.style.top=u.top+u.height+(i?-20:10)+"px",this.panels.push(r),document.body.appendChild(r)}},e.Menubar=t});
//# sourceMappingURL=sourcemaps/Menubar.js.map
